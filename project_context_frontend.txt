Next.js Project Context
Generated On: 2026-03-01 07:19:00
Root: /home/gabriel/Documents/stage_niv_5/salma-frontend
===============================================

// FILE: collab.md
-----------------------------------------------
# ü§ù Guide de Collaboration - √âquipe SALMA

Bienvenue dans l'√©quipe ! Pour garantir un code de haute qualit√© (niveau ing√©nieur), nous suivons ces r√®gles strictes.

## 1. üåç Internationalisation (i18n)
- **R√àGLE D'OR :** Interdiction d'√©crire du texte en dur dans les fichiers `.tsx`.
- Toute cha√Æne de caract√®re doit √™tre ajout√©e dans `src/dictionaries/fr.ts` et traduite dans `en.ts`.
- Utilisation : `const { dictionary } = useLanguage();`.

## 2. üé® D√©veloppement UI (Tailwind v4)
- Avant de cr√©er un nouveau composant, v√©rifiez s'il existe dans `src/components/ui/`.
- Respectez la charte graphique : 
  - Primaire : `#6B1E2E` (Bordeaux)
  - Accent : `#C9A84C` (Or)

## 3. üìù Conventions de Nommage
- **Fichiers Composants :** PascalCase (ex: `ScholarshipCard.tsx`).
- **Dossiers Pages :** kebab-case (ex: `a-propos/`).
- **Variables/Fonctions :** Anglais uniquement (ex: `const getScholarshipList = ...`).
- **Commentaires :** Fran√ßais (pour expliquer la logique m√©tier).

## 4. üå≥ Gestion Git (Workflow)
- Ne jamais travailler directement sur `main`.
- **Branches :** 
  - `develop` : Int√©gration des fonctionnalit√©s termin√©es.
  - `feat/nom-feature` : Votre branche de travail.
- **Commits :** Utilisez les prefixes :
  - `feat:` (nouvelle fonctionnalit√©)
  - `fix:` (correction de bug)
  - `docs:` (documentation)

## üîÑ Cycle de Validation
Chaque t√¢che doit suivre ce cycle :
1. **Conception** : Validation de l'approche avec le lead.
2. **Impl√©mentation** : Code propre et modulaire.
3. **Test** : V√©rification en mode sombre et en changement de langue.
// END OF FILE: collab.md

// FILE: docs/modeling/Salma class diagram detail.puml
-----------------------------------------------
@startuml SALMA_Class_Diagram_V4

skinparam classAttributeIconSize 0
skinparam classFontSize 12
skinparam packageFontSize 13
skinparam linetype polyline
skinparam nodesep 70
skinparam ranksep 60
skinparam padding 5

title **Diagramme de Classes ‚Äî Projet SALMA v4**\nAG Technologies ‚Äî Vue d'ensemble valid√©e

' ============================================================
'  AUTH
' ============================================================

package "Authentification" {
  class "Administrateur\n//(AdminUser)//" as Admin
}

' ============================================================
'  M√âDIAS
' ============================================================

package "M√©dias" {
  class "Fichier M√©dia\n//(MediaAsset)//" as Media
}

' ============================================================
'  BOURSES
' ============================================================

package "Gestion des Bourses" {
  class "Bourse\n//(Scholarship)//" as Scholarship
  class "Domaine d'√âtudes\n//(ScholarshipField)//" as Field
  class "Avantage\n//(ScholarshipBenefit)//" as Benefit
  class "Crit√®re d'√âligibilit√©\n//(ScholarshipEligibility)//" as Eligibility
  class "Visibilit√© Champs\n//(FieldVisibility)//" as Visibility
}

Scholarship "1" -down-> "*" Field
Scholarship "1" -down-> "*" Benefit
Scholarship "1" -down-> "*" Eligibility
Scholarship "1" -down-> "*" Visibility
Scholarship "1" --> "1..*" Media : images\n(1 principale\n+ N optionnelles)

' ============================================================
'  DEMANDES DE CONTACT
' ============================================================

package "Demandes de Contact" {
  class "Demande Contact\n//(ContactRequest)//" as Contact
  class "Demande √ó Bourse\n//(ContactRequestScholarship)//" as ContactScholarship
}

Contact "1" -down-> "*" ContactScholarship
ContactScholarship "*" --> "1" Scholarship

' ============================================================
'  NEWSLETTER & ANNONCES
' ============================================================

package "Newsletter & Annonces" {
  class "Abonn√© Newsletter\n//(NewsletterSubscriber)//" as Newsletter
  class "Annonce\n//(Announcement)//" as Announcement
  class "Annonce √ó Bourse\n//(AnnouncementScholarship)//" as AnnouncementScholarship
}

Announcement "1" -down-> "*" AnnouncementScholarship
AnnouncementScholarship "*" --> "1" Scholarship
Announcement "*" --> "0..1" Media : image

' ============================================================
'  T√âMOIGNAGES
' ============================================================

package "T√©moignages" {
  class "T√©moignage\n//(Testimonial)//" as Testimonial
}

Testimonial "*" --> "0..1" Media : photo client
Testimonial "*" --> "0..1" Media : fichier joint

' ============================================================
'  CHATBOT
' ============================================================

package "Chatbot IA" {
  class "Question FAQ\n//(FaqEntry)//" as Faq
}

' ============================================================
'  CMS
' ============================================================

package "CMS ‚Äî Contenu du Site" {
  class "Page du Site\n//(SitePage)//" as Page
  class "Bloc de Contenu\n//(ContentBlock)//" as Block
  class "Config Globale\n//(SiteConfig)//" as Config
  class "Vid√©o de Pitch\n//(PitchVideo)//" as Video
}

Page "1" -down-> "*" Block
Block "*" --> "0..1" Media : image du bloc
Video "*" --> "0..1" Media : thumbnail

' ============================================================
'  SERVICES
' ============================================================

package "Services" {
  class "Service\n//(Service)//" as Service
}

Service "1" --> "1..*" Media : images\n(1 principale\n+ N optionnelles)

' ============================================================
'  KPI
' ============================================================

package "KPI & Analytics" {
  class "√âv√©nement Visiteur\n//(VisitorEvent)//" as Event
  class "Snapshot KPI\n//(KpiSnapshot)//" as Kpi
}

Event "*" --> "0..1" Scholarship : bourse consult√©e

' ============================================================
'  RELATIONS ADMIN (pointill√©s)
' ============================================================

Admin ..> Scholarship : g√®re
Admin ..> Contact : traite
Admin ..> Testimonial : g√®re
Admin ..> Faq : g√®re
Admin ..> Block : modifie
Admin ..> Config : configure
Admin ..> Video : g√®re
Admin ..> Service : g√®re
Admin ..> Media : uploade
Admin ..> Newsletter : consulte
Admin ..> Visibility : contr√¥le
Admin ..> Kpi : consulte
Admin ..> Announcement : r√©dige

@enduml

// END OF FILE: docs/modeling/Salma class diagram detail.puml

// FILE: docs/modeling/Salma class diagram.puml
-----------------------------------------------
@startuml SALMA_Class_Diagram_V4_Detail

skinparam classAttributeIconSize 0
skinparam classFontSize 11
skinparam packageFontSize 13
skinparam linetype polyline
skinparam nodesep 70
skinparam ranksep 50
skinparam padding 5

title **Diagramme de Classes D√©taill√© ‚Äî Projet SALMA v4**\nAG Technologies ‚Äî Version finale

' ============================================================
'  ENUMS
' ============================================================

enum NiveauEtudes {
  LICENCE
  MASTER
  DOCTORAT
  POST_DOC
}

enum StatutBourse {
  OUVERT
  FERME
  URGENT
  EN_ATTENTE
}

enum TypeCouverture {
  TOTALE
  PARTIELLE
  SCOLARITE
  ALLOCATION
}

enum PaysDestination {
  CHINE
  ALLEMAGNE
}

enum TypeAction {
  PAGE_VUE
  CLIC_CTA
  SOUMISSION_FORMULAIRE
  INTERACTION_CHATBOT
  INSCRIPTION_NEWSLETTER
}

enum StatutAnnonce {
  BROUILLON
  PROGRAMME
  ENVOYE
}

enum SourceTemoignage {
  SITE
  WHATSAPP
  EMAIL
}

enum TypeBloc {
  HERO
  TEXTE
  IMAGE
  CTA
  STATS
  BARRE_CONFIANCE
  VIDEO
  TEMOIGNAGES
}

' ============================================================
'  AUTH
' ============================================================

package "Authentification" {
  class "Administrateur\n//(AdminUser)//" as Admin {
    + id : UUID
    + email : String
    + motDePasseHash : String
    + nomComplet : String
    + role : String
    + estActif : Boolean
    + derniereConnexion : DateTime
    + dateCreation : DateTime
  }
}

' ============================================================
'  M√âDIAS
' ============================================================

package "M√©dias" {
  class "Fichier M√©dia\n//(MediaAsset)//" as Media {
    + id : UUID
    + nomFichier : String
    + urlFichier : String
    + texteAltFr : String {optionnel}
    + texteAltEn : String {optionnel}
    + typeMime : String
    + tailleOctets : Integer
    + dateUpload : DateTime
  }
}

' ============================================================
'  BOURSES
' ============================================================

package "Gestion des Bourses" {
  class "Bourse\n//(Scholarship)//" as Scholarship {
    + id : UUID
    + titreFr : String
    + titreEn : String
    + organismeFr : String
    + organismeEn : String
    + descriptionFr : Text
    + descriptionEn : Text
    + paysDestination : PaysDestination
    + niveau : NiveauEtudes
    + statut : StatutBourse
    + typeCouverture : TypeCouverture
    + dateLimite : Date
    + limiteAge : Integer {optionnel}
    + exigenceLangueFr : String
    + exigenceLangueEn : String
    + detailsMontantFr : String
    + detailsMontantEn : String
    + lienOfficiel : URL {optionnel}
    + estMiseEnAvant : Boolean
    + ordreAffichage : Integer
    + dateCreation : DateTime
    + dateModification : DateTime
  }

  class "Domaine d'√âtudes\n//(ScholarshipField)//" as Field {
    + id : UUID
    + idBourse : UUID
    + nomFr : String
    + nomEn : String
    + icone : String
  }

  class "Avantage\n//(ScholarshipBenefit)//" as Benefit {
    + id : UUID
    + idBourse : UUID
    + libelleFr : String
    + libelleEn : String
    + icone : String
  }

  class "Crit√®re d'√âligibilit√©\n//(ScholarshipEligibility)//" as Eligibility {
    + id : UUID
    + idBourse : UUID
    + libelleFr : String
    + libelleEn : String
    + icone : String
  }

  class "Visibilit√© Champs\n//(FieldVisibility)//" as Visibility {
    + id : UUID
    + idBourse : UUID
    + nomDuChamp : String
    + estVisible : Boolean
  }
}

Scholarship "1" -down-> "*" Field
Scholarship "1" -down-> "*" Benefit
Scholarship "1" -down-> "*" Eligibility
Scholarship "1" -down-> "*" Visibility
Scholarship "1" --> "1..*" Media : images\n(1 principale\n+ N optionnelles)

' ============================================================
'  DEMANDES DE CONTACT
' ============================================================

package "Demandes de Contact" {
  class "Demande Contact\n//(ContactRequest)//" as Contact {
    + id : UUID
    + nomComplet : String
    + email : String
    + telephone : String
    + whatsapp : String
    + message : Text
    + accepteNewsletter : Boolean
    + estLu : Boolean
    + notesAdmin : Text {optionnel}
    + dateCreation : DateTime
  }

  class "Demande √ó Bourse\n//(ContactRequestScholarship)//" as ContactScholarship {
    + id : UUID
    + idDemande : UUID
    + idBourse : UUID
  }
}

Contact "1" -down-> "*" ContactScholarship
ContactScholarship "*" --> "1" Scholarship

' ============================================================
'  NEWSLETTER & ANNONCES
' ============================================================

package "Newsletter & Annonces" {
  class "Abonn√© Newsletter\n//(NewsletterSubscriber)//" as Newsletter {
    + id : UUID
    + email : String
    + nomComplet : String {optionnel}
    + telephone : String {optionnel}
    + pays : String {optionnel}
    + niveauEtudes : NiveauEtudes {optionnel}
    + destinationSouhaitee : PaysDestination {optionnel}
    + source : String
    + estActif : Boolean
    + dateInscription : DateTime
    + dateDesinscription : DateTime {optionnel}
  }

  class "Annonce\n//(Announcement)//" as Announcement {
    + id : UUID
    + titreFr : String
    + titreEn : String
    + contenuFr : Text
    + contenuEn : Text
    + statut : StatutAnnonce
    + dateEnvoi : DateTime {optionnel}
    + dateCreation : DateTime
  }

  class "Annonce √ó Bourse\n//(AnnouncementScholarship)//" as AnnouncementScholarship {
    + id : UUID
    + idAnnonce : UUID
    + idBourse : UUID
  }
}

Announcement "1" -down-> "*" AnnouncementScholarship
AnnouncementScholarship "*" --> "1" Scholarship
Announcement "*" --> "0..1" Media : image

' ============================================================
'  T√âMOIGNAGES
' ============================================================

package "T√©moignages" {
  class "T√©moignage\n//(Testimonial)//" as Testimonial {
    + id : UUID
    + nomAuteur : String
    + paysAuteur : String
    + citationFr : Text
    + citationEn : Text
    + note : Integer
    + source : SourceTemoignage
    + estApprouve : Boolean
    + estAfficheSurSite : Boolean
    + ordreAffichage : Integer
    + dateCreation : DateTime
  }
}

Testimonial "*" --> "0..1" Media : photo client
Testimonial "*" --> "0..1" Media : fichier joint

' ============================================================
'  CHATBOT
' ============================================================

package "Chatbot IA" {
  class "Question FAQ\n//(FaqEntry)//" as Faq {
    + id : UUID
    + questionFr : String
    + questionEn : String
    + reponseFr : Text
    + reponseEn : Text
    + categorie : String
    + ordreAffichage : Integer
    + estActif : Boolean
  }
}

' ============================================================
'  CMS
' ============================================================

package "CMS ‚Äî Contenu du Site" {
  class "Page du Site\n//(SitePage)//" as Page {
    + id : UUID
    + slug : String
    + titreFr : String
    + titreEn : String
    + estPubliee : Boolean
    + ordreAffichage : Integer
    + dateModification : DateTime
  }

  class "Bloc de Contenu\n//(ContentBlock)//" as Block {
    + id : UUID
    + idPage : UUID
    + cleBloc : String
    + typeBloc : TypeBloc
    + contenuFr : Text
    + contenuEn : Text
    + lienCta : String {optionnel}
    + estVisible : Boolean
    + ordreAffichage : Integer
    + dateModification : DateTime
  }

  class "Config Globale\n//(SiteConfig)//" as Config {
    + id : UUID
    + cleConfig : String
    + valeurFr : Text
    + valeurEn : Text
    + dateModification : DateTime
  }

  class "Vid√©o de Pitch\n//(PitchVideo)//" as Video {
    + id : UUID
    + titreFr : String
    + titreEn : String
    + urlVideo : String
    + estActive : Boolean
    + pageAffichage : String
    + dateModification : DateTime
  }
}

Page "1" -down-> "*" Block
Block "*" --> "0..1" Media : image du bloc
Video "*" --> "0..1" Media : thumbnail

' ============================================================
'  SERVICES
' ============================================================

package "Services" {
  class "Service\n//(Service)//" as Service {
    + id : UUID
    + slug : String
    + nomFr : String
    + nomEn : String
    + descriptionFr : Text
    + descriptionEn : Text
    + icone : String
    + delaiTraitement : String {optionnel}
    + estActif : Boolean
    + ordreAffichage : Integer
  }
}

Service "1" --> "1..*" Media : images\n(1 principale\n+ N optionnelles)

' ============================================================
'  KPI
' ============================================================

package "KPI & Analytics" {
  class "√âv√©nement Visiteur\n//(VisitorEvent)//" as Event {
    + id : UUID
    + idSession : String
    + typeAction : TypeAction
    + slugPage : String {optionnel}
    + idBourse : UUID {optionnel}
    + referent : String {optionnel}
    + userAgent : String {optionnel}
    + paysIp : String {optionnel}
    + horodatage : DateTime
  }

  class "Snapshot KPI\n//(KpiSnapshot)//" as Kpi {
    + id : UUID
    + date : Date
    + totalVisiteurs : Integer
    + visiteursUniques : Integer
    + pagesVues : Integer
    + clicsCta : Integer
    + soumissionsFormulaire : Integer
    + inscriptionsNewsletter : Integer
    + sessionsChatbot : Integer
    + tauxConversion : Decimal
    + idBourseTop : UUID {optionnel}
  }
}

Event "*" --> "0..1" Scholarship : bourse consult√©e

' ============================================================
'  RELATIONS ADMIN (pointill√©s)
' ============================================================

Admin ..> Scholarship : g√®re
Admin ..> Contact : traite
Admin ..> Testimonial : g√®re
Admin ..> Faq : g√®re
Admin ..> Block : modifie
Admin ..> Config : configure
Admin ..> Video : g√®re
Admin ..> Service : g√®re
Admin ..> Media : uploade
Admin ..> Newsletter : consulte
Admin ..> Visibility : contr√¥le
Admin ..> Kpi : consulte
Admin ..> Announcement : r√©dige

@enduml

// END OF FILE: docs/modeling/Salma class diagram.puml

// FILE: docs/modeling/Salma contrats api.md
-----------------------------------------------
# Contrats d'API ‚Äî Projet SALMA
## AG Technologies ‚Äî Document de r√©f√©rence

---

## 1. AUTH ‚Äî `/api/auth`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| POST | `/api/auth/login` | Connexion ‚Üí retourne le token | Non |
| POST | `/api/auth/logout` | D√©connexion ‚Üí invalide le token | Oui |
| POST | `/api/auth/register` | Cr√©er un compte admin | Oui (super admin) |
| GET | `/api/auth/me` | R√©cup√©rer son profil | Oui |
| PUT | `/api/auth/me` | Modifier son profil complet | Oui |
| PATCH | `/api/auth/me` | Modifier partiellement son profil | Oui |
| PUT | `/api/auth/change-password` | Modifier son mot de passe | Oui |
| POST | `/api/auth/reset-password` | Demander r√©initialisation par email | Non |
| POST | `/api/auth/reset-password/confirm` | Confirmer nouveau mot de passe | Non |

---

## 2. BOURSES

### 2.1 Publique ‚Äî `/api/bourses`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/bourses` | Liste avec filtres (pays, niveau, couverture, statut, recherche) | Non |
| GET | `/api/bourses/mise-en-avant` | Bourses √† la une | Non |
| GET | `/api/bourses/{id}` | Fiche d√©taill√©e (visibilit√© appliqu√©e) | Non |

### 2.2 Admin ‚Äî `/api/admin/bourses`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/admin/bourses` | Liste compl√®te (tous champs) | Oui |
| GET | `/api/admin/bourses/{id}` | D√©tail complet | Oui |
| POST | `/api/admin/bourses` | Cr√©er une bourse | Oui |
| PUT | `/api/admin/bourses/{id}` | Modifier compl√®tement | Oui |
| PATCH | `/api/admin/bourses/{id}` | Modifier partiellement | Oui |
| DELETE | `/api/admin/bourses/{id}` | Supprimer | Oui |
| PUT | `/api/admin/bourses/{id}/visibilite` | Modifier la visibilit√© compl√®te | Oui |
| PATCH | `/api/admin/bourses/{id}/visibilite` | Modifier partiellement la visibilit√© | Oui |
| PUT | `/api/admin/bourses/{id}/mise-en-avant` | Activer/d√©sactiver mise en avant | Oui |

#### Domaines d'√©tudes

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| POST | `/api/admin/bourses/{id}/domaines` | Ajouter un domaine | Oui |
| PUT | `/api/admin/bourses/{id}/domaines/{domId}` | Modifier compl√®tement | Oui |
| PATCH | `/api/admin/bourses/{id}/domaines/{domId}` | Modifier partiellement | Oui |
| DELETE | `/api/admin/bourses/{id}/domaines/{domId}` | Supprimer | Oui |

#### Avantages

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| POST | `/api/admin/bourses/{id}/avantages` | Ajouter un avantage | Oui |
| PUT | `/api/admin/bourses/{id}/avantages/{avId}` | Modifier compl√®tement | Oui |
| PATCH | `/api/admin/bourses/{id}/avantages/{avId}` | Modifier partiellement | Oui |
| DELETE | `/api/admin/bourses/{id}/avantages/{avId}` | Supprimer | Oui |

#### Crit√®res d'√©ligibilit√©

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| POST | `/api/admin/bourses/{id}/criteres` | Ajouter un crit√®re | Oui |
| PUT | `/api/admin/bourses/{id}/criteres/{crId}` | Modifier compl√®tement | Oui |
| PATCH | `/api/admin/bourses/{id}/criteres/{crId}` | Modifier partiellement | Oui |
| DELETE | `/api/admin/bourses/{id}/criteres/{crId}` | Supprimer | Oui |

#### Images

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| POST | `/api/admin/bourses/{id}/images` | Ajouter une image | Oui |
| DELETE | `/api/admin/bourses/{id}/images/{imgId}` | Supprimer une image | Oui |
| PUT | `/api/admin/bourses/{id}/images/{imgId}/principale` | D√©finir comme image principale | Oui |

---

## 3. DEMANDES DE CONTACT

### 3.1 Publique ‚Äî `/api/contact`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| POST | `/api/contact` | Soumettre une demande (+ bourses optionnelles + accepte newsletter) | Non |

### 3.2 Admin ‚Äî `/api/admin/contacts`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/admin/contacts` | Liste des demandes (filtres : lu/non lu, date) | Oui |
| GET | `/api/admin/contacts/{id}` | D√©tail avec bourses associ√©es | Oui |
| PATCH | `/api/admin/contacts/{id}` | Marquer lu, ajouter notes | Oui |
| DELETE | `/api/admin/contacts/{id}` | Supprimer | Oui |

---

## 4. NEWSLETTER & ANNONCES

### 4.1 Publique ‚Äî `/api/newsletter`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| POST | `/api/newsletter/inscription` | S'inscrire (email obligatoire, reste optionnel) | Non |
| POST | `/api/newsletter/desinscription` | Se d√©sinscrire | Non |

### 4.2 Admin Abonn√©s ‚Äî `/api/admin/newsletter`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/admin/newsletter/abonnes` | Liste des abonn√©s (filtres : actif, pays, niveau) | Oui |
| GET | `/api/admin/newsletter/abonnes/{id}` | D√©tail d'un abonn√© | Oui |
| DELETE | `/api/admin/newsletter/abonnes/{id}` | Supprimer un abonn√© | Oui |

### 4.3 Admin Annonces ‚Äî `/api/admin/annonces`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/admin/annonces` | Liste des annonces | Oui |
| GET | `/api/admin/annonces/{id}` | D√©tail avec bourses li√©es | Oui |
| POST | `/api/admin/annonces` | Cr√©er une annonce (brouillon) | Oui |
| PUT | `/api/admin/annonces/{id}` | Modifier compl√®tement | Oui |
| PATCH | `/api/admin/annonces/{id}` | Modifier partiellement | Oui |
| DELETE | `/api/admin/annonces/{id}` | Supprimer | Oui |
| POST | `/api/admin/annonces/{id}/envoyer` | Envoyer √† tous les abonn√©s actifs | Oui |

---

## 5. T√âMOIGNAGES

### 5.1 Publique ‚Äî `/api/temoignages`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/temoignages` | Liste des t√©moignages approuv√©s et affich√©s | Non |
| POST | `/api/temoignages` | Soumettre un t√©moignage (formulaire site ou lien email) | Non |

### 5.2 Admin ‚Äî `/api/admin/temoignages`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/admin/temoignages` | Liste compl√®te (approuv√©s + en attente) | Oui |
| GET | `/api/admin/temoignages/{id}` | D√©tail | Oui |
| POST | `/api/admin/temoignages` | Cr√©er manuellement (depuis WhatsApp/mail) | Oui |
| PUT | `/api/admin/temoignages/{id}` | Modifier compl√®tement | Oui |
| PATCH | `/api/admin/temoignages/{id}` | Modifier partiellement | Oui |
| DELETE | `/api/admin/temoignages/{id}` | Supprimer | Oui |

---

## 6. CHATBOT IA

### 6.1 Publique ‚Äî `/api/chatbot`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| POST | `/api/chatbot/message` | Envoyer une question ‚Üí Gemini r√©pond via FAQ | Non |

### 6.2 Admin FAQ ‚Äî `/api/admin/faq`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/admin/faq` | Liste des FAQ | Oui |
| GET | `/api/admin/faq/{id}` | D√©tail | Oui |
| POST | `/api/admin/faq` | Cr√©er une question/r√©ponse | Oui |
| PUT | `/api/admin/faq/{id}` | Modifier compl√®tement | Oui |
| PATCH | `/api/admin/faq/{id}` | Modifier partiellement | Oui |
| DELETE | `/api/admin/faq/{id}` | Supprimer | Oui |

---

## 7. CMS ‚Äî CONTENU DU SITE

### 7.1 Publique ‚Äî `/api`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/pages` | Liste des pages publi√©es | Non |
| GET | `/api/pages/{slug}` | Contenu complet d'une page (blocs visibles) | Non |
| GET | `/api/config` | Configurations globales | Non |
| GET | `/api/videos` | Vid√©os de pitch actives | Non |

### 7.2 Admin Pages ‚Äî `/api/admin/pages`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/admin/pages` | Liste de toutes les pages | Oui |
| GET | `/api/admin/pages/{id}` | D√©tail avec tous les blocs | Oui |
| POST | `/api/admin/pages` | Cr√©er une page | Oui |
| PUT | `/api/admin/pages/{id}` | Modifier compl√®tement | Oui |
| PATCH | `/api/admin/pages/{id}` | Modifier partiellement | Oui |
| DELETE | `/api/admin/pages/{id}` | Supprimer | Oui |

#### Blocs de contenu

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| POST | `/api/admin/pages/{id}/blocs` | Ajouter un bloc | Oui |
| PUT | `/api/admin/pages/{id}/blocs/{blocId}` | Modifier compl√®tement | Oui |
| PATCH | `/api/admin/pages/{id}/blocs/{blocId}` | Modifier partiellement | Oui |
| DELETE | `/api/admin/pages/{id}/blocs/{blocId}` | Supprimer | Oui |

### 7.3 Admin Config ‚Äî `/api/admin/config`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/admin/config` | Liste de toutes les configs | Oui |
| POST | `/api/admin/config` | Cr√©er une config | Oui |
| PUT | `/api/admin/config/{cle}` | Modifier compl√®tement | Oui |
| PATCH | `/api/admin/config/{cle}` | Modifier partiellement | Oui |
| DELETE | `/api/admin/config/{cle}` | Supprimer | Oui |

### 7.4 Admin Vid√©os ‚Äî `/api/admin/videos`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/admin/videos` | Liste des vid√©os | Oui |
| GET | `/api/admin/videos/{id}` | D√©tail | Oui |
| POST | `/api/admin/videos` | Ajouter une vid√©o | Oui |
| PUT | `/api/admin/videos/{id}` | Modifier compl√®tement | Oui |
| PATCH | `/api/admin/videos/{id}` | Modifier partiellement | Oui |
| DELETE | `/api/admin/videos/{id}` | Supprimer | Oui |

---

## 8. SERVICES

### 8.1 Publique ‚Äî `/api/services`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/services` | Liste des services actifs | Non |
| GET | `/api/services/{slug}` | D√©tail d'un service | Non |

### 8.2 Admin ‚Äî `/api/admin/services`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/admin/services` | Liste compl√®te | Oui |
| GET | `/api/admin/services/{id}` | D√©tail | Oui |
| POST | `/api/admin/services` | Cr√©er | Oui |
| PUT | `/api/admin/services/{id}` | Modifier compl√®tement | Oui |
| PATCH | `/api/admin/services/{id}` | Modifier partiellement | Oui |
| DELETE | `/api/admin/services/{id}` | Supprimer | Oui |

#### Images

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| POST | `/api/admin/services/{id}/images` | Ajouter une image | Oui |
| DELETE | `/api/admin/services/{id}/images/{imgId}` | Supprimer une image | Oui |
| PUT | `/api/admin/services/{id}/images/{imgId}/principale` | D√©finir comme image principale | Oui |

---

## 9. M√âDIAS

### Admin uniquement ‚Äî `/api/admin/medias`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/admin/medias` | Biblioth√®que de fichiers | Oui |
| GET | `/api/admin/medias/{id}` | D√©tail d'un fichier | Oui |
| POST | `/api/admin/medias` | Uploader un fichier | Oui |
| PATCH | `/api/admin/medias/{id}` | Modifier les m√©tadonn√©es | Oui |
| DELETE | `/api/admin/medias/{id}` | Supprimer | Oui |

---

## 10. KPI & ANALYTICS

### 10.1 Publique ‚Äî `/api/evenements`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| POST | `/api/evenements` | Enregistrer un √©v√©nement visiteur | Non |

### 10.2 Admin ‚Äî `/api/admin/kpi`

| M√©thode | Endpoint | Description | Auth |
|---------|----------|-------------|------|
| GET | `/api/admin/kpi/snapshots` | Liste des snapshots (filtres : p√©riode) | Oui |
| GET | `/api/admin/kpi/snapshots/{date}` | Snapshot d'une date | Oui |
| GET | `/api/admin/kpi/temps-reel` | Stats en temps r√©el | Oui |
| GET | `/api/admin/kpi/conversion` | Taux de conversion (global + par bourse) | Oui |
| GET | `/api/admin/kpi/evenements` | √âv√©nements bruts (filtres : type, page, bourse, p√©riode) | Oui |

---

## R√©capitulatif

| Module | Endpoints publics | Endpoints admin | Total |
|--------|:-:|:-:|:-:|
| Auth | 2 | 7 | 9 |
| Bourses | 3 | 22 | 25 |
| Contact | 1 | 4 | 5 |
| Newsletter & Annonces | 2 | 10 | 12 |
| T√©moignages | 2 | 6 | 8 |
| Chatbot | 1 | 5 | 6 |
| CMS | 3 | 17 | 20 |
| Services | 2 | 9 | 11 |
| M√©dias | 0 | 5 | 5 |
| KPI | 1 | 5 | 6 |
| **TOTAL** | **17** | **90** | **107** |
// END OF FILE: docs/modeling/Salma contrats api.md

// FILE: docs/specifications/remarques_clients_sur_le_prototype.md
-----------------------------------------------
# Remarques Client ‚Äî Projet SALMA
## AG Technologies ‚Äî Liste compl√®te

---

## 1. UI/UX & Design

- [ ] Le mode th√®me sombre n'est pas encore fonctionnel
- [ ] L'application doit √™tre responsive
- [ ] Les images doivent √™tre de qualit√© sup√©rieure
- [ ] Am√©liorer les effets sur le site : animations, hover, descriptions au survol ‚Äî bref l'exp√©rience utilisateur
- [ ] Changer la photo sur la page d'accueil pour une photo plus claire
- [ ] Ce n'est pas une agence de voyage donc retirer "Travel Agency" sur la navbar

---

## 2. Mod√®le de Donn√©es & Bourses

- [ ] Bien concevoir les infos d'une bourse afin que le mod√®le de donn√©es soit exhaustif et complet
- [ ] Pour chaque champ d'une bourse, l'admin doit pouvoir dire si le champ s'affiche ou pas (tous les champs existent en BD)
- [ ] Une bourse a une image principale
- [ ] Pas de prix sur le site client ‚Äî infos minimales ‚Äî mais l'admin peut mettre s'il veut
- [ ] On doit publier le minimum d'infos pour int√©resser mais inciter les clients √† contacter l'entreprise pour en savoir plus (le but est de vendre ces infos)

---

## 3. Administration & CMS

- [ ] Chaque champ du frontend de chaque page doit √™tre directement d√©finissable via le dashboard admin, de sorte que le boss contr√¥le compl√®tement chaque info du site et peut le mettre √† jour sans avoir besoin du dev
- [ ] Le dashboard admin doit permettre une administration compl√®te

---

## 4. KPI & Analytics

- [ ] Mettre en place des KPI dans le backend pour √©valuer le taux de conversion et avoir les statistiques en temps r√©el

---

## 5. Cookies & Confidentialit√©

- [ ] Mettre en place la gestion des cookies et la politique de confidentialit√©

---

## 6. Newsletter & Collecte de Prospects

- [ ] Mettre en place une newsletter et un m√©canisme pour r√©colter les emails et un maximum d'infos sur les visiteurs afin d'avoir une base de prospects √† convertir

---

## 7. Retours Clients

- [ ] Mettre en place un syst√®me pour les retours clients (t√©moignages)

---

## 8. Chatbot IA

- [ ] Puisque le chatbot WhatsApp arrivera apr√®s, int√©grer d'abord Gemini qui va simuler le chatbot
- [ ] L'objectif du chatbot est de r√©pondre en langage naturel √† une suite de questions fournies en BD
- [ ] Si le chatbot n'a pas la r√©ponse ‚Üí inciter le client √† contacter l'entreprise
- [ ] Le chatbot doit inciter √† prendre rendez-vous

---

## 9. Vid√©o de Pitch

- [ ] Int√©grer une vid√©o de pitch sur le site ‚Äî courte mais convaincante

---

## 10. Candidatures & Rendez-vous

- [ ] Gestion des candidatures et demandes de contact
- [ ] Apr√®s qu'un client ait programm√© un rendez-vous avec l'agence, notifier l'agence par mail, WhatsApp et sur le site

---

## 11. Strat√©gie de Conversion

- [ ] On doit int√©resser les visiteurs puis les convertir ‚Äî au rendez-vous on pourra vendre
- [ ] Le site doit donner envie de contacter l'entreprise pour en savoir plus, pas tout d√©voiler
// END OF FILE: docs/specifications/remarques_clients_sur_le_prototype.md

// FILE: docs/specifications/vision-project.md
-----------------------------------------------
# üåç Vision Strat√©gique & Architecture ‚Äî Plateforme SALMA

Ce document d√©finit les piliers techniques et fonctionnels de la plateforme SALMA (by AG Technologies) pour r√©pondre aux exigences de performance, de conversion et de prestige de l'agence.

## 1. Quelle est la particularit√© de ce site ?
Contrairement aux sites de voyage classiques, SALMA se positionne comme une **plateforme de confiance et de r√©ussite**. 
- **Focus R√©sultat :** Mise en avant de la garantie "Satisfait ou Rembours√©" et des preuves sociales (Success Stories).
- **Sp√©cialisation :** Une exp√©rience utilisateur (UX) segment√©e sp√©cifiquement pour les corridors **Chine** et **Allemagne**, respectant les codes acad√©miques de ces deux pays.

## 2. Interface & UX (Exp√©rience Utilisateur)
L'interface est con√ßue pour r√©duire la charge cognitive et maximiser l'engagement :
- **Mobile-First :** 80% des √©tudiants consultent sur smartphone. L'interface est pens√©e comme une application mobile native.
- **Design √âmotionnel :** Utilisation de la charte Bordeaux Royal et Or pour instaurer un sentiment de prestige et d'accessibilit√© au succ√®s.
- **Micro-interactions :** Animations fluides pour guider l'≈ìil vers les actions prioritaires (CTAs).

## 3. Structure de la Plateforme
Le site est structur√© selon un **entonnoir de conversion** :
1. **D√©couverte (Home) :** Rassurer sur l'expertise d'AG Technologies.
2. **Exploration (Catalogue) :** Permettre un choix rapide via des filtres intelligents.
3. **Information (D√©tail Bourse) :** Lever tous les doutes (conditions, avantages, d√©lais).
4. **Action (Conversion) :** Formulaire de contact simplifi√© et lien direct WhatsApp.

## 4. Architecture Technique (Stack Ing√©nieur)
Nous utilisons une architecture **"Headless"** pour une s√©paration totale des responsabilit√©s :
- **Frontend :** Next.js 15 (App Router). Permet un r√©f√©rencement (SEO) optimal et une vitesse de navigation instantan√©e gr√¢ce au rendu hybride.
- **Backend :** Django REST Framework. Garantit une s√©curit√© bancaire des donn√©es et une gestion robuste des bourses en interne.
- **API :** Communication via JSON, permettant de faire √©voluer le site ou de cr√©er une application mobile future sans changer le backend.

## 5. Gestion des Donn√©es (Data Management)
- **Centralisation :** Toutes les bourses sont g√©r√©es en un seul endroit par l'administrateur.
- **Performance :** Utilisation d'un syst√®me de mise en cache intelligent (ISR) : le site se met √† jour instantan√©ment d√®s qu'une bourse est modifi√©e en admin, sans ralentir l'utilisateur.

## 6. Fluidit√© & Optimisation
- **Z√©ro Latence :** Optimisation des images (Next/Image) et des scripts pour obtenir un score de performance proche de 100 sur Google Lighthouse.
- **Accessibilit√© :** Site fluide m√™me avec une connexion internet instable (optimisation des paquets de donn√©es).

## 7. Chatbot & Assistance
- **WhatsApp Intelligent :** Int√©gration d'un bouton flottant qui pr√©-remplit le message en fonction de la page consult√©e (ex: *"Bonjour SALMA, je suis int√©ress√© par la bourse Master en Allemagne..."*).
- **Assistant IA (√âvolutif) :** Structure pr√™te pour l'int√©gration d'un agent IA capable de r√©pondre aux questions sur les proc√©dures de visa 24h/24.

## 8. Caract√®re Innovateur & Conversion
L'innovation majeure est le **"Scholarship Matcher"** :
- Un outil interactif qui permet √† l'√©tudiant de trouver sa bourse id√©ale en 3 clics (Niveau, Budget, Pays). 
- **Impact :** Transforme un visiteur passif en un prospect qualifi√©, augmentant radicalement le taux de conversion par rapport √† une simple liste statique.

---
**AG Technologies ‚Äî L'excellence au service de votre mobilit√© internationale.**
// END OF FILE: docs/specifications/vision-project.md

// FILE: eslint.config.mjs
-----------------------------------------------
import { dirname } from "path";
import { fileURLToPath } from "url";
import { FlatCompat } from "@eslint/eslintrc";

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

const compat = new FlatCompat({
  baseDirectory: __dirname,
});

const eslintConfig = [
  ...compat.extends("next/core-web-vitals", "next/typescript"),
  {
    ignores: [
      "node_modules/**",
      ".next/**",
      "out/**",
      "build/**",
      "next-env.d.ts",
    ],
  },
];

export default eslintConfig;

// END OF FILE: eslint.config.mjs

// FILE: extract_context.ps1
-----------------------------------------------
<#
.SYNOPSIS
Extrait le code source d'un projet Next.js pour l'utiliser comme contexte IA.
#>

param (
    [string]$ProjectPath = "."
)

$OutputFilename = "project_context_frontend.txt"

# R√©solution du chemin absolu
try {
    $ResolvedPath = (Resolve-Path $ProjectPath -ErrorAction Stop).Path
} catch {
    Write-Error "Erreur: R√©pertoire invalide ($ProjectPath)."
    exit 1
}

$OutputFile = Join-Path $ResolvedPath $OutputFilename

# Suppression de l'ancien fichier s'il existe
if (Test-Path $OutputFile) {
    Remove-Item $OutputFile -Force
}

# Dossiers √† ignorer (optimisation : on n'y entre m√™me pas)
$ExcludeDirs = @(
    ".git", ".vscode", ".idea", "node_modules", ".next", 
    "out", "build", "coverage", "public", "dist", ".vercel"
)

# Fichiers √† ignorer (accepte les wildcards *)
$ExcludeFiles = @(
    "*.log", "package-lock.json", "yarn.lock", "pnpm-lock.yaml", "bun.lockb",
    ".env*", "*.ico", "*.png", "*.jpg", "*.jpeg", "*.svg", "*.webp", 
    "*.pdf", "*.map", "*.ttf", "*.woff", "*.woff2", "*.eot", "*.mp4",
    $OutputFilename
)

# Fonction pour v√©rifier si un fichier est binaire (contient des octets nuls)
function Test-IsBinary {
    param ([string]$FilePath)
    try {
        $bytes = [System.IO.File]::ReadAllBytes($FilePath)
        $checkLength = [math]::Min(1024, $bytes.Length)
        for ($i = 0; $i -lt $checkLength; $i++) {
            if ($bytes[$i] -eq 0) { return $true }
        }
        return $false
    } catch {
        return $true # En cas d'erreur de lecture, on ignore par s√©curit√©
    }
}

$foundFiles = [System.Collections.Generic.List[string]]::new()

# Fonction r√©cursive pour lister les fichiers valides
function Get-ValidFiles {
    param ([string]$CurrentDir)
    
    $items = Get-ChildItem -Path $CurrentDir -Force -ErrorAction SilentlyContinue
    
    foreach ($item in $items) {
        if ($item.PSIsContainer) {
            # Si c'est un dossier et qu'il n'est pas dans la liste d'exclusion
            if ($ExcludeDirs -notcontains $item.Name) {
                Get-ValidFiles -CurrentDir $item.FullName
            }
        } else {
            # Si c'est un fichier, on v√©rifie son extension/nom
            $skip = $false
            foreach ($pattern in $ExcludeFiles) {
                if ($item.Name -like $pattern) {
                    $skip = $true
                    break
                }
            }
            if (-not $skip) {
                $foundFiles.Add($item.FullName)
            }
        }
    }
}

Write-Host "Recherche des fichiers en cours..." -ForegroundColor Cyan
Get-ValidFiles -CurrentDir $ResolvedPath

# √âcriture de l'en-t√™te
$dateStr = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
$header = @"
Next.js Project Context
Generated On: $dateStr
Root: $ResolvedPath
===============================================
"@

Set-Content -Path $OutputFile -Value $header -Encoding UTF8

Write-Host "G√©n√©ration du fichier de contexte en cours..." -ForegroundColor Cyan

foreach ($file in $foundFiles) {
    # Calcul du chemin relatif
    $relativePath = $file.Substring($ResolvedPath.Length).TrimStart('\')
    $relativePath = $relativePath -replace '\\', '/' # Formatage type UNIX pour l'IA
    
    $fileHeader = "`n// FILE: $relativePath`n-----------------------------------------------"
    Add-Content -Path $OutputFile -Value $fileHeader -Encoding UTF8
    
    if (Test-IsBinary -FilePath $file) {
        Add-Content -Path $OutputFile -Value "[Fichier binaire ou asset omis]" -Encoding UTF8
    } else {
        try {
            # Lecture du contenu brut
            $content = Get-Content -Path $file -Raw -Encoding UTF8 -ErrorAction Stop
            if ($null -ne $content) {
                Add-Content -Path $OutputFile -Value $content -Encoding UTF8
            }
        } catch {
            Add-Content -Path $OutputFile -Value "[Erreur lors de la lecture du fichier]" -Encoding UTF8
        }
    }
    
    Add-Content -Path $OutputFile -Value "`n// END OF FILE: $relativePath`n" -Encoding UTF8
}

Write-Host "Succ√®s ! Ton contexte Next.js est pr√™t dans : $OutputFile" -ForegroundColor Green
// END OF FILE: extract_context.ps1

// FILE: extract_context.sh
-----------------------------------------------
#!/bin/bash

# --- Configuration ---

# Chemin par d√©faut ou premier argument
PROJECT_PATH="${1:-.}"
OUTPUT_FILENAME="project_context_frontend.txt"

# R√©solution du chemin absolu
PROJECT_PATH=$(realpath "$PROJECT_PATH" 2>/dev/null)

if [ ! -d "$PROJECT_PATH" ]; then
    echo "Erreur: R√©pertoire invalide ($PROJECT_PATH)." >&2
    exit 1
fi

OUTPUT_FILE="$PROJECT_PATH/$OUTPUT_FILENAME"

# Dossiers √† ignorer totalement (prune)
EXCLUDE_DIRS=(
    ".git" ".vscode" ".idea" "node_modules" ".next" 
    "out" "build" "coverage" "public" "dist" ".vercel"
)

# Fichiers √† ignorer (patterns)
EXCLUDE_FILES=(
    "*.log" "package-lock.json" "yarn.lock" "pnpm-lock.yaml" "bun.lockb"
    ".env*" "*.ico" "*.png" "*.jpg" "*.jpeg" "*.svg" "*.webp" 
    "*.pdf" "*.map" "*.ttf" "*.woff" "*.woff2" "*.eot" "*.mp4"
    "$OUTPUT_FILENAME"
)

# --- Pr√©paration de la commande find ---

# Construction des arguments d'exclusion de dossiers
PRUNE_ARGS=()
for dir in "${EXCLUDE_DIRS[@]}"; do
    if [ ${#PRUNE_ARGS[@]} -gt 0 ]; then PRUNE_ARGS+=("-o"); fi
    PRUNE_ARGS+=("-name" "$dir")
done

# Construction des arguments d'exclusion de fichiers
FILE_ARGS=()
for file in "${EXCLUDE_FILES[@]}"; do
    FILE_ARGS+=("!" "-name" "$file")
done

# --- Ex√©cution ---

echo "Recherche des fichiers dans : $PROJECT_PATH..."

# Ent√™te du fichier
{
    echo "Next.js Project Context"
    echo "Generated On: $(date '+%Y-%m-%d %H:%M:%S')"
    echo "Root: $PROJECT_PATH"
    echo "==============================================="
} > "$OUTPUT_FILE"

# Recherche et traitement des fichiers
# 1. On ignore les dossiers list√©s
# 2. On prend uniquement les fichiers (-type f)
# 3. On applique les exclusions de noms de fichiers
find "$PROJECT_PATH" \( "${PRUNE_ARGS[@]}" \) -prune -o -type f "${FILE_ARGS[@]}" -print | sort | while read -r FILE; do
    
    # Calcul du chemin relatif
    RELATIVE_PATH="${FILE#"$PROJECT_PATH"/}"
    
    echo "Traitement de : $RELATIVE_PATH"

    {
        echo -e "\n// FILE: $RELATIVE_PATH"
        echo "-----------------------------------------------"
    } >> "$OUTPUT_FILE"

    # V√©rification si le fichier est binaire
    # Sur Linux, 'grep -I' est le moyen le plus rapide de d√©tecter un binaire
    if grep -qI . "$FILE"; then
        cat "$FILE" >> "$OUTPUT_FILE"
    else
        echo "[Fichier binaire ou asset omis]" >> "$OUTPUT_FILE"
    fi

    echo -e "\n// END OF FILE: $RELATIVE_PATH" >> "$OUTPUT_FILE"
done

echo "-----------------------------------------------"
echo "Succ√®s ! Le contexte est pr√™t : $OUTPUT_FILE"
// END OF FILE: extract_context.sh

// FILE: .gitignore
-----------------------------------------------
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# env files (can opt-in for committing if needed)
.env.local

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts

// END OF FILE: .gitignore

// FILE: next.config.ts
-----------------------------------------------
// next.config.ts
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: 'images.unsplash.com',
      },
      {
        protocol: 'https',
        hostname: 'i.pravatar.cc',
      },
      {
        protocol: 'https',
        hostname: 'api-x75k2m8-v1.agtgroupholding.com',
      },
       { protocol: 'http',
         hostname: '127.0.0.1' },
    ],
  },
};

export default nextConfig;
// END OF FILE: next.config.ts

// FILE: next-env.d.ts
-----------------------------------------------
/// <reference types="next" />
/// <reference types="next/image-types/global" />
/// <reference path="./.next/types/routes.d.ts" />

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/api-reference/config/typescript for more information.

// END OF FILE: next-env.d.ts

// FILE: package.json
-----------------------------------------------
{
  "name": "salma-frontend",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint"
  },
  "dependencies": {
    "next": "15.5.12",
    "next-themes": "^0.4.6",
    "react": "19.1.0",
    "react-dom": "19.1.0"
  },
  "devDependencies": {
    "@eslint/eslintrc": "^3",
    "@tailwindcss/postcss": "^4",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "eslint": "^9",
    "eslint-config-next": "15.5.12",
    "tailwindcss": "^4",
    "typescript": "^5"
  }
}

// END OF FILE: package.json

// FILE: postcss.config.mjs
-----------------------------------------------
const config = {
  plugins: ["@tailwindcss/postcss"],
};

export default config;

// END OF FILE: postcss.config.mjs

// FILE: prompt_livraison.md
-----------------------------------------------
# üöÄ PROMPT DE CONTINUIT√â ‚Äî PHASE DE LIVRAISON (Projet SALMA)
## AG Technologies ¬∑ Yaound√©, Cameroun
### √Ä donner √† toute IA pour reprendre le projet avec le contexte complet

---

> **INSTRUCTION SYST√àME** : Tu es un d√©veloppeur fullstack senior (Next.js 15 / Django DRF) qui travaille sur la derni√®re ligne droite du projet SALMA. Avant de coder quoi que ce soit, tu dois TOUJOURS commencer par l'**audit complet** de la roadmap ci-dessous, puis m'aider sur la t√¢che demand√©e. Ne saute jamais l'audit.

---

## üìå 1. CONTEXTE ACTUEL DU PROJET

**SALMA** est une plateforme bilingue (FR/EN) de bourses d'√©tudes (Chine/Allemagne). 
**Statut actuel :** Le backend V1 est d√©ploy√©. Le frontend a un build stable. L'authentification JWT fonctionne et le layout du Dashboard Admin est accessible. Nous sommes dans la phase de **stabilisation, polish UI, et mise en production**.

### Stack technique
| Couche | Techno | D√©tails |
|--------|--------|---------|
| **Frontend** | Next.js 15 (App Router) | TypeScript strict, Tailwind CSS v4, i18n FR/EN |
| **Backend** | Django + DRF | JWT (SimpleJWT), PostgreSQL (prod) |
| **API** | REST ‚Äî 107 endpoints | `https://api-x75k2m8-v1.agtgroupholding.com/api/docs/` |

### Philosophie m√©tier (CRITIQUE)
- **Conversion avant tout :** Le site ne d√©voile pas tout (pas de prix affich√©s publiquement). Le but est d'inciter √† la prise de contact/RDV.
- **Visibilit√© dynamique :** Chaque champ d'une bourse ob√©it au `field_visibility` (Record<string, boolean>) contr√¥l√© par l'admin.

### Charte Graphique (Tailwind v4)
Primaire: `#1B365D` (Navy) | Accent: `#00AEEF` (Azur) | Or: `#C9A84C` (Gold) | Fond: `#FFFFFF` (Clair) / `#0F172A` (Sombre).

---

## üìå 2. ARCHITECTURE FRONTEND (R√®gles d'or)

```text
Composant (UI) 
    ‚Üì ne fetch jamais directement, appelle :
Dictionnaire de donn√©es (`/dictionaries/data/`)
    ‚Üì orchestre et appelle :
Repository (`/repositories/`)
    ‚Üì g√®re le endpoint et appelle :
api-client.ts (g√®re le JWT et les erreurs)
```
- **Z√©ro** appel fetch direct dans un composant UI.
- Tout texte visible ‚Üí dictionnaire **i18n** via `cmsSwitcher`.

---

## üìå 3. ROADMAP DE LIVRAISON (√Ä AUDITER √Ä CHAQUE SESSION)

> **INSTRUCTION AUDIT** : Indique le statut de chaque item : ‚úÖ (fait), üîß (en cours), ‚ùå (√† faire).

### üü† SPRINT 1 : Polish Frontend & M√©canisme CMS (Vitrine)
- [ ] **G√©n√©ralisation `cmsSwitcher` :** Cr√©er les fichiers statiques finaux (`home`, `about`, `services`, `contact`, `footer`) et remplacer les appels directs.
- [ ] **UI/UX Client :** Changer photo Hero, retirer "Travel Agency", activer Mode Sombre, ajouter micro-animations (hover, scroll).
- [ ] **D√©tail Bourse (`/bourses/[id]`) :** Appliquer le respect strict du `field_visibility` et lier le bouton WhatsApp (message pr√©-rempli).
- [ ] **Error Boundaries :** Cr√©er `not-found.tsx` et `global-error.tsx` aux couleurs de SALMA.
- [ ] **Audit Responsive :** Mobile-first (iPhone SE) et tablettes.

### üîµ SPRINT 2 : Alignement Backend & Seeders
- [ ] **Seeders Django (`seed.py`) :** Mettre √† jour `SitePage`, `ContentBlock`, `SiteConfig` avec les cl√©s exactes du frontend et les textes finaux valid√©s.
- [ ] **Test Switcher :** Passer `NEXT_PUBLIC_STATIC_CONTENT=false` et v√©rifier que la vitrine affiche les donn√©es de l'API sans casser.

### üü° SPRINT 3 : Dashboard Admin & Int√©grations
- [ ] **CMS & M√©dias :** Pages admin pour √©diter les blocs de texte et uploader des images.
- [ ] **Contacts & Newsletter :** Tableau des leads (marquer lu, notes) et liste des abonn√©s.
- [ ] **T√©moignages & KPI :** Mod√©ration des avis et graphiques de conversion.
- [ ] **Int√©grations :** Brancher Gemini API sur le Chatbot, configurer SMTP pour les alertes RDV.
- [ ] **S√©curit√© :** Ajouter un Anti-Spam (Turnstile/reCAPTCHA) sur les formulaires publics.

### üü¢ SPRINT 4 : Tests End-to-End
- [ ] **Test CMS :** Modif admin ‚ûî V√©rifier mise √† jour vitrine (ISR).
- [ ] **Test Bourses :** Cr√©ation ‚ûî Catalogue. Masquer un champ ‚ûî Disparition sur la page d√©tail.
- [ ] **Test Conversion :** Visite ‚ûî Chatbot ‚ûî Formulaire ‚ûî V√©rifier KPI et r√©ception email agence.

### üü£ SPRINT 5 : Optimisation & SEO (Production)
- [ ] **Lighthouse 95+ :** Optimisation images (WebP, next/image), Lazy Loading.
- [ ] **SEO :** Metadata dynamiques, `sitemap.xml`, `robots.txt`, balises `hreflang` pour le bilinguisme.
- [ ] **Code Review :** Supprimer console.log, code mort, ajouter JSDoc, 0 erreur TypeScript.

### üéì SPRINT 6 : Capitalisation & Documentation
- [ ] **Livrables Client :** Cahier des charges final, Rapport de projet, Guide d'utilisation Admin.
- [ ] **DevOps :** Guide de d√©ploiement, CI/CD (GitHub Actions), Cron Job de backup BDD.
- [ ] **Boilerplates AGT :** Extraire les templates Frontend et Backend pour les futurs projets.
- [ ] **Livre Blanc :** Documenter les Design Patterns utilis√©s pour l'√©quipe technique.

---

## üìå 4. PROC√âDURE √Ä SUIVRE √Ä CHAQUE SESSION

1. **LIRE** ce prompt enti√®rement.
2. **DEMANDER** les fichiers de contexte √† jour si n√©cessaire.
3. **AUDITER** la section 3 (Roadmap) et afficher le statut R√âEL (‚úÖ, üîß, ‚ùå).
4. **R√âSUMER** l'avancement global.
5. **DEMANDER** : "Sur quelle t√¢che de la roadmap veux-tu qu'on travaille aujourd'hui ?"
6. **EX√âCUTER** la t√¢che en respectant l'architecture stricte et le TypeScript.
l'EXECUTION SE FAIT DE FACON INTERACTIVE ETAPE PAR ETAPE,UNE CHOSE A LA FOIS ET TU DEMANDE TOUJOURS MON AVIS POUR FAIRE QUOI QUE CE SOIT. AVANT DE GENERER DU CODE ON DISCUTE D'ABORD DE CE QUE TU VQS Y FQIRE ET TU NE GENRE QUE A MON SIGNAL
```


// END OF FILE: prompt_livraison.md

// FILE: prompt.md
-----------------------------------------------
# üîÑ PROMPT DE CONTINUIT√â ‚Äî Projet SALMA
## AG Technologies ¬∑ Yaound√©, Cameroun
### √Ä donner √† toute IA pour reprendre le projet avec le contexte complet

---

> **INSTRUCTION SYST√àME** : Tu es un d√©veloppeur fullstack senior qui travaille sur le projet SALMA. Avant de coder quoi que ce soit, tu dois TOUJOURS commencer par l'**audit complet** d√©crit ci-dessous, puis aider sur la t√¢che demand√©e. Ne saute jamais l'audit, m√™me si je te demande directement une t√¢che.

---

## üìå 1. CONTEXTE DU PROJET

**SALMA** est un site web vitrine bilingue (FR/EN) pour **AG Technologies**, une agence camerounaise de promotion de bourses d'√©tudes et de mobilit√© vers la **Chine** et l'**Allemagne**. Le site comprend une **vitrine publique** (pour attirer et convertir des prospects) et un **dashboard admin** (pour g√©rer tout le contenu sans d√©veloppeur).

### Stack technique
| Couche | Techno | D√©tails |
|--------|--------|---------|
| **Frontend** | Next.js 15 (App Router) | TypeScript strict, Tailwind CSS v4, i18n FR/EN |
| **Backend** | Django + DRF | JWT (SimpleJWT), SQLite (dev) / PostgreSQL (prod) |
| **API** | REST ‚Äî 107 endpoints | 17 publics + 90 admin |
| **H√©bergement** | Vercel (front) + Hostinger (back) | Backend V1 d√©ploy√© |

### URL Backend d√©ploy√© (V1)
```
https://api-x75k2m8-v1.agtgroupholding.com/api/docs/
```
> Swagger UI accessible ‚Äî tous les endpoints sont testables ici.

### Identit√© visuelle
celle de ce fichier : {/* src/app/globals.css */
@import "tailwindcss";

@theme inline {
  --font-serif: var(--font-cormorant), Georgia, serif;
  --font-sans: var(--font-inter), system-ui, sans-serif;

  --color-salma-primary:       #1B365D; 
  --color-salma-primary-dark:  #11243D;
  --color-salma-primary-light: #2D5284;
  --color-salma-accent:        #00AEEF; 
  --color-salma-gold:          #C9A84C;
  --color-salma-gold-light:    #E8C97A;
  --color-salma-gold-dark:     #A68635;

  --color-bg:         var(--bg);
  --color-surface:    var(--surface);
  --color-border:     var(--border);
  --color-text:       var(--text);
  --color-text-muted: var(--text-muted);
  --color-heading:    var(--heading);

  --shadow-salma-sm:  0 2px 10px rgba(0, 174, 239, 0.05);
  --shadow-salma-md:  0 10px 30px rgba(27, 54, 93, 0.1);
  --shadow-salma-lg:  0 20px 50px rgba(27, 54, 93, 0.15);
}

:root {
  --bg:         #FFFFFF;
  --surface:    #F8FAFC;
  --border:     #E2E8F0;
  --text:       #0F172A;
  --text-muted: #64748B;
  --heading:    #1B365D; 
}

.dark {
  /* On utilise un bleu tr√®s sombre satur√© pour garder l'identit√© Navy */
  --bg:         #0F172A; /* Bleu nuit profond */
  --surface:    #1E293B; /* Bleu ardoise pour les cartes */
  --border:     #334155; /* Bordures visibles mais discr√®tes */
  --text:       #94A3B8; /* Gris bleut√© pour le texte */
  --text-muted: #64748B;
  --heading:    #F8FAFC; /* Titres en blanc cass√© pour le contraste */
}

body {
  background-color: var(--bg);
  color: var(--text);
  font-family: var(--font-sans);
  transition: background-color 0.4s ease, color 0.4s ease;
}

h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-serif);
  font-weight: 700;
  color: var(--heading); 
  transition: color 0.4s ease;
}

### Philosophie m√©tier (CRITIQUE)
- Le site **ne d√©voile pas tout** : publier le minimum pour int√©resser, inciter √† contacter l'agence (on vend l'accompagnement).
- **Pas de prix sur la vitrine** ‚Äî l'admin peut les saisir en BD mais le `field_visibility` contr√¥le ce qui s'affiche.
- Chaque champ d'une bourse est soumis √† un syst√®me de **visibilit√© par champ** (`field_visibility: Record<string, boolean>`) contr√¥l√© par l'admin.
- L'objectif n¬∞1 est la **conversion** : visiteur ‚Üí prise de contact / rendez-vous ‚Üí vente.

---

## üìå 2. ARCHITECTURE FRONTEND (S√©paration des responsabilit√©s)

```
Composant (UI)
    ‚Üì conna√Æt uniquement
Dictionnaire de donn√©es (/dictionaries/data/)
    ‚Üì appelle
Repository (/repositories/)
    ‚Üì appelle
api-client.ts
    ‚Üì appelle
Backend Django (REST API)
```

**R√®gles d'or :**
- Les **Server Components** fetchent via les **dictionnaires de donn√©es** uniquement
- Les **Client Components** utilisent des **hooks** ou re√ßoivent les donn√©es en **props**
- **Z√©ro** appel fetch direct dans un composant UI
- Tout texte visible ‚Üí dictionnaire **i18n** (fr/en)
- Tout champ de bourse ‚Üí soumis au **`field_visibility`** de l'admin

---

## üìå 3. CONTRATS D'API (107 endpoints)

| Module | Public | Admin | Total |
|--------|:------:|:-----:|:-----:|
| Auth | 2 | 7 | 9 |
| Bourses | 3 | 22 | 25 |
| Contact | 1 | 4 | 5 |
| Newsletter & Annonces | 2 | 10 | 12 |
| T√©moignages | 2 | 6 | 8 |
| Chatbot | 1 | 5 | 6 |
| CMS (Pages, Blocs, Config, Vid√©os) | 3 | 17 | 20 |
| Services | 2 | 9 | 11 |
| M√©dias | 0 | 5 | 5 |
| KPI & Analytics | 1 | 5 | 6 |
| **TOTAL** | **17** | **90** | **107** |

> Le fichier `Salma_contrats_api.md` contient les d√©tails complets (m√©thodes, endpoints, descriptions, auth requise).

---

## üìå 4. REMARQUES CLIENT (√† toujours garder en t√™te)

1. **Mode sombre** pas encore fonctionnel ‚Üí √† compl√©ter
2. **Responsive obligatoire** ‚Äî priorit√© smartphones (contexte Cameroun)
3. **Images de qualit√© sup√©rieure**
4. **Animations et hover effects** ‚Äî l'UX doit donner envie
5. Retirer **"Travel Agency"** de la navbar
6. Changer la **photo hero** de la page d'accueil
7. Chaque champ du frontend **modifiable via le dashboard admin** (CMS complet)
8. **KPI en temps r√©el** + taux de conversion
9. **Cookies & politique de confidentialit√©** (RGPD-friendly)
10. **Newsletter** pour collecter des prospects qualifi√©s
11. **Chatbot Gemini** en attendant le chatbot WhatsApp Business
12. **Vid√©o de pitch** int√©gr√©e
13. **Notifications agence** apr√®s rendez-vous (mail + WhatsApp + toast dashboard)

---

## üìå 5. TODO COMPL√àTE ‚Äî AUDIT SYST√âMATIQUE

> **INSTRUCTION** : √Ä chaque nouvelle session, parcours TOUTE cette checklist et indique pour chaque item : ‚úÖ (fait), üîß (en cours/partiel), ‚ùå (non commenc√©). Ne saute AUCUN item, m√™me ceux coch√©s ‚Äî une erreur de frappe est possible.

observer todo.md pour voir la liste des taches

## üìå 6. DOCUMENTS DE R√âF√âRENCE

Quand tu travailles sur ce projet, demande-moi toujours les fichiers suivants si tu ne les as pas d√©j√† :

| Document | Contenu | Quand le consulter |
|----------|---------|-------------------|
| `Salma_contrats_api.md` | Tous les 107 endpoints d√©taill√©s | Avant toute liaison API |
| `remarques_clients_sur_le_prototype.md` | Retours client exhaustifs | Avant toute d√©cision UX |
| `maquette_dashboard_avec_stitch.txt` | Maquette HTML du dashboard | Avant tout travail sur l'admin |
| `cahier_de_charge_salma.pdf` | Cahier des charges complet | Pour le cadrage g√©n√©ral |
| `backend_actuel` | Code source Django complet | Pour comprendre les mod√®les/serializers |
| `frontend_actuel` | Code source Next.js complet | Pour comprendre l'architecture existante |

---

## üìå 7. PROC√âDURE √Ä SUIVRE √Ä CHAQUE SESSION

```
1. LIRE ce prompt enti√®rement
2. Demander les fichiers de contexte √† jour (code frontend + backend actuels)
3. AUDITER : parcourir la section 5 (TODO compl√®te) et indiquer le statut R√âEL de chaque item
   ‚Üí Format : ‚úÖ fait | üîß partiel | ‚ùå non fait
   ‚Üí Ne sauter AUCUN item, y compris ceux marqu√©s ‚úÖ
4. IDENTIFIER les √©carts entre le statut attendu et le statut r√©el
5. R√âSUMER l'avancement global (% par phase)
6. DEMANDER : "Sur quelle t√¢che veux-tu qu'on travaille ?"
7. EX√âCUTER la t√¢che demand√©e en respectant :
   - L'architecture (composant ‚Üí dictionnaire ‚Üí repository ‚Üí api-client)
   - Le TypeScript strict
   - L'i18n (tout texte visible en FR/EN)
   - Le field_visibility sur les bourses
   - Le responsive mobile-first
```

---

## üìå 8. ORDRE D'EX√âCUTION RECOMMAND√â

1. Types TypeScript manquants (1.1) ‚Äî base de tout
2. Repositories manquants (1.2) ‚Äî briques d'acc√®s API
3. Dictionnaires manquants (1.3) ‚Äî orchestration
4. Dashboard bourses CRUD (3.2) ‚Äî valeur imm√©diate pour le client
5. Dashboard CMS (3.3) ‚Äî autonomie totale du boss
6. Formulaire contact + RDV (2.4, 2.5) ‚Äî conversion !
7. T√©moignages vitrine + admin (2.6, 3.7)
8. Newsletter vitrine + admin (4.5, 3.6)
9. Contacts & candidatures admin (3.5)
10. KPI Dashboard (3.8) ‚Äî analytics
11. Chatbot Gemini (4.1)
12. M√©dias admin (3.4)
13. Polish UX (4.2, 4.3) + Cookies (4.4)
14. SEO (4.7) + Notifications (4.6)
15. D√©ploiement final (Phase 5)

---

> **Rappel** : Le backend V1 est **d√©j√† d√©ploy√©** sur `https://api-x75k2m8-v1.agtgroupholding.com/api/docs/`. La phase actuelle est la **liaison frontend ‚Üî backend + polisage** et la compl√©tion du dashboard admin. L'objectif est d'arriver au produit complet d√©ployable.
// END OF FILE: prompt.md

// FILE: README.md
-----------------------------------------------
# üåç SALMA ‚Äî Plateforme de Bourses d'√âtudes (by AG Technologies)

> **Slogan :** "Bourse d'√©tude en Chine chez nous c'est Satisfait ou Rembours√©‚Ä¶"

Ce projet est une plateforme web moderne permettant de g√©rer et de pr√©senter des offres de bourses d'√©tudes en **Chine** et en **Allemagne**.

## üöÄ Stack Technique
- **Frontend :** Next.js 15 (App Router), Tailwind CSS v4, Shadcn UI.
- **Backend :** Django, Django REST Framework (API).
- **Base de donn√©es :** SQLite (Dev) / PostgreSQL (Prod).

## üìÇ Structure du Projet
- `/salma-frontend` : Site vitrine et Dashboard administrateur.
- `/salma-backend` : API REST Django et gestion des donn√©es.

## üõ†Ô∏è Installation Rapide (Frontend)
1. `cd salma-frontend`
2. `npm install`
3. `npm run dev`
Le site sera disponible sur `http://localhost:3000`.

## üìç Contacts & Localisation
- **Si√®ge :** Mont√©e Anne rouge, Immeuble Kadji (√† c√¥t√© de BGFI Bank), Yaound√©, Cameroun.
- **Email :** secretariatagtechnologies@gmail.com
- **T√©l√©phones :** +237 6 99 45 09 84 / +237 6 51 74 03 28
// END OF FILE: README.md

// FILE: src/app/(admin)/admin/bourses/page.tsx
-----------------------------------------------
// src/app/(admin)/admin/bourses/page.tsx
// ==============================================================================
//  Page Gestion Bourses ‚Äî tableau CRUD complet
// ==============================================================================

import { Suspense } from "react";
import AdminScholarshipsClient from "@/components/admin/AdminScholarshipsClient";
import { scholarshipAdminRepository } from "@/repositories/scholarship.repository";

async function getInitialData() {
  try {
    return await scholarshipAdminRepository.getList({ page: 1, page_size: 20 });
  } catch {
    return { results: [], count: 0, next: null, previous: null };
  }
}

export default async function AdminBoursesPage() {
  const initialData = await getInitialData();
  return (
    <Suspense fallback={
      <div className="space-y-4 animate-pulse">
        <div className="flex justify-between">
          <div className="h-8 bg-slate-200 rounded-xl w-48" />
          <div className="h-10 bg-slate-200 rounded-xl w-36" />
        </div>
        <div className="bg-white rounded-2xl border border-slate-100 overflow-hidden">
          <div className="h-14 bg-slate-50 border-b border-slate-100" />
          {[...Array(7)].map((_, i) => <div key={i} className="h-16 border-b border-slate-50 px-6 flex items-center gap-4"><div className="h-4 bg-slate-100 rounded w-1/3" /><div className="h-4 bg-slate-100 rounded w-16 ml-auto" /></div>)}
        </div>
      </div>
    }>
      <AdminScholarshipsClient initialData={initialData} />
    </Suspense>
  );
}

// END OF FILE: src/app/(admin)/admin/bourses/page.tsx

// FILE: src/app/(admin)/admin/chatbot/page.tsx
-----------------------------------------------
import AdminComingSoon from "@/components/admin/AdminComingSoon";
export default function Page() {
  return (
    <AdminComingSoon
      title="Chatbot IA (Gemini)"
      description="G√©rez la base de questions/r√©ponses du chatbot et configurez son comportement pour guider vos prospects."
      icon={<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-8 h-8"><path strokeLinecap="round" strokeLinejoin="round" d="M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 01-2.555-.337A5.972 5.972 0 015.41 20.97a5.969 5.969 0 01-.474-.065 4.48 4.48 0 00.978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25z" /></svg>}
    />
  );
}

// END OF FILE: src/app/(admin)/admin/chatbot/page.tsx

// FILE: src/app/(admin)/admin/cms/page.tsx
-----------------------------------------------
import AdminComingSoon from "@/components/admin/AdminComingSoon";
export default function Page() {
  return (
    <AdminComingSoon
      title="Gestion CMS"
      description="Modifiez le contenu de chaque page de la vitrine sans toucher au code : titres, textes, images, CTA."
      icon={<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-8 h-8"><path strokeLinecap="round" strokeLinejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931z" /><path strokeLinecap="round" strokeLinejoin="round" d="M19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" /></svg>}
    />
  );
}

// END OF FILE: src/app/(admin)/admin/cms/page.tsx

// FILE: src/app/(admin)/admin/contacts/page.tsx
-----------------------------------------------
import AdminComingSoon from "@/components/admin/AdminComingSoon";
export default function Page() {
  return (
    <AdminComingSoon
      title="Contacts & Candidatures"
      description="G√©rez les demandes de contact, les candidatures et les rendez-vous pris par vos prospects."
      icon={<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-8 h-8"><path strokeLinecap="round" strokeLinejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" /></svg>}
    />
  );
}

// END OF FILE: src/app/(admin)/admin/contacts/page.tsx

// FILE: src/app/(admin)/admin/dashboard/page.tsx
-----------------------------------------------
// src/app/(admin)/admin/dashboard/page.tsx
// ==============================================================================
//  Dashboard Admin ‚Äî Remplace le dashboard existant
//  ‚úÖ Conserve : logique fetchScholarships existante (reste accessible via /admin/bourses)
//  ‚úÖ Ajoute   : KPI temps r√©el, graphique activit√©, contacts r√©cents
// ==============================================================================

import { Suspense } from "react";
import AdminDashboardClient from "@/components/admin/AdminDashboardClient";
import { 
  kpiRepository, 
  scholarshipAdminRepository, 
  contactAdminRepository 
} from "@/repositories"; // Utiliser le barrel export pour √©viter les erreurs

async function getDashboardData() {
  const [kpi, scholarships, contacts] = await Promise.allSettled([
    kpiRepository.adminGetRealtime(),
    scholarshipAdminRepository.getList({ page: 1, page_size: 5 }),
    contactAdminRepository.getList({ page: 1, page_size: 5 }),
  ]);

  return {
    kpi:          kpi.status          === "fulfilled" ? kpi.value          : null,
    scholarships: scholarships.status === "fulfilled" ? scholarships.value : null,
    contacts:     contacts.status     === "fulfilled" ? contacts.value     : null,
  };
}

export default async function AdminDashboardPage() {
  const data = await getDashboardData();
  return (
    <Suspense fallback={<DashboardSkeleton />}>
      <AdminDashboardClient  
        kpi={data.kpi}
        scholarships={data.scholarships}
        contacts={data.contacts}
      />

    </Suspense>
  );
}

function DashboardSkeleton() {
  return (
    <div className="space-y-6 animate-pulse">
      <div className="h-8 bg-slate-200 rounded-xl w-64" />
      <div className="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-5">
        {[...Array(4)].map((_, i) => <div key={i} className="h-32 bg-slate-200 rounded-2xl" />)}
      </div>
      <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <div className="lg:col-span-2 h-72 bg-slate-200 rounded-2xl" />
        <div className="h-72 bg-slate-200 rounded-2xl" />
      </div>
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div className="h-64 bg-slate-200 rounded-2xl" />
        <div className="h-64 bg-slate-200 rounded-2xl" />
      </div>
    </div>
  );
}

// END OF FILE: src/app/(admin)/admin/dashboard/page.tsx

// FILE: src/app/(admin)/admin/kpi/page.tsx
-----------------------------------------------
import AdminComingSoon from "@/components/admin/AdminComingSoon";
export default function Page() {
  return (
    <AdminComingSoon
      title="KPI & Analytics"
      description="Visualisez vos performances : visiteurs, taux de conversion, bourses les plus consult√©es."
      icon={<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-8 h-8"><path strokeLinecap="round" strokeLinejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z" /></svg>}
    />
  );
}

// END OF FILE: src/app/(admin)/admin/kpi/page.tsx

// FILE: src/app/(admin)/admin/layout.tsx
-----------------------------------------------
"use client";
// src/app/(admin)/admin/layout.tsx

import { useState, useEffect } from "react";
import { usePathname, useRouter } from "next/navigation";
import Link from "next/link";
import { useAuth } from "@/hooks/useAuth";

// ---------------------------------------------------------------------------
//  Composants UI Internes
// ---------------------------------------------------------------------------

function SvgIcon({ d, className = "w-5 h-5" }: { d: string | string[]; className?: string }) {
  const paths = Array.isArray(d) ? d : [d];
  return (
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} strokeLinecap="round" strokeLinejoin="round" className={className}>
      {paths.map((p, i) => <path key={i} d={p} />)}
    </svg>
  );
}

const ICONS = {
  dashboard: "M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z",
  bourses: "M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.902 59.902 0 0110.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.697 50.697 0 0112 13.489a50.702 50.702 0 017.74-3.342",
  contacts: "M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75",
  cms: "M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931z",
  media: "M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z",
  temoignages: "M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z",
  newsletter: "M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z",
  chatbot: "M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 01-2.555-.337A5.972 5.972 0 015.41 20.97a5.969 5.969 0 01-.474-.065 4.48 4.48 0 00.978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25z",
  kpi: "M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zm9.75-3.375c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V9.75z",
  logout: "M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75",
  site: "M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25",
  menu: "M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5",
  chevron: "M15 19l-7-7 7-7",
};

const NAV_SECTIONS = [
  {
    label: "Principal",
    items: [
      { href: "/admin/dashboard", label: "Tableau de bord", icon: "dashboard" },
      { href: "/admin/bourses",   label: "Bourses",         icon: "bourses" },
      { href: "/admin/contacts",  label: "Contacts & RDV",  icon: "contacts", badge: true },
    ],
  },
  {
    label: "Contenu",
    items: [
      { href: "/admin/cms",         label: "Pages & CMS",   icon: "cms" },
      { href: "/admin/medias",      label: "M√©diath√®que",   icon: "media" },
      { href: "/admin/temoignages", label: "T√©moignages",   icon: "temoignages" },
      { href: "/admin/newsletter",  label: "Newsletter",    icon: "newsletter" },
    ],
  },
  {
    label: "Intelligence",
    items: [
      { href: "/admin/chatbot", label: "Chatbot / FAQ",  icon: "chatbot" },
      { href: "/admin/kpi",     label: "KPI & Analytics", icon: "kpi" },
    ],
  },
];

// ---------------------------------------------------------------------------
//  Composant Principal
// ---------------------------------------------------------------------------

export default function AdminLayout({ children }: { children: React.ReactNode }) {
  const pathname = usePathname();
  const router = useRouter();
  const { user, isLoading, isAuthenticated, logout } = useAuth();

  const [collapsed, setCollapsed] = useState(false);
  const [mobileOpen, setMobileOpen] = useState(false);

  const isLoginPage = pathname === "/admin/login";

  // 1. PROTECTION : Attendre la fin du chargement avant de rediriger
  useEffect(() => {
    if (isLoading) return; // CRITIQUE : Ne rien faire pendant le chargement

    if (!isAuthenticated && !isLoginPage) {
      router.replace(`/admin/login?redirect=${pathname}`);
    }
  }, [isLoading, isAuthenticated, isLoginPage, router, pathname]);

  // 2. Fermer le menu mobile au changement de route
  useEffect(() => { setMobileOpen(false); }, [pathname]);

  // 3. √âcran de chargement (√©vite le flash de contenu)
  if (isLoading) {
    return (
      <div className="min-h-screen bg-[#F0F2F7] flex items-center justify-center">
        <div className="flex flex-col items-center gap-4">
          <div className="w-10 h-10 border-2 border-[#1B365D] border-t-transparent rounded-full animate-spin" />
          <p className="text-sm text-slate-400">V√©rification des acc√®s‚Ä¶</p>
        </div>
      </div>
    );
  }

  // 4. SI PAGE LOGIN : Rendu nu
  if (isLoginPage) {
    return <>{children}</>;
  }

  // 5. SI PAS AUTHENTIFI√â : On ne rend rien (le useEffect redirige)
  if (!isAuthenticated) return null;

  const isActive = (href: string) => pathname === href || pathname.startsWith(href + "/");
  const initials = user?.nom_complet
    ? user.nom_complet.split(" ").map(n => n[0]).join("").slice(0, 2).toUpperCase()
    : "AD";

  // Sidebar partag√©e
  const SidebarContent = () => (
    <>
      <div className={`flex items-center gap-3 px-5 py-[18px] border-b border-white/10 ${collapsed && "justify-center px-0"}`}>
        <div className="w-9 h-9 rounded-xl bg-gradient-to-br from-[#C9A84C] to-[#A68635] flex items-center justify-center flex-shrink-0 shadow-lg shadow-[#C9A84C]/20">
          <span className="text-white font-serif font-bold text-sm">S</span>
        </div>
        {!collapsed && (
          <div>
            <p className="text-white font-serif font-bold text-lg leading-none">SALMA</p>
            <p className="text-[#C9A84C] text-[9px] font-bold uppercase tracking-[0.25em] mt-0.5">AG Technologies</p>
          </div>
        )}
      </div>

      <nav className="flex-1 overflow-y-auto py-4 space-y-5 px-3">
        {NAV_SECTIONS.map((section) => (
          <div key={section.label}>
            {!collapsed && (
              <p className="px-3 mb-1.5 text-[9px] font-bold uppercase tracking-[0.2em] text-white/30">
                {section.label}
              </p>
            )}
            <div className="space-y-0.5">
              {section.items.map((item) => {
                const active = isActive(item.href);
                return (
                  <Link
                    key={item.href}
                    href={item.href}
                    className={`relative flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-150 group ${collapsed && "justify-center px-0"} ${active ? "bg-[#C9A84C]/15 text-[#C9A84C]" : "text-white/60 hover:text-white hover:bg-white/5"}`}
                  >
                    {active && <span className="absolute left-0 top-1/2 -translate-y-1/2 w-0.5 h-5 bg-[#C9A84C] rounded-r-full" />}
                    <SvgIcon d={ICONS[item.icon as keyof typeof ICONS]} />
                    {!collapsed && <span className="flex-1">{item.label}</span>}
                  </Link>
                );
              })}
            </div>
          </div>
        ))}
      </nav>

      <div className={`border-t border-white/10 p-3 space-y-1 ${collapsed && "flex flex-col items-center"}`}>
        <Link href="/" target="_blank" className={`flex items-center gap-3 px-3 py-2 rounded-xl text-white/40 hover:text-white/70 hover:bg-white/5 transition-all ${collapsed && "justify-center px-0"}`}>
          <SvgIcon d={ICONS.site} />
          {!collapsed && <span className="text-xs font-medium">Voir le site</span>}
        </Link>
        <div className="flex items-center gap-3 px-3 py-2 rounded-xl hover:bg-white/5 transition-colors">
          <div className="w-8 h-8 rounded-full bg-gradient-to-br from-[#C9A84C] to-[#A68635] flex items-center justify-center text-white font-bold text-xs flex-shrink-0">{initials}</div>
          {!collapsed && (
            <div className="flex-1 min-w-0">
              <p className="text-white text-xs font-semibold truncate">{user?.nom_complet || "Admin"}</p>
              <button onClick={logout} className="text-red-400 text-[10px] hover:underline">D√©connexion</button>
            </div>
          )}
        </div>
      </div>
    </>
  );

  return (
    <div className="min-h-screen bg-[#F0F2F7] flex font-sans">
      {/* Overlay mobile */}
      {mobileOpen && <div className="fixed inset-0 bg-black/50 z-40 md:hidden backdrop-blur-sm" onClick={() => setMobileOpen(false)} />}

      {/* Sidebar Desktop */}
      <aside className={`fixed top-0 left-0 h-full z-50 hidden md:flex flex-col bg-[#0F1F3D] text-white transition-all duration-300 ${collapsed ? "w-[72px]" : "w-64"}`}>
        <SidebarContent />
        <button onClick={() => setCollapsed(!collapsed)} className="absolute -right-3 top-[72px] w-6 h-6 bg-[#0F1F3D] border border-white/20 rounded-full flex items-center justify-center text-white/50 hover:text-white transition-colors shadow-lg">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2} className={`w-3 h-3 transition-transform duration-300 ${collapsed && "rotate-180"}`}><path strokeLinecap="round" strokeLinejoin="round" d={ICONS.chevron} /></svg>
        </button>
      </aside>

      {/* Sidebar Mobile */}
      <aside className={`fixed top-0 left-0 h-full z-50 flex flex-col md:hidden bg-[#0F1F3D] text-white w-64 transition-transform duration-300 ${mobileOpen ? "translate-x-0" : "-translate-x-full"}`}>
        <SidebarContent />
      </aside>

      {/* Zone principale */}
      <div className={`flex-1 flex flex-col min-h-screen transition-all duration-300 ${collapsed ? "md:ml-[72px]" : "md:ml-64"}`}>
        <header className="h-16 bg-white/80 backdrop-blur-md border-b border-slate-200/80 flex items-center gap-4 px-6 sticky top-0 z-30 shadow-sm">
          <button onClick={() => setMobileOpen(true)} className="md:hidden p-2 rounded-lg text-slate-500 hover:bg-slate-100 transition-colors"><SvgIcon d={ICONS.menu} /></button>
          <div className="flex-1 text-sm font-semibold text-slate-700">Administration SALMA</div>
          <div className="w-8 h-8 rounded-full bg-gradient-to-br from-[#C9A84C] to-[#A68635] flex items-center justify-center text-white font-bold text-xs">{initials}</div>
        </header>
        <main className="flex-1 p-6 overflow-auto">
          {children}
        </main>
      </div>
    </div>
  );
}
// END OF FILE: src/app/(admin)/admin/layout.tsx

// FILE: src/app/(admin)/admin/login/page.tsx
-----------------------------------------------
"use client";
// src/app/(admin)/admin/login/page.tsx

import { useState, useEffect } from "react";
import { useRouter, useSearchParams } from "next/navigation";
import { useAuth } from "@/hooks/useAuth";
import type { LoginPayload } from "@/types/api/auth.types";

export default function AdminLoginPage() {
  const router       = useRouter();
  const searchParams = useSearchParams();
  const { login, isLoading, isAuthenticated, error, clearError } = useAuth();

  const [form, setForm]                 = useState<LoginPayload>({ email: "", password: "" });
  const [showPassword, setShowPassword] = useState(false);

  // Si d√©j√† connect√© ‚Üí rediriger
  useEffect(() => {
    if (isAuthenticated) {
      const redirect = searchParams.get("redirect") || "/admin/dashboard";
      router.replace(redirect);
    }
  }, [isAuthenticated, router, searchParams]);

  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    clearError();
    setForm((prev) => ({ ...prev, [e.target.name]: e.target.value }));
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!form.email || !form.password) return;
    const redirect = searchParams.get("redirect") || "/admin/dashboard";
    await login(form, redirect).catch(() => {});
  };

  return (
    <div className="min-h-screen flex font-sans">

      {/* ‚îÄ‚îÄ Panneau gauche ‚Äî Brand ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */}
      <div className="hidden lg:flex lg:w-[45%] flex-col justify-between p-12 bg-[#0F1F3D] relative overflow-hidden">

        {/* Grille g√©om√©trique d√©corative */}
        <div className="absolute inset-0 opacity-[0.03]"
          style={{
            backgroundImage: "linear-gradient(#fff 1px,transparent 1px),linear-gradient(90deg,#fff 1px,transparent 1px)",
            backgroundSize: "40px 40px",
          }}
        />
        {/* Cercle d√©coratif */}
        <div className="absolute -top-20 -right-20 w-80 h-80 rounded-full border border-[#C9A84C]/10" />
        <div className="absolute -bottom-16 -left-16 w-52 h-52 rounded-full border border-[#C9A84C]/8" />
        {/* Halo dor√© */}
        <div className="absolute top-0 right-0 w-96 h-96 rounded-full"
          style={{ background: "radial-gradient(circle, rgba(201,168,76,0.07) 0%, transparent 70%)" }}
        />

        {/* Logo */}
        <div className="relative z-10 flex items-center gap-3">
          <div className="w-11 h-11 rounded-xl bg-gradient-to-br from-[#C9A84C] to-[#A68635] flex items-center justify-center shadow-lg shadow-[#C9A84C]/30">
            <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" strokeWidth={2} viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" d="M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.902 59.902 0 0110.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.697 50.697 0 0112 13.489a50.702 50.702 0 017.74-3.342" />
            </svg>
          </div>
          <div>
            <p className="font-serif text-2xl font-bold text-white leading-none">SALMA</p>
            <p className="text-[9px] font-bold text-[#C9A84C] uppercase tracking-[0.3em] mt-0.5">AG Technologies</p>
          </div>
        </div>

        {/* Citation centrale */}
        <div className="relative z-10">
          <div className="w-8 h-0.5 bg-[#C9A84C] rounded mb-6" />
          <blockquote className="font-serif text-3xl font-semibold text-white leading-snug max-w-xs">
            La passerelle entre l&apos;Afrique et les meilleures universit√©s du monde.
          </blockquote>
          <p className="mt-5 text-sm text-white/40">
            Espace r√©serv√© aux administrateurs de la plateforme
          </p>
        </div>

        {/* Stats */}
        <div className="relative z-10 grid grid-cols-2 gap-3">
          {[
            { v: "500+",    l: "√âtudiants accompagn√©s" },
            { v: "25+",     l: "Universit√©s partenaires" },
            { v: "03 sem.", l: "D√©lai moyen visas" },
            { v: "100%",    l: "Taux de r√©ussite" },
          ].map((s) => (
            <div key={s.l} className="flex items-center gap-3 px-3 py-2.5 rounded-xl bg-white/5 border border-white/8">
              <span className="font-serif text-xl font-bold text-[#C9A84C] leading-none">{s.v}</span>
              <span className="text-[10px] font-medium text-white/40 uppercase tracking-wide leading-tight">{s.l}</span>
            </div>
          ))}
        </div>
      </div>

      {/* ‚îÄ‚îÄ Panneau droit ‚Äî Formulaire ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */}
      <div className="flex-1 flex items-center justify-center px-6 py-12 bg-slate-50 relative">

        {/* Points d√©coratifs fond */}
        <div className="absolute inset-0 opacity-40"
          style={{
            backgroundImage: "radial-gradient(#CBD5E1 1px, transparent 1px)",
            backgroundSize: "24px 24px",
          }}
        />

        <div className="relative z-10 w-full max-w-sm">

          {/* Badge s√©curit√© */}
          <div className="flex items-center gap-2 mb-8">
            <div className="flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-[#0F1F3D]/6 border border-[#0F1F3D]/8">
              <span className="w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-[0_0_0_3px_rgba(34,197,94,0.2)]" />
              <span className="text-[11px] font-semibold text-[#0F1F3D] tracking-wide">Syst√®me s√©curis√©</span>
            </div>
          </div>

          {/* Titre */}
          <div className="mb-8">
            <h1 className="font-serif text-4xl font-bold text-[#0F1F3D] leading-tight mb-2">
              Connexion Admin
            </h1>
            <p className="text-sm text-slate-500 leading-relaxed">
              Acc√©dez au tableau de bord de gestion de la plateforme SALMA.
            </p>
          </div>

          {/* Erreur */}
          {error && (
            <div className="flex items-start gap-3 p-4 rounded-xl bg-red-50 border border-red-200 mb-6">
              <svg className="w-4 h-4 text-red-500 flex-shrink-0 mt-0.5" viewBox="0 0 20 20" fill="currentColor">
                <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clipRule="evenodd" />
              </svg>
              <p className="text-sm text-red-700 font-medium">{error}</p>
            </div>
          )}

          {/* Formulaire */}
          <form onSubmit={handleSubmit} className="space-y-5">

            {/* Email */}
            <div>
              <label className="block text-[11px] font-bold text-slate-500 uppercase tracking-widest mb-2">
                Adresse e-mail
              </label>
              <div className="relative">
                <svg className="absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none" fill="none" stroke="currentColor" strokeWidth={1.5} viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
                </svg>
                <input
                  name="email"
                  type="email"
                  autoComplete="email"
                  required
                  value={form.email}
                  onChange={handleChange}
                  placeholder="admin@salma.cm"
                  className={`w-full pl-10 pr-4 py-3 rounded-xl border text-sm text-slate-800 bg-white placeholder:text-slate-300 outline-none transition-all
                    ${error
                      ? "border-red-300 focus:border-red-400 focus:ring-2 focus:ring-red-100"
                      : "border-slate-200 focus:border-[#C9A84C] focus:ring-2 focus:ring-[#C9A84C]/15"
                    }`}
                />
              </div>
            </div>

            {/* Mot de passe */}
            <div>
              <div className="flex items-center justify-between mb-2">
                <label className="block text-[11px] font-bold text-slate-500 uppercase tracking-widest">
                  Mot de passe
                </label>
                <span className="text-xs text-slate-400 cursor-pointer hover:text-[#1B365D] transition-colors">
                  Mot de passe oubli√© ?
                </span>
              </div>
              <div className="relative">
                <svg className="absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none" fill="none" stroke="currentColor" strokeWidth={1.5} viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z" />
                </svg>
                <input
                  name="password"
                  type={showPassword ? "text" : "password"}
                  autoComplete="current-password"
                  required
                  value={form.password}
                  onChange={handleChange}
                  placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                  className={`w-full pl-10 pr-11 py-3 rounded-xl border text-sm text-slate-800 bg-white placeholder:text-slate-300 outline-none transition-all
                    ${error
                      ? "border-red-300 focus:border-red-400 focus:ring-2 focus:ring-red-100"
                      : "border-slate-200 focus:border-[#C9A84C] focus:ring-2 focus:ring-[#C9A84C]/15"
                    }`}
                />
                <button
                  type="button"
                  onClick={() => setShowPassword(!showPassword)}
                  className="absolute right-3.5 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors"
                >
                  {showPassword ? (
                    <svg className="w-4 h-4" fill="none" stroke="currentColor" strokeWidth={1.5} viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" d="M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88" />
                    </svg>
                  ) : (
                    <svg className="w-4 h-4" fill="none" stroke="currentColor" strokeWidth={1.5} viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
                      <path strokeLinecap="round" strokeLinejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                  )}
                </button>
              </div>
            </div>

            {/* Bouton submit */}
            <button
              type="submit"
              disabled={isLoading || !form.email || !form.password}
              className="w-full flex items-center justify-center gap-2 px-6 py-3.5 rounded-xl bg-[#0F1F3D] text-white text-sm font-semibold
                hover:bg-[#1B365D] transition-all duration-200 shadow-md shadow-[#0F1F3D]/20
                hover:-translate-y-0.5 hover:shadow-lg hover:shadow-[#0F1F3D]/25
                active:translate-y-0 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none"
            >
              {isLoading ? (
                <>
                  <svg className="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24">
                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" />
                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z" />
                  </svg>
                  Connexion en cours‚Ä¶
                </>
              ) : (
                <>
                  Acc√©der au tableau de bord
                  <svg className="w-4 h-4" fill="none" stroke="currentColor" strokeWidth={2} viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
                  </svg>
                </>
              )}
            </button>
          </form>

          {/* Mention s√©curit√© */}
          <div className="flex items-center gap-2.5 mt-6 px-4 py-3 rounded-xl bg-[#0F1F3D]/4 border border-[#0F1F3D]/6">
            <svg className="w-3.5 h-3.5 text-slate-400 flex-shrink-0" fill="none" stroke="currentColor" strokeWidth={1.5} viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" />
            </svg>
            <span className="text-xs text-slate-400">
              Acc√®s prot√©g√© ‚Äî R√©serv√© aux administrateurs AG Technologies
            </span>
          </div>

          {/* Footer */}
          <p className="mt-6 text-center text-[11px] text-slate-400">
            ¬© 2026 SALMA ¬∑ AG Technologies ¬∑ Yaound√©, Cameroun
          </p>
        </div>
      </div>
    </div>
  );
}
// END OF FILE: src/app/(admin)/admin/login/page.tsx

// FILE: src/app/(admin)/admin/medias/page.tsx
-----------------------------------------------
import AdminComingSoon from "@/components/admin/AdminComingSoon";
export default function Page() {
  return (
    <AdminComingSoon
      title="M√©diath√®que"
      description="Uploadez, organisez et g√©rez toutes les images et documents utilis√©s sur votre plateforme."
      icon={<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-8 h-8"><path strokeLinecap="round" strokeLinejoin="round" d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" /></svg>}
    />
  );
}

// END OF FILE: src/app/(admin)/admin/medias/page.tsx

// FILE: src/app/(admin)/admin/newsletter/page.tsx
-----------------------------------------------
import AdminComingSoon from "@/components/admin/AdminComingSoon";
export default function Page() {
  return (
    <AdminComingSoon
      title="Newsletter & Abonn√©s"
      description="G√©rez vos abonn√©s et envoyez des annonces cibl√©es √† votre base de prospects qualifi√©s."
      icon={<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-8 h-8"><path strokeLinecap="round" strokeLinejoin="round" d="M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z" /></svg>}
    />
  );
}

// END OF FILE: src/app/(admin)/admin/newsletter/page.tsx

// FILE: src/app/(admin)/admin/temoignages/page.tsx
-----------------------------------------------
import AdminComingSoon from "@/components/admin/AdminComingSoon";
export default function Page() {
  return (
    <AdminComingSoon
      title="T√©moignages"
      description="Approuvez, rejetez et organisez les t√©moignages de vos √©tudiants pour les afficher sur la vitrine."
      icon={<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-8 h-8"><path strokeLinecap="round" strokeLinejoin="round" d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z" /></svg>}
    />
  );
}

// END OF FILE: src/app/(admin)/admin/temoignages/page.tsx

// FILE: src/app/(admin)/layout.tsx
-----------------------------------------------
// src/app/(admin)/layout.tsx
// Ce layout surcharge le RootLayout pour le groupe (admin)
// Il ne rend QUE les enfants ‚Äî la Navbar/Footer/WhatsApp ne doivent
// pas appara√Ætre sur les pages admin.

// src/app/(admin)/layout.tsx
import type { ReactNode } from "react";

export default function AdminGroupLayout({ children }: { children: ReactNode }) {
  return children;
}
// END OF FILE: src/app/(admin)/layout.tsx

// FILE: src/app/globals copy.css
-----------------------------------------------
/* src/app/globals.css */
@import "tailwindcss";

@theme inline {
  /* --- Polices --- */
  --font-serif: var(--font-cormorant), Georgia, serif;
  --font-sans: var(--font-inter), system-ui, sans-serif;

  /* --- Couleurs SALMA (Inspir√©es de la banni√®re Facebook) --- */
  /* Bleu Marine (Confiance/Banque) */
  --color-salma-primary:       #1B365D; 
  --color-salma-primary-dark:  #11243D;
  --color-salma-primary-light: #2D5284;

  /* Bleu Azur (Voyage/Action) */
  --color-salma-accent:        #00AEEF; 

  /* Or (Excellence/Bourses) */
  --color-salma-gold:          #C9A84C;
  --color-salma-gold-light:    #E8C97A;
  --color-salma-gold-dark:     #A68635;

  /* --- Tokens s√©mantiques --- */
  --color-bg:         var(--bg);
  --color-surface:    var(--surface);
  --color-border:     var(--border);
  --color-text:       var(--text);
  --color-text-muted: var(--text-muted);

  /* --- Ombres (plus l√©g√®res et a√©riennes) --- */
  --shadow-salma-sm:  0 2px 10px rgba(0, 174, 239, 0.05);
  --shadow-salma-md:  0 10px 30px rgba(27, 54, 93, 0.1);
  --shadow-salma-lg:  0 20px 50px rgba(27, 54, 93, 0.15);
}

:root {
  /* Fond CLAIR demand√© (Pure White) */
  --bg:         #FFFFFF;
  --surface:    #F8FAFC;
  --border:     #E2E8F0;
  --text:       #0F172A;
  --text-muted: #64748B;
   --heading:    #1B365D; 
}

.dark {
  /* Mode Sombre (Bleu Nuit Profond) */
  --bg:         #0A0F1A;
  --surface:    #151D2E;
  --border:     #1E293B;
  --text:       #F1F5F9;
  --text-muted: #94A3B8;
   --heading:    #F1F5F9;
}

/* --- Reset & Base --- */
body {
  background-color: var(--bg);
  color: var(--text);
  font-family: var(--font-sans);
  transition: background-color 0.4s ease, color 0.4s ease;
}

h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-serif);
  font-weight: 700;
 color: var(--heading); 
  transition: color 0.4s ease;
}

/* --- Utilitaires de test visuel --- */
.gold-divider {
  width: 50px;
  height: 3px;
  background-color: var(--color-salma-gold);
  border-radius: 10px;
}

.blue-gradient {
  background: linear-gradient(135deg, var(--color-salma-primary) 0%, var(--color-salma-accent) 100%);
}
// END OF FILE: src/app/globals copy.css

// FILE: src/app/globals.css
-----------------------------------------------
/* src/app/globals.css */
@import "tailwindcss";

@theme inline {
  --font-serif: var(--font-cormorant), Georgia, serif;
  --font-sans: var(--font-inter), system-ui, sans-serif;

  --color-salma-primary:       #1B365D; 
  --color-salma-primary-dark:  #11243D;
  --color-salma-primary-light: #2D5284;
  --color-salma-accent:        #00AEEF; 
  --color-salma-gold:          #C9A84C;
  --color-salma-gold-light:    #E8C97A;
  --color-salma-gold-dark:     #A68635;

  --color-bg:         var(--bg);
  --color-surface:    var(--surface);
  --color-border:     var(--border);
  --color-text:       var(--text);
  --color-text-muted: var(--text-muted);
  --color-heading:    var(--heading);

  --shadow-salma-sm:  0 2px 10px rgba(0, 174, 239, 0.05);
  --shadow-salma-md:  0 10px 30px rgba(27, 54, 93, 0.1);
  --shadow-salma-lg:  0 20px 50px rgba(27, 54, 93, 0.15);
}

:root {
  --bg:         #FFFFFF;
  --surface:    #F8FAFC;
  --border:     #E2E8F0;
  --text:       #0F172A;
  --text-muted: #64748B;
  --heading:    #1B365D; 
}

.dark {
  /* On utilise un bleu tr√®s sombre satur√© pour garder l'identit√© Navy */
  --bg:         #0F172A; /* Bleu nuit profond */
  --surface:    #1E293B; /* Bleu ardoise pour les cartes */
  --border:     #334155; /* Bordures visibles mais discr√®tes */
  --text:       #94A3B8; /* Gris bleut√© pour le texte */
  --text-muted: #64748B;
  --heading:    #F8FAFC; /* Titres en blanc cass√© pour le contraste */
}

body {
  background-color: var(--bg);
  color: var(--text);
  font-family: var(--font-sans);
  transition: background-color 0.4s ease, color 0.4s ease;
}

h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-serif);
  font-weight: 700;
  color: var(--heading); 
  transition: color 0.4s ease;
}
// END OF FILE: src/app/globals.css

// FILE: src/app/layout.tsx
-----------------------------------------------
// src/app/layout.tsx
import type { Metadata } from "next";
import { Cormorant_Garamond, Inter } from "next/font/google";
import "./globals.css";
import { ThemeProvider } from "@/contexts/ThemeContext";
import { LanguageProvider } from "@/contexts/LanguageContext";
import ConditionalLayout from "@/components/layout/ConditionalLayout";

const cormorant = Cormorant_Garamond({
  subsets: ["latin"],
  variable: "--font-cormorant",
  weight: ["300", "400", "500", "600", "700"],
  display: "swap",
});

const inter = Inter({
  subsets: ["latin"],
  variable: "--font-inter",
  display: "swap",
});

export const metadata: Metadata = {
  title: "SALMA ‚Äî Agence de Voyage & Bourses d'√©tudes",
  description: "Sp√©cialiste des bourses d'√©tudes en Chine et en Allemagne.",
};

export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="fr" className={`${cormorant.variable} ${inter.variable}`} suppressHydrationWarning>
      <body className="antialiased bg-salma-bg text-salma-text transition-colors duration-300">
        <ThemeProvider attribute="class" defaultTheme="light" forcedTheme="light" enableSystem={false}>
          <LanguageProvider>
            <ConditionalLayout>{children}</ConditionalLayout>
          </LanguageProvider>
        </ThemeProvider>
      </body>
    </html>
  );
}
// END OF FILE: src/app/layout.tsx

// FILE: src/app/page.tsx
-----------------------------------------------
// src/app/page.tsx
// ==============================================================================
//  Home Page ‚Äî SERVER COMPONENT
//  Fetch en parall√®le : bourses vedette + KPI publics + t√©moignages + config CMS
//  Les donn√©es sont pass√©es en props aux sections (jamais de fetch c√¥t√© client)
// ==============================================================================

import { Suspense } from "react";
import Hero from "@/sections/visitor/Hero";
import TrustBar from "@/sections/visitor/TrustBar";
import StatsCounter from "@/sections/visitor/StatsCounter";
import FeaturedScholarships from "@/sections/visitor/FeaturedScholarships";
import SuccessStories from "@/sections/visitor/SuccessStories";
import ContactForm from "@/sections/visitor/ContactForm";
import { scholarshipDictionary } from "@/dictionaries/data/scholarship.data-dictionary";
import { testimonialPublicRepository } from "@/repositories/testimonial.repository";
import { kpiRepository } from "@/repositories/kpi.repository";

// Squelettes de chargement l√©gers
function SectionSkeleton({ height = "h-64" }: { height?: string }) {
  return (
    <div className={`${height} bg-salma-surface/50 animate-pulse rounded-2xl mx-6 my-4`} />
  );
}

// Fetch en parall√®le de toutes les donn√©es de la Home
async function getHomeData() {
  try {
    const [featured, testimonials, kpiRealtime] = await Promise.allSettled([
      scholarshipDictionary.getFeatured(),
      testimonialPublicRepository.getList(),
      kpiRepository.adminGetRealtime().catch(() => null), // KPI optionnel
    ]);

    return {
      featured: featured.status === "fulfilled" ? featured.value : [],
      testimonials: testimonials.status === "fulfilled" ? testimonials.value : [],
      kpi: kpiRealtime.status === "fulfilled" ? kpiRealtime.value : null,
    };
  } catch {
    // Fallback silencieux si le backend est inaccessible
    return { featured: [], testimonials: [], kpi: null };
  }
}

export default async function Home() {
  const { featured, testimonials, kpi } = await getHomeData();

  return (
    <main>
      <Hero />
      <TrustBar />

      {/* Stats dynamiques si KPI disponibles, sinon stats statiques */}
      <Suspense fallback={<SectionSkeleton height="h-40" />}>
        <StatsCounter kpi={kpi} />
      </Suspense>

      {/* Bourses vedette ‚Äî donn√©es r√©elles du backend */}
      <Suspense fallback={<SectionSkeleton height="h-96" />}>
        <FeaturedScholarships scholarships={featured} />
      </Suspense>

      {/* T√©moignages approuv√©s */}
      <Suspense fallback={<SectionSkeleton height="h-64" />}>
        <SuccessStories testimonials={testimonials} />
      </Suspense>

      <ContactForm />
    </main>
  );
}

// END OF FILE: src/app/page.tsx

// FILE: src/app/(visitor)/a-propos/page.tsx
-----------------------------------------------
"use client";
import { useLanguage } from "@/hooks/useLanguage";
import SectionTitle from "@/components/ui/SectionTitle";
import Image from "next/image";

export default function AboutPage() {
  const { dictionary } = useLanguage();
  const a = dictionary.aboutPage;

  return (
    <div className="py-20 bg-white dark:bg-salma-bg min-h-screen">
      <div className="container mx-auto px-6">
        <div className="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center mb-24">
          <div className="relative h-[500px] rounded-3xl overflow-hidden shadow-salma-lg border-8 border-salma-surface">
            <Image src="/image.jpg" alt="AG Technologies" fill className="object-cover" />
          </div>
          <div className="space-y-8">
            <SectionTitle title={a.title} subtitle={a.subtitle} />
            <div className="space-y-6 text-salma-text-muted leading-relaxed">
              <h3 className="text-xl font-serif font-bold text-salma-primary dark:text-white">{a.missionTitle}</h3>
              <p>{a.missionDesc}</p>
              <h3 className="text-xl font-serif font-bold text-salma-primary dark:text-white">{a.visionTitle}</h3>
              <p>{a.visionDesc}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
// END OF FILE: src/app/(visitor)/a-propos/page.tsx

// FILE: src/app/(visitor)/bourses/CatalogClient.tsx
-----------------------------------------------
// src/app/(visitor)/bourses/CatalogClient.tsx
// ==============================================================================
//  CatalogClient ‚Äî Client Component
//  G√®re les interactions filtres : met √† jour l'URL ‚Üí le Server Component refetch
//  Pattern : URL as source of truth (pas de state local pour les filtres)
// ==============================================================================
"use client";

import { useCallback, useTransition } from "react";
import { useRouter, usePathname } from "next/navigation";
import Link from "next/link";
import Image from "next/image";
import { useLanguage } from "@/hooks/useLanguage";
import SectionTitle from "@/components/ui/SectionTitle";
import SalmaButton from "@/components/ui/SalmaButton";
import { getMediaUrl } from "@/lib/api-client";
import { eventsRepository } from "@/repositories/events.repository";
import type {
  ScholarshipPublicListItem,
  ScholarshipFilters,
  PaginatedResponse,
} from "@/types/api/scholarship.types";

// --- Constantes UI -----------------------------------------------------------

const PAYS_OPTIONS = [
  { value: "", label: "Tous les pays" },
  { value: "chine", label: "üá®üá≥ Chine" },
  { value: "allemagne", label: "üá©üá™ Allemagne" },
];

const NIVEAU_OPTIONS = [
  { value: "", label: "Tous les niveaux" },
  { value: "licence", label: "Licence" },
  { value: "master", label: "Master" },
  { value: "doctorat", label: "Doctorat" },
  { value: "postdoc", label: "Post-Doc" },
  { value: "formation", label: "Formation" },
];

const COUVERTURE_OPTIONS = [
  { value: "", label: "Toute couverture" },
  { value: "complete", label: "Bourse compl√®te" },
  { value: "partielle", label: "Partielle" },
  { value: "logement", label: "Logement inclus" },
];

const COVERAGE_STYLE: Record<string, string> = {
  complete:  "bg-emerald-50 text-emerald-700 border-emerald-200",
  partielle: "bg-blue-50 text-blue-700 border-blue-200",
  logement:  "bg-purple-50 text-purple-700 border-purple-200",
  transport: "bg-orange-50 text-orange-700 border-orange-200",
  autre:     "bg-gray-50 text-gray-700 border-gray-200",
};

const COVERAGE_LABEL: Record<string, string> = {
  complete:  "Bourse compl√®te",
  partielle: "Partielle",
  logement:  "Logement inclus",
  transport: "Transport",
  autre:     "Aide financi√®re",
};

const LEVEL_LABEL: Record<string, string> = {
  licence: "Licence", master: "Master", doctorat: "Doctorat",
  postdoc: "Post-Doc", formation: "Formation", autre: "Autre",
};

const FLAG: Record<string, string> = {
  chine: "üá®üá≥", allemagne: "üá©üá™", france: "üá´üá∑", canada: "üá®üá¶", autre: "üåç",
};

// --- Composant carte bourse --------------------------------------------------

function ScholarshipCard({
  scholarship,
  locale,
}: {
  scholarship: ScholarshipPublicListItem;
  locale: "fr" | "en";
}) {
  const title   = locale === "fr" ? scholarship.titre_fr : scholarship.titre_en;
  const org     = locale === "fr" ? scholarship.organisme_fr : scholarship.organisme_en;
  const imgUrl  = getMediaUrl(scholarship.image_principale?.url_fichier);
  const flag    = FLAG[scholarship.pays_destination] ?? "üåç";
  const covStyle = COVERAGE_STYLE[scholarship.type_couverture] ?? COVERAGE_STYLE.autre;
  const covLabel = COVERAGE_LABEL[scholarship.type_couverture] ?? "Aide financi√®re";

  const deadline = scholarship.date_limite
    ? new Date(scholarship.date_limite).toLocaleDateString("fr-FR", {
        day: "2-digit", month: "short", year: "numeric",
      })
    : null;

  const isUrgent = scholarship.date_limite
    ? new Date(scholarship.date_limite).getTime() - Date.now() < 30 * 24 * 60 * 60 * 1000
    : false;

  return (
    <Link
      href={`/bourses/${scholarship.id}`}
      onClick={() => eventsRepository.trackScholarshipView(scholarship.id)}
      className="group flex flex-col bg-white border border-salma-border rounded-2xl overflow-hidden shadow-sm hover:shadow-salma-lg transition-all duration-300 hover:-translate-y-1"
    >
      {/* Image */}
      <div className="relative h-44 bg-salma-surface overflow-hidden flex-shrink-0">
        {imgUrl ? (
          <Image
            src={imgUrl}
            alt={title}
            fill
            className="object-cover group-hover:scale-105 transition-transform duration-500"
          />
        ) : (
          <div className="absolute inset-0 flex items-center justify-center bg-gradient-to-br from-salma-primary/10 to-salma-gold/10">
            <span className="text-5xl">{flag}</span>
          </div>
        )}
        {isUrgent && (
          <span className="absolute top-3 left-3 px-2.5 py-1 bg-red-500 text-white text-[10px] font-bold uppercase tracking-widest rounded-full">
            ‚ö° Urgent
          </span>
        )}
        {scholarship.est_mise_en_avant && (
          <span className="absolute top-3 right-3 px-2.5 py-1 bg-salma-gold text-white text-[10px] font-bold uppercase tracking-widest rounded-full">
            ‚≠ê Vedette
          </span>
        )}
      </div>

      {/* Corps */}
      <div className="flex flex-col flex-1 p-5 gap-2.5">
        <div className="flex items-center gap-2 text-[11px] font-semibold text-salma-text-muted">
          <span>{flag} {scholarship.pays_destination.charAt(0).toUpperCase() + scholarship.pays_destination.slice(1)}</span>
          <span className="text-salma-border">¬∑</span>
          <span>{LEVEL_LABEL[scholarship.niveau] ?? scholarship.niveau}</span>
        </div>

        <h3 className="text-sm font-bold text-salma-primary leading-snug group-hover:text-salma-gold transition-colors line-clamp-2">
          {title}
        </h3>

        <p className="text-[11px] text-salma-text-muted truncate">{org}</p>

        {scholarship.domaines.length > 0 && (
          <div className="flex flex-wrap gap-1">
            {scholarship.domaines.slice(0, 3).map((d) => (
              <span key={d.id} className="px-2 py-0.5 bg-salma-bg border border-salma-border rounded-full text-[10px] text-salma-text-muted">
                {locale === "fr" ? d.nom_fr : d.nom_en}
              </span>
            ))}
          </div>
        )}

        <div className="mt-auto pt-3 border-t border-salma-border flex items-center justify-between gap-2">
          <span className={`px-2 py-0.5 text-[10px] font-semibold rounded-full border ${covStyle}`}>
            {covLabel}
          </span>
          {deadline && (
            <span className={`text-[10px] font-medium flex-shrink-0 ${isUrgent ? "text-red-500 font-bold" : "text-salma-text-muted"}`}>
              {isUrgent ? "‚ö† " : ""}Limite : {deadline}
            </span>
          )}
        </div>
      </div>
    </Link>
  );
}

// --- Squelettes de chargement ------------------------------------------------

function SkeletonGrid() {
  return (
    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      {Array.from({ length: 6 }).map((_, i) => (
        <div key={i} className="bg-white border border-salma-border rounded-2xl overflow-hidden animate-pulse">
          <div className="h-44 bg-salma-surface" />
          <div className="p-5 space-y-3">
            <div className="h-3 bg-salma-surface rounded w-1/3" />
            <div className="h-4 bg-salma-surface rounded w-5/6" />
            <div className="h-3 bg-salma-surface rounded w-2/3" />
            <div className="h-7 bg-salma-surface rounded-full w-1/2 mt-2" />
          </div>
        </div>
      ))}
    </div>
  );
}

// --- Composant principal -----------------------------------------------------

interface Props {
  initialData: PaginatedResponse<ScholarshipPublicListItem>;
  initialFilters: ScholarshipFilters;
}

export default function CatalogClient({ initialData, initialFilters }: Props) {
  const { dictionary, locale } = useLanguage();
  const router = useRouter();
  const pathname = usePathname();
  const [isPending, startTransition] = useTransition();

  // --- Mise √† jour de l'URL (source de v√©rit√© des filtres) ------------------
  const updateURL = useCallback(
    (updates: Record<string, string | undefined>) => {
      const current = new URLSearchParams();

      // Recopier les filtres existants
      if (initialFilters.pays_destination) current.set("pays", initialFilters.pays_destination);
      if (initialFilters.niveau) current.set("niveau", initialFilters.niveau);
      if (initialFilters.type_couverture) current.set("couverture", initialFilters.type_couverture);
      if (initialFilters.search) current.set("q", initialFilters.search);

      // Appliquer les mises √† jour
      Object.entries(updates).forEach(([key, val]) => {
        if (val) current.set(key, val);
        else current.delete(key);
      });

      // Reset page lors d'un changement de filtre (sauf si c'est une page)
      if (!("page" in updates)) current.delete("page");

      startTransition(() => {
        router.push(`${pathname}?${current.toString()}`);
      });
    },
    [initialFilters, pathname, router]
  );

  const handleSearch = useCallback(
    (e: React.ChangeEvent<HTMLInputElement>) => {
      const val = e.target.value;
      // Debounce l√©ger via setTimeout natif
      const timer = setTimeout(() => updateURL({ q: val || undefined }), 400);
      return () => clearTimeout(timer);
    },
    [updateURL]
  );

  const activeFiltersCount = [
    initialFilters.pays_destination,
    initialFilters.niveau,
    initialFilters.type_couverture,
    initialFilters.search,
  ].filter(Boolean).length;

  const totalPages = Math.ceil(initialData.count / (initialFilters.page_size ?? 12));
  const currentPage = initialFilters.page ?? 1;

  return (
    <div className="min-h-screen bg-salma-bg">
      <div className="container mx-auto px-4 sm:px-6 py-16">

        {/* En-t√™te */}
        <div className="max-w-3xl mb-10">
          <SectionTitle
            title={dictionary.catalog?.title ?? "Catalogue des Bourses"}
            subtitle={dictionary.catalog?.subtitle ?? "Chine & Allemagne"}
            align="left"
          />
          <p className="text-salma-text-muted text-sm mt-2">
            {dictionary.catalog?.description ?? "Trouvez la bourse qui correspond √† votre profil et lancez votre dossier avec SALMA."}
          </p>
        </div>

        {/* --- Barre de filtres --- */}
        <div className="bg-white border border-salma-border rounded-2xl p-4 sm:p-6 shadow-sm mb-8">
          <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3">

            {/* Recherche textuelle */}
            <div className="relative lg:col-span-1">
              <svg className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-salma-text-muted pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
              </svg>
              <input
                type="text"
                defaultValue={initialFilters.search ?? ""}
                onChange={handleSearch}
                placeholder="Rechercher une bourse..."
                className="w-full pl-9 pr-4 py-2.5 text-sm border border-salma-border rounded-xl bg-salma-bg outline-none focus:border-salma-primary focus:ring-2 focus:ring-salma-primary/10 transition-all"
              />
            </div>

            {/* Filtre Pays */}
            <select
              value={initialFilters.pays_destination ?? ""}
              onChange={(e) => updateURL({ pays: e.target.value || undefined })}
              className="px-4 py-2.5 text-sm border border-salma-border rounded-xl bg-salma-bg outline-none focus:border-salma-primary cursor-pointer"
            >
              {PAYS_OPTIONS.map((o) => (
                <option key={o.value} value={o.value}>{o.label}</option>
              ))}
            </select>

            {/* Filtre Niveau */}
            <select
              value={initialFilters.niveau ?? ""}
              onChange={(e) => updateURL({ niveau: e.target.value || undefined })}
              className="px-4 py-2.5 text-sm border border-salma-border rounded-xl bg-salma-bg outline-none focus:border-salma-primary cursor-pointer"
            >
              {NIVEAU_OPTIONS.map((o) => (
                <option key={o.value} value={o.value}>{o.label}</option>
              ))}
            </select>

            {/* Filtre Couverture */}
            <select
              value={initialFilters.type_couverture ?? ""}
              onChange={(e) => updateURL({ couverture: e.target.value || undefined })}
              className="px-4 py-2.5 text-sm border border-salma-border rounded-xl bg-salma-bg outline-none focus:border-salma-primary cursor-pointer"
            >
              {COUVERTURE_OPTIONS.map((o) => (
                <option key={o.value} value={o.value}>{o.label}</option>
              ))}
            </select>
          </div>

          {/* R√©sum√© + reset */}
          {(activeFiltersCount > 0 || isPending) && (
            <div className="mt-3 flex items-center justify-between">
              <p className="text-xs text-salma-text-muted">
                {isPending ? "Recherche en cours..." : `${initialData.count} bourse${initialData.count > 1 ? "s" : ""} trouv√©e${initialData.count > 1 ? "s" : ""}`}
              </p>
              {activeFiltersCount > 0 && (
                <button
                  onClick={() => router.push(pathname)}
                  className="text-xs text-salma-primary hover:underline font-medium"
                >
                  Effacer les filtres ({activeFiltersCount})
                </button>
              )}
            </div>
          )}
        </div>

        {/* --- Scholarship Matcher (CTA conversion) --- */}
        {activeFiltersCount === 0 && (
          <div className="mb-8 p-5 bg-gradient-to-r from-salma-primary to-salma-primary/80 rounded-2xl flex flex-col sm:flex-row items-center gap-4 text-white">
            <div className="flex-1">
              <p className="font-serif font-bold text-lg">üéØ Trouvez votre bourse en 3 clics</p>
              <p className="text-sm text-white/80 mt-1">Utilisez les filtres ci-dessus ou contactez-nous ‚Äî nos conseillers identifient votre bourse id√©ale gratuitement.</p>
            </div>
            <Link href="/contact">
              <SalmaButton variant="outline" className="border-white text-white hover:bg-white hover:text-salma-primary whitespace-nowrap">
                Consulter gratuitement
              </SalmaButton>
            </Link>
          </div>
        )}

        {/* --- Grille des bourses --- */}
        {isPending ? (
          <SkeletonGrid />
        ) : initialData.results.length === 0 ? (
          <div className="flex flex-col items-center justify-center py-24 text-center">
            <span className="text-6xl mb-4">üîç</span>
            <h3 className="text-xl font-serif font-bold text-salma-primary mb-2">
              Aucune bourse trouv√©e
            </h3>
            <p className="text-salma-text-muted text-sm max-w-md">
              Aucune bourse ne correspond √† vos crit√®res. Essayez d&apos;√©largir votre recherche ou contactez-nous.
            </p>
            <button
              onClick={() => router.push(pathname)}
              className="mt-6 px-6 py-2.5 rounded-xl bg-salma-primary text-white text-sm font-medium hover:bg-salma-primary/90 transition-all"
            >
              Voir toutes les bourses
            </button>
          </div>
        ) : (
          <>
            {/* Compteur r√©sultats */}
            <p className="text-xs text-salma-text-muted mb-4 font-medium">
              {initialData.count} bourse{initialData.count > 1 ? "s" : ""} disponible{initialData.count > 1 ? "s" : ""}
              {currentPage > 1 && ` ‚Äî Page ${currentPage}/${totalPages}`}
            </p>

            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
              {initialData.results.map((s) => (
                <ScholarshipCard key={s.id} scholarship={s} locale={locale} />
              ))}
            </div>

            {/* --- Pagination --- */}
            {totalPages > 1 && (
              <div className="mt-12 flex items-center justify-center gap-2">
                {/* Pr√©c√©dent */}
                <button
                  onClick={() => updateURL({ page: String(currentPage - 1) })}
                  disabled={currentPage <= 1}
                  className="px-4 py-2 rounded-xl border border-salma-border text-sm font-medium text-salma-text-muted hover:bg-salma-surface disabled:opacity-40 disabled:cursor-not-allowed transition-all"
                >
                  ‚Üê Pr√©c√©dent
                </button>

                {/* Pages num√©rot√©es */}
                {Array.from({ length: Math.min(totalPages, 5) }).map((_, i) => {
                  const page = i + 1;
                  return (
                    <button
                      key={page}
                      onClick={() => updateURL({ page: String(page) })}
                      className={`w-10 h-10 rounded-xl text-sm font-medium transition-all ${
                        page === currentPage
                          ? "bg-salma-primary text-white shadow-sm"
                          : "border border-salma-border text-salma-text-muted hover:bg-salma-surface"
                      }`}
                    >
                      {page}
                    </button>
                  );
                })}

                {/* Suivant */}
                <button
                  onClick={() => updateURL({ page: String(currentPage + 1) })}
                  disabled={currentPage >= totalPages}
                  className="px-4 py-2 rounded-xl border border-salma-border text-sm font-medium text-salma-text-muted hover:bg-salma-surface disabled:opacity-40 disabled:cursor-not-allowed transition-all"
                >
                  Suivant ‚Üí
                </button>
              </div>
            )}
          </>
        )}

        {/* --- CTA bas de page --- */}
        <div className="mt-20 text-center py-12 px-6 bg-white border border-salma-border rounded-2xl">
          <p className="text-xl font-serif font-bold text-salma-primary mb-2">
            Vous ne trouvez pas votre bourse ?
          </p>
          <p className="text-salma-text-muted text-sm mb-6 max-w-lg mx-auto">
            Nos conseillers connaissent des dizaines d&apos;opportunit√©s non list√©es ici. Contactez-nous pour une consultation gratuite.
          </p>
          <Link href="/contact">
            <SalmaButton variant="primary" size="lg">
              Parler √† un conseiller
            </SalmaButton>
          </Link>
        </div>

      </div>
    </div>
  );
}

// END OF FILE: src/app/(visitor)/bourses/CatalogClient.tsx

// FILE: src/app/(visitor)/bourses/[id]/DetailClient.tsx
-----------------------------------------------
// src/app/(visitor)/bourses/[id]/DetailClient.tsx
// ==============================================================================
//  DetailClient ‚Äî Client Component minimal
//  R√¥le unique : d√©clencher le tracking KPI au chargement de la page
//  Toute la logique d'affichage reste dans le Server Component page.tsx
// ==============================================================================
"use client";

import { useEffect } from "react";
import { eventsRepository } from "@/repositories/events.repository";

interface Props {
  scholarshipId: string;
  scholarshipTitle: string;
}

export default function DetailClient({ scholarshipId }: Props) {
  useEffect(() => {
    // Tracking vue bourse ‚Äî silencieux, ne bloque jamais le rendu
    eventsRepository.trackScholarshipView(scholarshipId);
  }, [scholarshipId]);

  // Ne rend rien ‚Äî purement comportemental
  return null;
}

// END OF FILE: src/app/(visitor)/bourses/[id]/DetailClient.tsx

// FILE: src/app/(visitor)/bourses/[id]/not-found.tsx
-----------------------------------------------
// src/app/(visitor)/bourses/[id]/not-found.tsx
import Link from "next/link";

export default function BourseNotFound() {
  return (
    <div className="min-h-screen bg-salma-bg flex items-center justify-center px-6">
      <div className="text-center max-w-md">
        <span className="text-7xl mb-6 block">üéì</span>
        <h1 className="text-2xl font-serif font-bold text-salma-primary mb-3">
          Bourse introuvable
        </h1>
        <p className="text-salma-text-muted text-sm mb-8">
          Cette bourse n&apos;existe pas ou a √©t√© retir√©e du catalogue. Consultez nos autres opportunit√©s disponibles.
        </p>
        <Link
          href="/bourses"
          className="inline-flex items-center gap-2 px-6 py-3 rounded-xl bg-salma-primary text-white font-semibold text-sm hover:bg-salma-primary/90 transition-all"
        >
          ‚Üê Voir toutes les bourses
        </Link>
      </div>
    </div>
  );
}

// END OF FILE: src/app/(visitor)/bourses/[id]/not-found.tsx

// FILE: src/app/(visitor)/bourses/[id]/page.tsx
-----------------------------------------------
// src/app/(visitor)/bourses/[id]/page.tsx
import { Metadata } from "next";
import { notFound } from "next/navigation";
import { scholarshipDictionary } from "@/dictionaries/data";
import ScholarshipDetailClient from "./ScholarshipDetailClient";

interface Props {
  params: Promise<{ id: string }>;
}

// G√©n√©ration dynamique des m√©tadonn√©es pour le SEO (Google, WhatsApp, Facebook)
export async function generateMetadata({ params }: Props): Promise<Metadata> {
  const { id } = await params;
  try {
    const { scholarship } = await scholarshipDictionary.getDetail(id);
    return {
      title: `${scholarship.titre_fr} | SALMA`,
      description: scholarship.description_fr.substring(0, 160),
    };
  } catch {
    return { title: "Bourse introuvable | SALMA" };
  }
}

export default async function ScholarshipDetailPage({ params }: Props) {
  const { id } = await params;

  try {
    // On r√©cup√®re la bourse ET la map de visibilit√© pr√©-calcul√©e
    const { scholarship, visibilityMap } = await scholarshipDictionary.getDetail(id);

    return (
      <ScholarshipDetailClient 
        scholarship={scholarship} 
        visibilityMap={visibilityMap} 
      />
    );
  } catch (error) {
    console.error("Erreur chargement bourse:", error);
    notFound(); // Redirige vers la page 404 si l'ID n'existe pas
  }
}
// END OF FILE: src/app/(visitor)/bourses/[id]/page.tsx

// FILE: src/app/(visitor)/bourses/[id]/ScholarshipDetailClient.tsx
-----------------------------------------------
// src/app/(visitor)/bourses/[id]/ScholarshipDetailClient.tsx
"use client";

import Image from "next/image";
import Link from "next/link";
import { useLanguage } from "@/hooks/useLanguage";
import { getMediaUrl } from "@/lib/api-client";
import SalmaButton from "@/components/ui/SalmaButton";
import { eventsRepository } from "@/repositories/events.repository";
import { useEffect } from "react";
import type { ScholarshipPublicDetail, FieldVisibilityMap } from "@/types/api/scholarship.types";

interface Props {
  scholarship: ScholarshipPublicDetail;
  visibilityMap: FieldVisibilityMap;
}

export default function ScholarshipDetailClient({ scholarship, visibilityMap }: Props) {
  const { dictionary, locale } = useLanguage();
  const t = dictionary.scholarshipDetail;

  // Tracking automatique de la vue
  useEffect(() => {
    eventsRepository.trackScholarshipView(scholarship.id);
  }, [scholarship.id]);

  const title = locale === "fr" ? scholarship.titre_fr : scholarship.titre_en;
  const org = locale === "fr" ? scholarship.organisme_fr : scholarship.organisme_en;
  const desc = locale === "fr" ? scholarship.description_fr : scholarship.description_en;
  
  // Construction du lien WhatsApp contextuel
  const waMessage = encodeURIComponent(
    `Bonjour SALMA, je suis int√©ress√© par la bourse : ${title}. Pouvez-vous m'aider pour le dossier ?`
  );
  const waLink = `https://wa.me/237699450984?text=${waMessage}`;

  // Helper pour v√©rifier la visibilit√© d'un champ
  const isVisible = (fieldName: string) => visibilityMap[fieldName] !== false;

  return (
    <div className="bg-salma-bg min-h-screen pb-20">
      {/* --- Fil d'ariane / Retour --- */}
      <div className="container mx-auto px-6 pt-8">
        <Link href="/bourses" className="text-salma-primary hover:text-salma-gold transition-colors text-sm font-bold flex items-center gap-2">
          ‚Üê {t.backToList}
        </Link>
      </div>

      <div className="container mx-auto px-6 mt-8 grid grid-cols-1 lg:grid-cols-3 gap-12">
        
        {/* --- COLONNE GAUCHE : Contenu Principal --- */}
        <div className="lg:col-span-2 space-y-10">
          
          {/* Image & Titre */}
          <div className="bg-white dark:bg-salma-surface rounded-3xl overflow-hidden border border-salma-border shadow-salma-md">
            <div className="relative h-[400px] w-full">
              <Image 
                src={getMediaUrl(scholarship.images.find(img => img.est_principale)?.media.url_fichier) || "/image.jpg"}
                alt={title}
                fill
                className="object-cover"
              />
              <div className="absolute inset-0 bg-gradient-to-t from-salma-primary/80 to-transparent" />
              <div className="absolute bottom-8 left-8 right-8">
                <span className="px-3 py-1 bg-salma-gold text-salma-primary text-[10px] font-black uppercase tracking-widest rounded-full">
                  {scholarship.pays_destination} ‚Ä¢ {scholarship.niveau}
                </span>
                <h1 className="text-3xl md:text-4xl font-serif font-bold text-white mt-4 leading-tight">
                  {title}
                </h1>
              </div>
            </div>

            <div className="p-8">
              <h2 className="text-xs font-black uppercase tracking-[0.2em] text-salma-gold mb-2">{t.organization}</h2>
              <p className="text-xl font-serif font-bold text-salma-primary dark:text-white">{org}</p>
            </div>
          </div>

          {/* Description (si visible) */}
          {isVisible('description_fr') && (
            <section className="bg-white dark:bg-salma-surface p-8 rounded-3xl border border-salma-border">
              <h3 className="text-xl font-serif font-bold text-salma-primary dark:text-white mb-6 border-b border-salma-border pb-4">
                Description
              </h3>
              <div className="prose prose-salma max-w-none text-salma-text-muted leading-relaxed">
                {desc}
              </div>
            </section>
          )}

          {/* Domaines d'√©tudes */}
          <section className="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div className="bg-white dark:bg-salma-surface p-8 rounded-3xl border border-salma-border">
              <h3 className="font-serif font-bold text-salma-primary dark:text-white mb-6">{t.studyFields}</h3>
              <div className="flex flex-wrap gap-2">
                {scholarship.domaines.map(d => (
                  <span key={d.id} className="px-4 py-2 bg-salma-bg border border-salma-border rounded-xl text-sm font-medium">
                    {locale === 'fr' ? d.nom_fr : d.nom_en}
                  </span>
                ))}
              </div>
            </div>

            {/* Avantages (si visible) */}
            {isVisible('avantages') && (
              <div className="bg-white dark:bg-salma-surface p-8 rounded-3xl border border-salma-border">
                <h3 className="font-serif font-bold text-salma-primary dark:text-white mb-6">{t.benefits}</h3>
                <ul className="space-y-3">
                  {scholarship.avantages.map(a => (
                    <li key={a.id} className="flex items-start gap-3 text-sm text-salma-text-muted">
                      <span className="text-salma-gold">‚úî</span>
                      {locale === 'fr' ? a.libelle_fr : a.libelle_en}
                    </li>
                  ))}
                </ul>
              </div>
            )}
          </section>
        </div>

        {/* --- COLONNE DROITE : Sidebar & Action --- */}
        <div className="space-y-6">
          <div className="bg-salma-primary text-white p-8 rounded-3xl shadow-salma-lg sticky top-24">
            <h3 className="text-xl font-serif font-bold mb-6 border-b border-white/10 pb-4">{t.eligibility}</h3>
            
            <div className="space-y-6 mb-10">
              {isVisible('date_limite') && scholarship.date_limite && (
                <div>
                  <span className="block text-[10px] uppercase tracking-widest text-salma-gold-light font-bold mb-1">{dictionary.scholarships.deadline}</span>
                  <span className="text-lg font-bold text-red-400">{new Date(scholarship.date_limite).toLocaleDateString()}</span>
                </div>
              )}

              {isVisible('exigence_langue_fr') && (
                <div>
                  <span className="block text-[10px] uppercase tracking-widest text-salma-gold-light font-bold mb-1">{dictionary.scholarships.language}</span>
                  <span className="text-lg font-bold">{locale === 'fr' ? scholarship.exigence_langue_fr : scholarship.exigence_langue_en}</span>
                </div>
              )}

              {isVisible('details_montant_fr') && (
                <div className="p-4 bg-white/5 rounded-2xl border border-white/10">
                  <span className="block text-[10px] uppercase tracking-widest text-salma-gold-light font-bold mb-1">Financement</span>
                  <span className="text-sm italic">{locale === 'fr' ? scholarship.details_montant_fr : scholarship.details_montant_en}</span>
                </div>
              )}
            </div>

            <div className="space-y-4">
              <a href={waLink} target="_blank" rel="noopener noreferrer" className="block w-full">
                <SalmaButton variant="gold" className="w-full py-4">
                  {t.btnApply}
                </SalmaButton>
              </a>
              <Link href="/contact" className="block w-full">
                <SalmaButton variant="outline" className="w-full py-4 border-white text-white hover:bg-white hover:text-salma-primary">
                  {t.btnForm}
                </SalmaButton>
              </Link>
            </div>

            <p className="text-[10px] text-center mt-6 text-white/50 italic">
              {dictionary.footer.slogan}
            </p>
          </div>
        </div>

      </div>
    </div>
  );
}
// END OF FILE: src/app/(visitor)/bourses/[id]/ScholarshipDetailClient.tsx

// FILE: src/app/(visitor)/bourses/page.tsx
-----------------------------------------------
// src/app/(visitor)/bourses/page.tsx
// ==============================================================================
//  Catalogue Bourses ‚Äî SERVER COMPONENT
//  Les filtres vivent dans l'URL (?pays=chine&niveau=master&page=2)
//  ‚Üí SEO parfait, partage d'URL, navigation navigateur fonctionnelle
//  ‚Üí fetch c√¥t√© serveur avec ISR 60s
// ==============================================================================

import { Suspense } from "react";
import type { Metadata } from "next";
import { scholarshipDictionary } from "@/dictionaries/data/scholarship.data-dictionary";
import type { ScholarshipFilters } from "@/types/api/scholarship.types";
import CatalogClient from "./CatalogClient";

// M√©tadonn√©es SEO dynamiques
export const metadata: Metadata = {
  title: "Bourses d'√©tudes ‚Äî Chine & Allemagne | SALMA",
  description:
    "Trouvez votre bourse d'√©tudes id√©ale en Chine ou en Allemagne. Filtrez par pays, niveau et type de couverture. Accompagnement complet par SALMA.",
  keywords: "bourses √©tudes Chine Cameroun, bourses Allemagne, CSC scholarship, DAAD bourse",
};

interface PageProps {
  searchParams: Promise<Record<string, string | string[] | undefined>>;
}

function getString(val: string | string[] | undefined): string | undefined {
  if (!val) return undefined;
  return Array.isArray(val) ? val[0] : val;
}

function getPage(val: string | string[] | undefined): number {
  const n = parseInt(getString(val) ?? "1", 10);
  return isNaN(n) || n < 1 ? 1 : n;
}

export default async function BoursesPage({ searchParams }: PageProps) {
  const params = await searchParams;

  // Lecture des filtres depuis l'URL
  const filters: ScholarshipFilters = {
    pays_destination: getString(params.pays) as ScholarshipFilters["pays_destination"],
    niveau: getString(params.niveau) as ScholarshipFilters["niveau"],
    type_couverture: getString(params.couverture) as ScholarshipFilters["type_couverture"],
    search: getString(params.q),
    page: getPage(params.page),
    page_size: 12,
    ordering: getString(params.tri) ?? "-est_mise_en_avant,-date_creation",
  };

  // Fetch c√¥t√© serveur ‚Äî Django filtre, pagine et trie
  let data;
  try {
    data = await scholarshipDictionary.getCatalog(filters);
  } catch {
    data = { count: 0, results: [], next: null, previous: null };
  }

  return (
    <Suspense fallback={null}>
      <CatalogClient
        initialData={data}
        initialFilters={filters}
      />
    </Suspense>
  );
}

// END OF FILE: src/app/(visitor)/bourses/page.tsx

// FILE: src/app/(visitor)/confidentialite/page.tsx
-----------------------------------------------
import SectionTitle from "@/components/ui/SectionTitle";

export default function PrivacyPage() {
  return (
    <div className="py-20 bg-salma-bg min-h-screen">
      <div className="container mx-auto px-6 max-w-4xl bg-white dark:bg-salma-surface p-12 rounded-[2rem] border border-salma-border">
        <SectionTitle title="Politique de Confidentialit√©" subtitle="RGPD & Protection" />
        <div className="prose prose-salma dark:prose-invert">
          <h3>1. Collecte des donn√©es</h3>
          <p>Nous collectons les informations que vous nous fournissez via les formulaires de contact (Nom, Email, T√©l√©phone) pour traiter vos demandes de bourses.</p>
          <h3>2. Utilisation des donn√©es</h3>
          {/* FIX : √âchappement de l'apostrophe */}
          <p>Vos donn√©es sont utilis√©es exclusivement par AG Technologies pour l&apos;accompagnement de votre dossier et l&apos;envoi de notre newsletter si vous l&apos;avez accept√©.</p>
          <h3>3. Vos droits</h3>
          <p>Vous disposez d&apos;un droit d&apos;acc√®s, de rectification et de suppression de vos donn√©es sur simple demande √† : secretariatagtechnologies@gmail.com</p>
        </div>
      </div>
    </div>
  );
}
// END OF FILE: src/app/(visitor)/confidentialite/page.tsx

// FILE: src/app/(visitor)/contact/page.tsx
-----------------------------------------------
"use client";
import ContactForm from "@/sections/visitor/ContactForm";
import SectionTitle from "@/components/ui/SectionTitle";
import { useLanguage } from "@/hooks/useLanguage";

export default function ContactPage() {
  const { dictionary } = useLanguage();

  return (
    <div className="bg-salma-bg min-h-screen">
      {/* On peut ajouter une banni√®re ou une carte Google Maps ici plus tard */}
      <div className="pt-20">
        <ContactForm />
      </div>
      
      {/* Section FAQ int√©gr√©e pour r√©duire le nombre de pages */}
      <div className="container mx-auto px-6 pb-20">
        <SectionTitle title={dictionary.faq.title} subtitle={dictionary.faq.subtitle} align="center" />
        <div className="max-w-3xl mx-auto space-y-4">
          {dictionary.faq.items.map((item, i) => (
            <details key={i} className="group bg-white dark:bg-salma-surface border border-salma-border rounded-2xl p-6 cursor-pointer">
              <summary className="font-bold text-salma-primary dark:text-white flex justify-between items-center list-none">
                {item.q}
                <span className="text-salma-gold group-open:rotate-180 transition-transform">‚ñº</span>
              </summary>
              <p className="mt-4 text-salma-text-muted text-sm">{item.a}</p>
            </details>
          ))}
        </div>
      </div>
    </div>
  );
}
// END OF FILE: src/app/(visitor)/contact/page.tsx

// FILE: src/app/(visitor)/services/page.tsx
-----------------------------------------------
"use client";
import { useLanguage } from "@/hooks/useLanguage";
import SectionTitle from "@/components/ui/SectionTitle";

export default function ServicesPage() {
  const { dictionary } = useLanguage();
  const s = dictionary.servicesPage;

  const cards = [
    { title: s.items.study.title, desc: s.items.study.desc, icon: "üéì" },
    { title: s.items.tourist.title, desc: s.items.tourist.desc, icon: "‚úàÔ∏è" },
    { title: s.items.work.title, desc: s.items.work.desc, icon: "üíº" },
    { title: s.items.insurance.title, desc: s.items.insurance.desc, icon: "üõ°Ô∏è" },
  ];

  return (
    <div className="py-20 bg-salma-bg min-h-screen">
      <div className="container mx-auto px-6">
        <SectionTitle title={s.title} subtitle={s.subtitle} align="center" />
        <p className="max-w-2xl mx-auto text-center text-salma-text-muted mb-16">{s.description}</p>
        
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
          {cards.map((card, i) => (
            <div key={i} className="p-8 bg-white dark:bg-salma-surface border border-salma-border rounded-3xl shadow-salma-sm hover:shadow-salma-md transition-all">
              <span className="text-4xl mb-6 block">{card.icon}</span>
              <h3 className="text-xl font-serif font-bold text-salma-primary dark:text-salma-gold mb-4">{card.title}</h3>
              <p className="text-sm text-salma-text-muted leading-relaxed">{card.desc}</p>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}
// END OF FILE: src/app/(visitor)/services/page.tsx

// FILE: src/components/admin/AddScholarshipModal.tsx
-----------------------------------------------
"use client";

import { useState, useEffect } from "react";
import { scholarshipDictionary } from "@/dictionaries/data";
import { SCHOLARSHIP_VISIBILITY_FIELDS, type UpdateScholarshipPayload, type FieldVisibilityMap,type CreateScholarshipPayload } from "@/types";
import SalmaButton from "../ui/SalmaButton";

interface Props {
  isOpen: boolean;
  onClose: () => void;
  onSave: () => void;
  scholarshipId?: string | null;
}

export default function AddScholarshipModal({ isOpen, onClose, onSave, scholarshipId }: Props) {
  const [activeTab, setActiveTab] = useState<"content" | "visibility" | "media">("content");
  const [loading, setLoading] = useState(false);
  
  // FIX : Typage UpdateScholarshipPayload au lieu de any
  const [form, setForm] = useState<UpdateScholarshipPayload>({
    titre_fr: "", titre_en: "", organisme_fr: "", organisme_en: "",
    description_fr: "", description_en: "", pays_destination: "chine",
    niveau: "master", statut: "publie", type_couverture: "complete"
  });
  const [visibility, setVisibility] = useState<FieldVisibilityMap>({});

  useEffect(() => {
    if (scholarshipId && isOpen) {
      setLoading(true);
      scholarshipDictionary.admin.getById(scholarshipId).then(data => {
        setForm(data);
        const vMap = data.visibilites.reduce((acc, v) => {
          acc[v.nom_du_champ] = v.est_visible;
          return acc;
        }, {} as FieldVisibilityMap);
        setVisibility(vMap);
        setLoading(false);
      });
    }
  }, [scholarshipId, isOpen]);

  const handleFinalSave = async () => {
    setLoading(true);
    try {
      if (scholarshipId) {
        await scholarshipDictionary.admin.patch(scholarshipId, form);
        await scholarshipDictionary.admin.saveVisibility(scholarshipId, visibility);
      } else {
        // En cr√©ation, on cast en CreateScholarshipPayload (le type est compatible)
        await scholarshipDictionary.admin.create(form as CreateScholarshipPayload); 
      }
      onSave();
      onClose();
    } catch {
      // FIX : Retrait du 'e' non utilis√©
      alert("Erreur lors de la sauvegarde");
    } finally {
      setLoading(false);
    }
  };

  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 z-[100] flex items-center justify-center bg-salma-primary/40 backdrop-blur-md p-4">
      <div className="bg-white rounded-[2rem] w-full max-w-5xl max-h-[90vh] flex flex-col shadow-2xl overflow-hidden border border-salma-border">
        <div className="p-8 border-b border-salma-border bg-salma-bg/50">
          <div className="flex justify-between items-center mb-6">
            <h2 className="text-2xl font-serif font-bold text-salma-primary">
              {scholarshipId ? "√âdition Bourse" : "Nouvelle Bourse"}
            </h2>
            <button onClick={onClose} className="text-salma-text-muted hover:text-salma-primary text-2xl">‚úï</button>
          </div>
          
          <div className="flex gap-8">
            {["content", "visibility", "media"].map((tab) => (
              <button
                key={tab}
                // FIX : Cast du tab pour le setter
                onClick={() => setActiveTab(tab as "content" | "visibility" | "media")}
                className={`pb-2 text-sm font-bold uppercase tracking-widest transition-all border-b-2 ${
                  activeTab === tab ? "border-salma-gold text-salma-primary" : "border-transparent text-salma-text-muted"
                }`}
              >
                {tab === "content" ? "Contenu" : tab === "visibility" ? "Visibilit√©" : "Images"}
              </button>
            ))}
          </div>
        </div>

        <div className="flex-1 overflow-y-auto p-8">
          {loading ? (
            <div className="flex justify-center py-20 italic">Chargement des donn√©es...</div>
          ) : (
            <>
              {activeTab === "content" && (
                <div className="grid grid-cols-2 gap-8">
                  <div className="space-y-4">
                    <h3 className="text-xs font-black text-salma-gold uppercase">Fran√ßais</h3>
                    <input value={form.titre_fr} onChange={e => setForm({...form, titre_fr: e.target.value})} placeholder="Titre FR" className="w-full p-4 rounded-xl border border-salma-border bg-salma-bg" />
                    <textarea value={form.description_fr} onChange={e => setForm({...form, description_fr: e.target.value})} placeholder="Description FR" rows={5} className="w-full p-4 rounded-xl border border-salma-border bg-salma-bg" />
                  </div>
                  <div className="space-y-4">
                    <h3 className="text-xs font-black text-salma-gold uppercase">Anglais</h3>
                    <input value={form.titre_en} onChange={e => setForm({...form, titre_en: e.target.value})} placeholder="Titre EN" className="w-full p-4 rounded-xl border border-salma-border bg-salma-bg" />
                    <textarea value={form.description_en} onChange={e => setForm({...form, description_en: e.target.value})} placeholder="Description EN" rows={5} className="w-full p-4 rounded-xl border border-salma-border bg-salma-bg" />
                  </div>
                </div>
              )}

              {activeTab === "visibility" && (
                <div className="space-y-6">
                  <div className="p-4 bg-blue-50 border border-blue-100 rounded-xl text-blue-800 text-sm">
                    üí° <strong>Note :</strong> D√©cochez un champ pour qu&apos;il n&apos;apparaisse pas sur le site public.
                  </div>
                  <div className="grid grid-cols-2 gap-4">
                    {SCHOLARSHIP_VISIBILITY_FIELDS.map(field => (
                      <label key={field} className="flex items-center justify-between p-4 bg-salma-bg rounded-xl border border-salma-border cursor-pointer hover:border-salma-gold transition-colors">
                        <span className="text-sm font-bold text-salma-primary">{field.replace('_', ' ')}</span>
                        <input 
                          type="checkbox" 
                          checked={visibility[field] ?? true} 
                          onChange={e => setVisibility({...visibility, [field]: e.target.checked})}
                          className="w-5 h-5 accent-salma-gold"
                        />
                      </label>
                    ))}
                  </div>
                </div>
              )}
            </>
          )}
        </div>

        <div className="p-8 border-t border-salma-border flex justify-end gap-4 bg-salma-bg/30">
          <button onClick={onClose} className="px-8 py-3 text-salma-text-muted font-bold uppercase text-xs tracking-widest">Annuler</button>
          <SalmaButton onClick={handleFinalSave} variant="primary" disabled={loading}>
            {loading ? "Sauvegarde..." : "Enregistrer les modifications"}
          </SalmaButton>
        </div>
      </div>
    </div>
  );
}
// END OF FILE: src/components/admin/AddScholarshipModal.tsx

// FILE: src/components/admin/AdminComingSoon.tsx
-----------------------------------------------
// src/components/admin/AdminComingSoon.tsx
// ==============================================================================
//  Composant placeholder pour les sections en cours de d√©veloppement
// ==============================================================================

"use client";

interface Props {
  title: string;
  description: string;
  icon: React.ReactNode;
}

export default function AdminComingSoon({ title, description, icon }: Props) {
  return (
    <div className="flex flex-col items-center justify-center min-h-[60vh] text-center px-6">
      <div className="w-16 h-16 rounded-2xl bg-[#0F1F3D]/5 flex items-center justify-center text-[#0F1F3D]/40 mb-6">
        {icon}
      </div>
      <h1 className="text-2xl font-serif font-bold text-[#0F1F3D] mb-3">{title}</h1>
      <p className="text-slate-400 text-sm max-w-sm leading-relaxed mb-8">{description}</p>
      <div className="flex items-center gap-2 px-4 py-2 bg-[#C9A84C]/10 rounded-full border border-[#C9A84C]/30">
        <span className="w-2 h-2 rounded-full bg-[#C9A84C] animate-pulse" />
        <span className="text-xs font-semibold text-[#A68635]">En cours de d√©veloppement</span>
      </div>
    </div>
  );
}

// END OF FILE: src/components/admin/AdminComingSoon.tsx

// FILE: src/components/admin/AdminDashboardClient.tsx
-----------------------------------------------
"use client";
// src/components/admin/AdminDashboardClient.tsx
// ==============================================================================
//  Dashboard Admin ‚Äî Contenu interactif c√¥t√© client
//  KPI Cards + Graphique d'activit√© + Derni√®res bourses + Derniers contacts
// ==============================================================================

import { useEffect, useState } from "react";
import Link from "next/link";
import type { KpiRealtime } from "@/types/api/kpi.types";
import type { ScholarshipAdminListResponse } from "@/types/api/scholarship.types";
import type { PaginatedContactResponse } from "@/types/api/contact.types";
// --- Types locaux ---

interface DashboardProps {
  kpi: KpiRealtime | null;
  scholarships: ScholarshipAdminListResponse | null;
  contacts: PaginatedContactResponse | null;
}

// --- Composant KPI Card -------------------------------------------------------

function KpiCard({
  label,
  value,
  delta,
  icon,
  color,
}: {
  label: string;
  value: string | number;
  delta?: string;
  icon: React.ReactNode;
  color: "navy" | "gold" | "green" | "blue";
}) {
  const colorMap = {
    navy: {
      bg: "bg-[#0F1F3D]",
      iconBg: "bg-white/10",
      iconColor: "text-white",
      text: "text-white",
      muted: "text-white/60",
      delta: "bg-white/10 text-white/80",
    },
    gold: {
      bg: "bg-white",
      iconBg: "bg-[#C9A84C]/10",
      iconColor: "text-[#C9A84C]",
      text: "text-slate-900",
      muted: "text-slate-500",
      delta: "bg-emerald-50 text-emerald-700",
    },
    green: {
      bg: "bg-white",
      iconBg: "bg-emerald-50",
      iconColor: "text-emerald-600",
      text: "text-slate-900",
      muted: "text-slate-500",
      delta: "bg-emerald-50 text-emerald-700",
    },
    blue: {
      bg: "bg-white",
      iconBg: "bg-blue-50",
      iconColor: "text-blue-600",
      text: "text-slate-900",
      muted: "text-slate-500",
      delta: "bg-blue-50 text-blue-700",
    },
  };

  const c = colorMap[color];

  return (
    <div className={`${c.bg} rounded-2xl p-5 shadow-sm border border-slate-100 hover:shadow-md transition-shadow duration-200`}>
      <div className="flex items-start justify-between mb-4">
        <div className={`w-10 h-10 rounded-xl ${c.iconBg} ${c.iconColor} flex items-center justify-center`}>
          {icon}
        </div>
        {delta && (
          <span className={`text-[11px] font-semibold px-2 py-1 rounded-full ${c.delta}`}>
            {delta}
          </span>
        )}
      </div>
      <p className={`text-3xl font-serif font-bold ${c.text} leading-none mb-1`}>{value}</p>
      <p className={`text-xs font-medium uppercase tracking-wider ${c.muted}`}>{label}</p>
    </div>
  );
}

// --- Graphique d'activit√© (barres CSS) ----------------------------------------

function ActivityChart({ data }: { data: number[] }) {
  const max = Math.max(...data, 1);
  const days = ["Lun", "Mar", "Mer", "Jeu", "Ven", "Sam", "Dim"];

  return (
    <div className="flex items-end gap-2 h-32 mt-4">
      {data.map((val, i) => (
        <div key={i} className="flex-1 flex flex-col items-center gap-1">
          <div
            className="w-full rounded-t-md bg-[#1B365D] transition-all duration-500 hover:bg-[#C9A84C]"
            style={{ height: `${(val / max) * 100}%`, minHeight: val > 0 ? "4px" : "0" }}
          />
          <span className="text-[10px] text-slate-400 font-medium">{days[i]}</span>
        </div>
      ))}
    </div>
  );
}

// --- Badge statut -------------------------------------------------------------

function StatusBadge({ status }: { status: string }) {
  const map: Record<string, { label: string; class: string }> = {
    publie: { label: "Publi√©", class: "bg-emerald-100 text-emerald-700" },
    brouillon: { label: "Brouillon", class: "bg-slate-100 text-slate-600" },
    archive: { label: "Archiv√©", class: "bg-orange-100 text-orange-700" },
    ouvert: { label: "Ouvert", class: "bg-emerald-100 text-emerald-700" },
    ferme: { label: "Ferm√©", class: "bg-slate-100 text-slate-600" },
    urgent: { label: "Urgent", class: "bg-red-100 text-red-700" },
    nouveau: { label: "Nouveau", class: "bg-blue-100 text-blue-700" },
    en_cours: { label: "En cours", class: "bg-amber-100 text-amber-700" },
    traite: { label: "Trait√©", class: "bg-emerald-100 text-emerald-700" },
  };

  const s = map[status] || { label: status, class: "bg-slate-100 text-slate-600" };

  return (
    <span className={`text-[10px] font-bold px-2 py-0.5 rounded-full ${s.class}`}>
      {s.label}
    </span>
  );
}

// --- Composant principal ------------------------------------------------------

export default function AdminDashboardClient({ kpi, scholarships, contacts }: DashboardProps) {
  const [greeting, setGreeting] = useState("Bonjour");
  const [activityData] = useState([12, 19, 8, 24, 16, 5, 11]);

  useEffect(() => {
    const h = new Date().getHours();
    if (h < 12) setGreeting("Bonjour");
    else if (h < 18) setGreeting("Bon apr√®s-midi");
    else setGreeting("Bonsoir");
  }, []);

  const totalVisitors = kpi?.total_visiteurs ?? 0;
  const totalScholarships = scholarships?.count ?? 0;
  const totalContacts = contacts?.count ?? 0;
  const conversionRate = kpi?.taux_conversion_global
    ? `${(kpi.taux_conversion_global * 100).toFixed(1)}%`
    : "‚Äî";

  return (
    <div className="space-y-6 max-w-[1400px]">
      {/* ‚îÄ‚îÄ En-t√™te ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */}
      <div className="flex items-start justify-between flex-wrap gap-4">
        <div>
          <h1 className="text-2xl font-serif font-bold text-[#0F1F3D]">
            {greeting}, Admin üëã
          </h1>
          <p className="text-slate-500 text-sm mt-0.5">
            Voici un aper√ßu de votre plateforme SALMA aujourd&apos;hui.
          </p>
        </div>
        <div className="flex gap-3">
          <Link
            href="/admin/bourses/new"
            className="flex items-center gap-2 px-4 py-2 bg-[#0F1F3D] text-white text-sm font-semibold rounded-xl hover:bg-[#1B365D] transition-colors shadow-md shadow-[#0F1F3D]/20"
          >
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2} className="w-4 h-4">
              <path strokeLinecap="round" strokeLinejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
            </svg>
            Nouvelle bourse
          </Link>
        </div>
      </div>

      {/* ‚îÄ‚îÄ KPI Cards ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */}
      <div className="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-5">
        <KpiCard
          label="Visiteurs totaux"
          value={totalVisitors.toLocaleString("fr-FR")}
          delta="+12% ce mois"
          color="navy"
          icon={
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-5 h-5">
              <path strokeLinecap="round" strokeLinejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
            </svg>
          }
        />
        <KpiCard
          label="Bourses actives"
          value={totalScholarships}
          delta={`${totalScholarships} au total`}
          color="gold"
          icon={
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-5 h-5">
              <path strokeLinecap="round" strokeLinejoin="round" d="M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.902 59.902 0 0110.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.697 50.697 0 0112 13.489a50.702 50.702 0 017.74-3.342M6.75 15a.75.75 0 100-1.5.75.75 0 000 1.5zm0 0v-3.675A55.378 55.378 0 0112 8.443m-7.007 11.55A5.981 5.981 0 006.75 15.75v-1.5" />
            </svg>
          }
        />
        <KpiCard
          label="Demandes re√ßues"
          value={totalContacts}
          delta="dont non lues"
          color="green"
          icon={
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-5 h-5">
              <path strokeLinecap="round" strokeLinejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
            </svg>
          }
        />
        <KpiCard
          label="Taux de conversion"
          value={conversionRate}
          delta="visiteurs ‚Üí contacts"
          color="blue"
          icon={
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-5 h-5">
              <path strokeLinecap="round" strokeLinejoin="round" d="M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941" />
            </svg>
          }
        />
      </div>

      {/* ‚îÄ‚îÄ Ligne principale ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */}
      <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">

        {/* Graphique d'activit√© */}
        <div className="lg:col-span-2 bg-white rounded-2xl p-6 shadow-sm border border-slate-100">
          <div className="flex items-center justify-between mb-1">
            <h2 className="text-base font-bold text-slate-800">Activit√© cette semaine</h2>
            <span className="text-xs text-slate-400 font-medium">Vues bourses</span>
          </div>
          <p className="text-xs text-slate-400 mb-2">Nombre de pages bourses vues par jour</p>
          <ActivityChart data={activityData} />
        </div>

        {/* R√©partition bourses */}
        <div className="bg-white rounded-2xl p-6 shadow-sm border border-slate-100">
          <h2 className="text-base font-bold text-slate-800 mb-4">R√©partition</h2>
          <div className="space-y-4">
            {[
              { label: "Bourses Chine", value: 68, color: "bg-[#0F1F3D]", flag: "üá®üá≥" },
              { label: "Bourses Allemagne", value: 32, color: "bg-[#C9A84C]", flag: "üá©üá™" },
            ].map((item) => (
              <div key={item.label}>
                <div className="flex items-center justify-between mb-1.5">
                  <span className="text-sm text-slate-600 flex items-center gap-1.5">
                    <span>{item.flag}</span>
                    {item.label}
                  </span>
                  <span className="text-sm font-bold text-slate-800">{item.value}%</span>
                </div>
                <div className="h-2 bg-slate-100 rounded-full overflow-hidden">
                  <div
                    className={`h-full ${item.color} rounded-full transition-all duration-700`}
                    style={{ width: `${item.value}%` }}
                  />
                </div>
              </div>
            ))}

            <div className="h-px bg-slate-100 my-2" />

            {/* Quick links */}
            <div className="space-y-2">
              <p className="text-[10px] font-bold uppercase tracking-widest text-slate-400">Actions rapides</p>
              {[
                { href: "/admin/bourses/new", label: "+ Ajouter une bourse" },
                { href: "/admin/contacts", label: "‚Üí Voir les contacts" },
                { href: "/admin/kpi", label: "üìä Voir les analytics" },
              ].map((link) => (
                <Link
                  key={link.href}
                  href={link.href}
                  className="block text-xs text-[#1B365D] hover:text-[#C9A84C] font-medium transition-colors"
                >
                  {link.label}
                </Link>
              ))}
            </div>
          </div>
        </div>
      </div>

      {/* ‚îÄ‚îÄ Ligne inf√©rieure : Derni√®res bourses + Derniers contacts ‚îÄ */}
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">

        {/* Derni√®res bourses */}
        <div className="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
          <div className="px-6 py-4 border-b border-slate-100 flex items-center justify-between">
            <h2 className="text-base font-bold text-slate-800">Derni√®res bourses</h2>
            <Link href="/admin/bourses" className="text-xs text-[#1B365D] hover:text-[#C9A84C] font-semibold transition-colors">
              Voir tout ‚Üí
            </Link>
          </div>
          <div className="divide-y divide-slate-50">
            {scholarships?.results.length ? (
              scholarships.results.map((s) => (
                <div key={s.id} className="px-6 py-3.5 flex items-center gap-4 hover:bg-slate-50/60 transition-colors">
                  <div className="w-8 h-8 rounded-lg bg-[#0F1F3D]/5 flex items-center justify-center text-sm flex-shrink-0">
                    {s.pays_destination === "chine" ? "üá®üá≥" : "üá©üá™"}
                  </div>
                  <div className="flex-1 min-w-0">
                    <p className="text-sm font-semibold text-slate-800 truncate">{s.titre_fr}</p>
                    <p className="text-[10px] text-slate-400">
                      {new Date(s.date_creation).toLocaleDateString("fr-FR", { day: "numeric", month: "short", year: "numeric" })}
                    </p>
                  </div>
                  <StatusBadge status={s.statut} />
                  <Link href={`/admin/bourses/${s.id}/edit`} className="text-slate-300 hover:text-[#1B365D] transition-colors ml-1">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-4 h-4">
                      <path strokeLinecap="round" strokeLinejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931z" />
                    </svg>
                  </Link>
                </div>
              ))
            ) : (
              <div className="px-6 py-8 text-center text-sm text-slate-400">
                Aucune bourse pour le moment.
              </div>
            )}
          </div>
        </div>

        {/* Derniers contacts */}
        <div className="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
          <div className="px-6 py-4 border-b border-slate-100 flex items-center justify-between">
            <h2 className="text-base font-bold text-slate-800">Derni√®res demandes</h2>
            <Link href="/admin/contacts" className="text-xs text-[#1B365D] hover:text-[#C9A84C] font-semibold transition-colors">
              Voir tout ‚Üí
            </Link>
          </div>
          <div className="divide-y divide-slate-50">
            {contacts?.results.length ? (
              contacts.results.map((c) => {
                const initials = c.nom_complet
                  .split(" ")
                  .map((n: string) => n[0])
                  .join("")
                  .slice(0, 2)
                  .toUpperCase();
                return (
                  <div key={c.id} className="px-6 py-3.5 flex items-center gap-4 hover:bg-slate-50/60 transition-colors">
                    <div className="w-8 h-8 rounded-full bg-gradient-to-br from-[#1B365D] to-[#2D5284] flex items-center justify-center text-white text-xs font-bold flex-shrink-0">
                      {initials}
                    </div>
                    <div className="flex-1 min-w-0">
                      <p className="text-sm font-semibold text-slate-800 truncate">{c.nom_complet}</p>
                      <p className="text-[10px] text-slate-400 truncate">{c.email}</p>
                    </div>
                    <div className="flex flex-col items-end gap-1">
                      <StatusBadge status={c.statut} />
                      <span className="text-[9px] text-slate-400">
                        {new Date(c.date_creation).toLocaleDateString("fr-FR", { day: "numeric", month: "short" })}
                      </span>
                    </div>
                  </div>
                );
              })
            ) : (
              <div className="px-6 py-8 text-center text-sm text-slate-400">
                Aucune demande pour le moment.
              </div>
            )}
          </div>
        </div>
      </div>

      {/* ‚îÄ‚îÄ Footer info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */}
      <div className="flex items-center justify-between text-xs text-slate-400 pt-2 pb-4">
        <span>SALMA Admin v1.0 ‚Äî AG Technologies</span>
        <span>Backend : <a href="https://api-x75k2m8-v1.agtgroupholding.com/api/docs/" target="_blank" rel="noopener noreferrer" className="text-[#1B365D] hover:underline">API Docs</a></span>
      </div>
    </div>
  );
}

// END OF FILE: src/components/admin/AdminDashboardClient.tsx

// FILE: src/components/admin/AdminNotificationBell.tsx
-----------------------------------------------
"use client";
// src/components/admin/AdminNotificationBell.tsx
// ==============================================================================
//  Cloche de notification ‚Äî badge contacts non lus
//  Polling toutes les 60s via contact repository
// ==============================================================================

import { useState, useEffect } from "react";

export default function AdminNotificationBell() {
  const [count, setCount] = useState(0);
  const [open, setOpen] = useState(false);

  // Polling l√©ger ‚Äî remplac√© par WebSocket plus tard
  useEffect(() => {
    const fetchUnread = async () => {
      try {
        const { contactAdminRepository } = await import("@/repositories/contact.repository");
        const data = await contactAdminRepository.getList({ est_lu: false, page_size: 1 });
        setCount(data.count ?? 0);
      } catch {
        // Silencieux ‚Äî pas de crash si backend inaccessible
      }
    };

    fetchUnread();
    const interval = setInterval(fetchUnread, 60_000);
    return () => clearInterval(interval);
  }, []);

  return (
    <div className="relative">
      <button
        onClick={() => setOpen(!open)}
        className="relative p-2 rounded-lg text-slate-500 hover:bg-slate-100 transition-colors"
      >
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-5 h-5">
          <path strokeLinecap="round" strokeLinejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" />
        </svg>
        {count > 0 && (
          <span className="absolute top-1.5 right-1.5 w-2 h-2 bg-red-500 rounded-full animate-pulse border border-white" />
        )}
      </button>

      {/* Dropdown */}
      {open && (
        <>
          <div className="fixed inset-0 z-10" onClick={() => setOpen(false)} />
          <div className="absolute right-0 mt-2 w-72 bg-white rounded-2xl shadow-xl border border-slate-100 z-20 overflow-hidden">
            <div className="px-4 py-3 border-b border-slate-100 flex items-center justify-between">
              <span className="text-sm font-bold text-slate-800">Notifications</span>
              {count > 0 && (
                <span className="bg-red-100 text-red-600 text-xs font-bold px-2 py-0.5 rounded-full">
                  {count} nouveau{count > 1 ? "x" : ""}
                </span>
              )}
            </div>
            <div className="p-4 text-center text-sm text-slate-400">
              {count > 0 ? (
                <a href="/admin/contacts" className="text-[#1B365D] font-semibold hover:underline">
                  Voir les {count} demande{count > 1 ? "s" : ""} non trait√©e{count > 1 ? "s" : ""}
                </a>
              ) : (
                <span>Aucune nouvelle notification</span>
              )}
            </div>
          </div>
        </>
      )}
    </div>
  );
}

// END OF FILE: src/components/admin/AdminNotificationBell.tsx

// FILE: src/components/admin/AdminScholarshipsClient.tsx
-----------------------------------------------
"use client";
// src/components/admin/AdminScholarshipsClient.tsx

import { useState, useCallback, useTransition } from "react";
import { scholarshipAdminRepository } from "@/repositories/scholarship.repository";
import { toFieldVisibilityMap } from "@/types/api/scholarship.types";
import type {
  ScholarshipAdmin,
  CreateScholarshipPayload,
} from "@/types/api/scholarship.types";

// ---------------------------------------------------------------------------
//  Helpers
// ---------------------------------------------------------------------------

function StatusBadge({ status }: { status: string }) {
  const map: Record<string, string> = {
    publie: "bg-emerald-100 text-emerald-700 border-emerald-200",
    brouillon: "bg-slate-100 text-slate-600 border-slate-200",
    archive: "bg-orange-100 text-orange-700 border-orange-200",
    expire: "bg-gray-100 text-gray-600 border-gray-200",
  };
  const labels: Record<string, string> = {
    publie: "Publi√©", brouillon: "Brouillon", archive: "Archiv√©", expire: "Expir√©",
  };
  const cls = map[status] || "bg-slate-100 text-slate-600 border-slate-200";
  return (
    <span className={`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-[10px] font-bold border ${cls}`}>
      <span className="w-1.5 h-1.5 rounded-full bg-current" />
      {labels[status] || status}
    </span>
  );
}

function Flag({ country }: { country: string }) {
  return <>{country === "chine" ? "üá®üá≥" : country === "allemagne" ? "üá©üá™" : "üåç"}</>;
}

// ---------------------------------------------------------------------------
//  Valeurs par d√©faut ‚Äî types exacts de CreateScholarshipPayload
// ---------------------------------------------------------------------------

const EMPTY_FORM: Partial<CreateScholarshipPayload> = {
  titre_fr: "",
  titre_en: "",
  organisme_fr: "",
  organisme_en: "",
  description_fr: "",
  description_en: "",
  pays_destination: "chine",
  niveau: "master",            // FIX : lowercase = ScholarshipLevel
  type_couverture: "complete", // FIX : lowercase = ScholarshipCoverage
  statut: "brouillon",
  date_limite: "",
  lien_officiel: "",
  exigence_langue_fr: "",
  exigence_langue_en: "",
  est_mise_en_avant: false,    // FIX : nom exact (pas est_en_avant)
};

const FIELD_VISIBILITY_DEFAULTS: Record<string, boolean> = {
  description_fr: true,
  description_en: true,
  date_limite: true,
  type_couverture: true,
  exigence_langue_fr: true,
  exigence_langue_en: true,
  avantages: true,
  criteres: true,
  images: true,
  lien_officiel: false,
  details_montant_fr: false,
  details_montant_en: false,
};

// ---------------------------------------------------------------------------
//  Modal
// ---------------------------------------------------------------------------

function ScholarshipModal({
  scholarship,
  onClose,
  onSave,
}: {
  scholarship: ScholarshipAdmin | null;
  onClose: () => void;
  onSave: (data: CreateScholarshipPayload) => Promise<void>;
}) {
  const [form, setForm] = useState<Partial<CreateScholarshipPayload>>(
    scholarship
      ? {
          titre_fr: scholarship.titre_fr,
          titre_en: scholarship.titre_en,
          organisme_fr: scholarship.organisme_fr,
          organisme_en: scholarship.organisme_en,
          description_fr: scholarship.description_fr,
          description_en: scholarship.description_en,
          pays_destination: scholarship.pays_destination,
          niveau: scholarship.niveau,
          type_couverture: scholarship.type_couverture,
          statut: scholarship.statut,
          date_limite: scholarship.date_limite || "",
          lien_officiel: scholarship.lien_officiel || "",
          exigence_langue_fr: scholarship.exigence_langue_fr || "",
          exigence_langue_en: scholarship.exigence_langue_en || "",
          est_mise_en_avant: scholarship.est_mise_en_avant, // FIX
        }
      : EMPTY_FORM
  );

  // FIX : scholarship.visibilites (FieldVisibility[]) ‚Üí map via helper
  const [visibility, setVisibility] = useState<Record<string, boolean>>(
    scholarship?.visibilites
      ? toFieldVisibilityMap(scholarship.visibilites)
      : FIELD_VISIBILITY_DEFAULTS
  );

  const [saving, setSaving] = useState(false);
  const [error, setError] = useState("");
  const [activeTab, setActiveTab] = useState<"info" | "visibility" | "avanced">("info");

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!form.titre_fr?.trim()) { setError("Le titre FR est requis."); return; }
    setSaving(true);
    setError("");
    try {
      // FIX : field_visibility n'existe pas dans CreateScholarshipPayload
      await onSave(form as CreateScholarshipPayload);
      onClose();
    } catch (err) {
      setError(err instanceof Error ? err.message : "Une erreur est survenue.");
    } finally {
      setSaving(false);
    }
  };

  const set = (field: string, value: unknown) =>
    setForm((prev) => ({ ...prev, [field]: value }));

  const inputCls = "w-full px-3 py-2.5 rounded-xl border border-slate-200 text-sm text-slate-800 bg-white focus:outline-none focus:ring-2 focus:ring-[#1B365D]/20 focus:border-[#1B365D] placeholder:text-slate-300 transition-all";
  const labelCls = "block text-xs font-semibold text-slate-600 mb-1.5 uppercase tracking-wider";
  const selectCls = `${inputCls} appearance-none cursor-pointer`;

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm">
      <div className="w-full max-w-3xl max-h-[90vh] flex flex-col bg-white rounded-3xl shadow-2xl overflow-hidden">
        {/* Header */}
        <div className="flex items-center justify-between px-8 py-6 border-b border-slate-100 bg-white">
          <div>
            <h2 className="text-2xl font-serif font-bold text-[#0F1F3D]">
              {scholarship ? "Modifier la bourse" : "Nouvelle bourse"}
            </h2>
            <p className="text-xs text-slate-400 mt-0.5">
              {scholarship ? `ID : ${scholarship.id}` : "Remplissez les informations de la bourse"}
            </p>
          </div>
          <button onClick={onClose} className="p-2 rounded-full hover:bg-slate-100 text-slate-400 hover:text-slate-600 transition-colors">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2} className="w-5 h-5">
              <path strokeLinecap="round" strokeLinejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>

        {/* Tabs */}
        <div className="flex gap-1 px-8 pt-4 pb-0 border-b border-slate-100 bg-slate-50/50">
          {([
            { key: "info", label: "Informations" },
            { key: "visibility", label: "Visibilit√© champs" },
            { key: "avanced", label: "Options" },
          ] as const).map((tab) => (
            <button
              key={tab.key}
              onClick={() => setActiveTab(tab.key)}
              className={`px-4 py-2.5 text-xs font-semibold rounded-t-xl transition-colors border-b-2 -mb-px ${
                activeTab === tab.key
                  ? "text-[#0F1F3D] border-[#C9A84C] bg-white"
                  : "text-slate-400 border-transparent hover:text-slate-600"
              }`}
            >
              {tab.label}
            </button>
          ))}
        </div>

        {/* Body */}
        <form onSubmit={handleSubmit} className="flex-1 overflow-y-auto">
          <div className="p-8 space-y-6">

            {/* ‚îÄ‚îÄ Informations ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */}
            {activeTab === "info" && (
              <>
                <div>
                  <h3 className="text-sm font-bold text-slate-500 uppercase tracking-wider mb-4 flex items-center gap-2">
                    <span className="w-4 h-px bg-slate-300 inline-block" /> Titre & Organisme
                  </h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                      <label className={labelCls}>Titre (FR) *</label>
                      <input className={inputCls} value={form.titre_fr || ""} onChange={(e) => set("titre_fr", e.target.value)} placeholder="ex: Bourse CSC Chine 2026" required />
                    </div>
                    <div>
                      <label className={labelCls}>Titre (EN)</label>
                      <input className={inputCls} value={form.titre_en || ""} onChange={(e) => set("titre_en", e.target.value)} placeholder="ex: CSC China Scholarship 2026" />
                    </div>
                    <div>
                      <label className={labelCls}>Organisme (FR)</label>
                      <input className={inputCls} value={form.organisme_fr || ""} onChange={(e) => set("organisme_fr", e.target.value)} />
                    </div>
                    <div>
                      <label className={labelCls}>Organisme (EN)</label>
                      <input className={inputCls} value={form.organisme_en || ""} onChange={(e) => set("organisme_en", e.target.value)} />
                    </div>
                  </div>
                </div>

                <div>
                  <h3 className="text-sm font-bold text-slate-500 uppercase tracking-wider mb-4 flex items-center gap-2">
                    <span className="w-4 h-px bg-slate-300 inline-block" /> Caract√©ristiques
                  </h3>
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                      <label className={labelCls}>Destination</label>
                      <select className={selectCls} value={form.pays_destination || "chine"} onChange={(e) => set("pays_destination", e.target.value)}>
                        <option value="chine">üá®üá≥ Chine</option>
                        <option value="allemagne">üá©üá™ Allemagne</option>
                        <option value="france">üá´üá∑ France</option>
                        <option value="canada">üá®üá¶ Canada</option>
                        <option value="autre">üåç Autre</option>
                      </select>
                    </div>
                    <div>
                      <label className={labelCls}>Niveau</label>
                      {/* FIX : valeurs lowercase = ScholarshipLevel */}
                      <select className={selectCls} value={form.niveau || "master"} onChange={(e) => set("niveau", e.target.value)}>
                        <option value="licence">Licence</option>
                        <option value="master">Master</option>
                        <option value="doctorat">Doctorat</option>
                        <option value="postdoc">Post-Doctorat</option>
                        <option value="formation">Formation</option>
                        <option value="autre">Autre</option>
                      </select>
                    </div>
                    <div>
                      <label className={labelCls}>Couverture</label>
                      {/* FIX : valeurs lowercase = ScholarshipCoverage */}
                      <select className={selectCls} value={form.type_couverture || "complete"} onChange={(e) => set("type_couverture", e.target.value)}>
                        <option value="complete">Compl√®te</option>
                        <option value="partielle">Partielle</option>
                        <option value="logement">Logement</option>
                        <option value="transport">Transport</option>
                        <option value="autre">Autre</option>
                      </select>
                    </div>
                    <div>
                      <label className={labelCls}>Statut</label>
                      {/* FIX : valeurs = ScholarshipStatus */}
                      <select className={selectCls} value={form.statut || "brouillon"} onChange={(e) => set("statut", e.target.value)}>
                        <option value="brouillon">Brouillon</option>
                        <option value="publie">Publi√©</option>
                        <option value="expire">Expir√©</option>
                        <option value="archive">Archiv√©</option>
                      </select>
                    </div>
                    <div>
                      <label className={labelCls}>Date limite</label>
                      <input type="date" className={inputCls} value={form.date_limite || ""} onChange={(e) => set("date_limite", e.target.value)} />
                    </div>
                    <div>
                      <label className={labelCls}>Lien officiel</label>
                      <input type="url" className={inputCls} value={form.lien_officiel || ""} onChange={(e) => set("lien_officiel", e.target.value)} placeholder="https://..." />
                    </div>
                  </div>
                </div>

                <div>
                  <h3 className="text-sm font-bold text-slate-500 uppercase tracking-wider mb-4 flex items-center gap-2">
                    <span className="w-4 h-px bg-slate-300 inline-block" /> Description
                  </h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                      <label className={labelCls}>Description (FR)</label>
                      <textarea className={`${inputCls} min-h-[120px] resize-y`} value={form.description_fr || ""} onChange={(e) => set("description_fr", e.target.value)} placeholder="D√©crivez la bourse en fran√ßais..." />
                    </div>
                    <div>
                      <label className={labelCls}>Description (EN)</label>
                      <textarea className={`${inputCls} min-h-[120px] resize-y`} value={form.description_en || ""} onChange={(e) => set("description_en", e.target.value)} placeholder="Describe the scholarship in English..." />
                    </div>
                    <div>
                      <label className={labelCls}>Exigence langue (FR)</label>
                      <input className={inputCls} value={form.exigence_langue_fr || ""} onChange={(e) => set("exigence_langue_fr", e.target.value)} placeholder="ex: HSK 4 ou sans exigence" />
                    </div>
                    <div>
                      <label className={labelCls}>Exigence langue (EN)</label>
                      <input className={inputCls} value={form.exigence_langue_en || ""} onChange={(e) => set("exigence_langue_en", e.target.value)} placeholder="ex: HSK 4 or no requirement" />
                    </div>
                  </div>
                </div>
              </>
            )}

            {/* ‚îÄ‚îÄ Visibilit√© ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */}
            {activeTab === "visibility" && (
              <div>
                <p className="text-sm text-slate-500 mb-6 bg-amber-50 border border-amber-200 rounded-xl px-4 py-3">
                  ‚ö†Ô∏è Contr√¥lez ce que les visiteurs voient sur la vitrine.
                </p>
                <div className="space-y-3">
                  {Object.entries({
                    description_fr: "Description (FR)",
                    description_en: "Description (EN)",
                    date_limite: "Date limite",
                    type_couverture: "Type de couverture",
                    exigence_langue_fr: "Exigences langue (FR)",
                    exigence_langue_en: "Exigences langue (EN)",
                    avantages: "Avantages",
                    criteres: "Crit√®res d'√©ligibilit√©",
                    images: "Images",
                    lien_officiel: "Lien officiel",
                    details_montant_fr: "üí∞ Montant / Prix (FR)",
                    details_montant_en: "üí∞ Montant / Prix (EN)",
                  }).map(([key, label]) => {
                    const isEnabled = visibility[key] ?? false;
                    const isMontant = key.startsWith("details_montant");
                    return (
                      <div key={key} className={`flex items-center justify-between px-4 py-3 rounded-xl border transition-all ${isEnabled ? "bg-white border-slate-200" : "bg-slate-50 border-slate-100"} ${isMontant ? "border-red-200 bg-red-50/30" : ""}`}>
                        <div className="flex items-center gap-3">
                          <div className={`w-8 h-8 rounded-lg flex items-center justify-center text-xs ${isEnabled ? "bg-emerald-100 text-emerald-700" : "bg-slate-200 text-slate-400"}`}>
                            {isEnabled ? "‚úì" : "‚Äî"}
                          </div>
                          <div>
                            <p className={`text-sm font-medium ${isEnabled ? "text-slate-800" : "text-slate-400"}`}>{label}</p>
                            {isMontant && <p className="text-[10px] text-red-500 font-medium">Recommand√© : masqu√© sur la vitrine</p>}
                          </div>
                        </div>
                        <button
                          type="button"
                          onClick={() => setVisibility((prev) => ({ ...prev, [key]: !prev[key] }))}
                          className={`relative w-11 h-6 rounded-full transition-colors duration-200 ${isEnabled ? "bg-[#1B365D]" : "bg-slate-200"}`}
                        >
                          <span className={`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transition-transform duration-200 ${isEnabled ? "translate-x-5" : "translate-x-0"}`} />
                        </button>
                      </div>
                    );
                  })}
                </div>
              </div>
            )}

            {/* ‚îÄ‚îÄ Options ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */}
            {activeTab === "avanced" && (
              <div className="space-y-4">
                {/* FIX : est_publie n'existe pas ‚Üí toggle via statut */}
                <div className="flex items-center justify-between px-4 py-4 rounded-xl border border-slate-200 bg-white">
                  <div>
                    <p className="text-sm font-semibold text-slate-800">Publier sur le site</p>
                    <p className="text-xs text-slate-400">Passe le statut √† &quot;publi√©&quot;</p>
                  </div>
                  <button
                    type="button"
                    onClick={() => set("statut", form.statut === "publie" ? "brouillon" : "publie")}
                    className={`relative w-11 h-6 rounded-full transition-colors ${form.statut === "publie" ? "bg-[#1B365D]" : "bg-slate-200"}`}
                  >
                    <span className={`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transition-transform ${form.statut === "publie" ? "translate-x-5" : ""}`} />
                  </button>
                </div>

                {/* FIX : est_en_avant ‚Üí est_mise_en_avant */}
                <div className="flex items-center justify-between px-4 py-4 rounded-xl border border-[#C9A84C]/30 bg-[#C9A84C]/5">
                  <div>
                    <p className="text-sm font-semibold text-slate-800">Mettre en avant</p>
                    <p className="text-xs text-slate-400">Afficher en priorit√© sur la page d&apos;accueil</p>
                  </div>
                  <button
                    type="button"
                    onClick={() => set("est_mise_en_avant", !form.est_mise_en_avant)}
                    className={`relative w-11 h-6 rounded-full transition-colors ${form.est_mise_en_avant ? "bg-[#C9A84C]" : "bg-slate-200"}`}
                  >
                    <span className={`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transition-transform ${form.est_mise_en_avant ? "translate-x-5" : ""}`} />
                  </button>
                </div>
              </div>
            )}
          </div>

          {error && (
            <div className="mx-8 mb-4 px-4 py-3 bg-red-50 border border-red-200 rounded-xl text-sm text-red-600">{error}</div>
          )}

          <div className="sticky bottom-0 flex justify-end gap-3 px-8 py-5 border-t border-slate-100 bg-white">
            <button type="button" onClick={onClose} className="px-5 py-2.5 rounded-xl border border-slate-200 text-slate-600 text-sm font-semibold hover:bg-slate-50 transition-colors">
              Annuler
            </button>
            <button type="submit" disabled={saving} className="px-6 py-2.5 rounded-xl bg-[#0F1F3D] text-white text-sm font-semibold hover:bg-[#1B365D] transition-colors shadow-md disabled:opacity-60 flex items-center gap-2">
              {saving ? (
                <>
                  <svg className="animate-spin w-4 h-4" viewBox="0 0 24 24" fill="none">
                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" />
                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z" />
                  </svg>
                  Enregistrement...
                </>
              ) : (
                <>{scholarship ? "Mettre √† jour" : "Cr√©er la bourse"}</>
              )}
            </button>
          </div>
        </form>
      </div>
    </div>
  );
}

// ---------------------------------------------------------------------------
//  Composant principal ‚Äî Tableau
// ---------------------------------------------------------------------------

interface Props {
  initialData: {
    results: ScholarshipAdmin[];
    count: number;
    next: string | null;
    previous: string | null;
  };
}

export default function AdminScholarshipsClient({ initialData }: Props) {
  const [scholarships, setScholarships] = useState(initialData.results);
  const [total, setTotal] = useState(initialData.count);
  const [search, setSearch] = useState("");
  const [filterCountry, setFilterCountry] = useState("");
  const [filterStatus, setFilterStatus] = useState("");
  const [page, setPage] = useState(1);
  const [modalOpen, setModalOpen] = useState(false);
  const [editingScholarship, setEditingScholarship] = useState<ScholarshipAdmin | null>(null);
  const [deleteId, setDeleteId] = useState<string | null>(null);
  const [isPending, startTransition] = useTransition();

  const PAGE_SIZE = 20;
  const totalPages = Math.ceil(total / PAGE_SIZE);

  const fetchData = useCallback(async (p = 1, s = search, c = filterCountry, st = filterStatus) => {
    startTransition(async () => {
      try {
        const params: Record<string, string | number> = { page: p, page_size: PAGE_SIZE };
        if (s) params.search = s;
        if (c) params.pays_destination = c;
        if (st) params.statut = st;
        const data = await scholarshipAdminRepository.getList(params);
        setScholarships(data.results);
        setTotal(data.count);
        setPage(p);
      } catch (e) {
        console.error(e);
      }
    });
  }, [search, filterCountry, filterStatus]);

  const handleSave = async (payload: CreateScholarshipPayload) => {
    if (editingScholarship) {
      await scholarshipAdminRepository.update(editingScholarship.id, payload);
    } else {
      await scholarshipAdminRepository.create(payload);
    }
    fetchData(1);
  };

  const handleDelete = async (id: string) => {
    await scholarshipAdminRepository.delete(id);
    setDeleteId(null);
    fetchData(page);
  };

  const handleDuplicate = async (s: ScholarshipAdmin) => {
    await scholarshipAdminRepository.create({
      titre_fr: `${s.titre_fr} (copie)`,
      titre_en: `${s.titre_en} (copy)`,
      organisme_fr: s.organisme_fr,
      organisme_en: s.organisme_en,
      description_fr: s.description_fr,
      description_en: s.description_en,
      pays_destination: s.pays_destination,
      niveau: s.niveau,
      type_couverture: s.type_couverture,
      statut: "brouillon",
      est_mise_en_avant: false,
    });
    fetchData(page);
  };

  // FIX : toggle via statut (pas est_publie)
  const handleQuickToggle = async (s: ScholarshipAdmin) => {
    await scholarshipAdminRepository.patch(s.id, {
      statut: s.statut === "publie" ? "brouillon" : "publie",
    });
    fetchData(page);
  };

  const handleSearch = (e: React.FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    fetchData(1);
  };

  return (
    <div className="space-y-5 max-w-[1400px]">
      {/* Header */}
      <div className="flex items-center justify-between flex-wrap gap-4">
        <div>
          <h1 className="text-2xl font-serif font-bold text-[#0F1F3D]">Gestion des bourses</h1>
          <p className="text-slate-500 text-sm mt-0.5">{total} bourse{total !== 1 ? "s" : ""} au total</p>
        </div>
        <button
          onClick={() => { setEditingScholarship(null); setModalOpen(true); }}
          className="flex items-center gap-2 px-4 py-2.5 bg-[#0F1F3D] text-white text-sm font-semibold rounded-xl hover:bg-[#1B365D] transition-colors shadow-md shadow-[#0F1F3D]/20"
        >
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2} className="w-4 h-4">
            <path strokeLinecap="round" strokeLinejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
          </svg>
          Ajouter une bourse
        </button>
      </div>

      {/* Filtres */}
      <div className="bg-white rounded-2xl p-4 border border-slate-100 shadow-sm">
        <form onSubmit={handleSearch} className="flex flex-wrap gap-3 items-center">
          <div className="relative flex-1 min-w-[200px]">
            <svg className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2}>
              <path strokeLinecap="round" strokeLinejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
            </svg>
            <input type="text" value={search} onChange={(e) => setSearch(e.target.value)} placeholder="Rechercher une bourse..." className="w-full pl-9 pr-4 py-2.5 rounded-xl border border-slate-200 text-sm focus:outline-none focus:ring-2 focus:ring-[#1B365D]/20 focus:border-[#1B365D] transition-all" />
          </div>
          <select value={filterCountry} onChange={(e) => { setFilterCountry(e.target.value); fetchData(1, search, e.target.value, filterStatus); }} className="px-3 py-2.5 rounded-xl border border-slate-200 text-sm text-slate-700 bg-white focus:outline-none appearance-none cursor-pointer">
            <option value="">Tous les pays</option>
            <option value="chine">üá®üá≥ Chine</option>
            <option value="allemagne">üá©üá™ Allemagne</option>
          </select>
          <select value={filterStatus} onChange={(e) => { setFilterStatus(e.target.value); fetchData(1, search, filterCountry, e.target.value); }} className="px-3 py-2.5 rounded-xl border border-slate-200 text-sm text-slate-700 bg-white focus:outline-none appearance-none cursor-pointer">
            <option value="">Tous les statuts</option>
            <option value="publie">Publi√©</option>
            <option value="brouillon">Brouillon</option>
            <option value="expire">Expir√©</option>
            <option value="archive">Archiv√©</option>
          </select>
          <button type="submit" disabled={isPending} className="px-4 py-2.5 bg-[#0F1F3D] text-white rounded-xl text-sm font-semibold hover:bg-[#1B365D] transition-colors disabled:opacity-60">
            {isPending ? "‚Ä¶" : "Rechercher"}
          </button>
          {(search || filterCountry || filterStatus) && (
            <button type="button" onClick={() => { setSearch(""); setFilterCountry(""); setFilterStatus(""); fetchData(1, "", "", ""); }} className="px-3 py-2.5 text-slate-400 hover:text-slate-600 text-sm transition-colors">
              R√©initialiser
            </button>
          )}
        </form>
      </div>

      {/* Tableau */}
      <div className="bg-white rounded-2xl border border-slate-100 shadow-sm overflow-hidden">
        <div className="overflow-x-auto">
          <table className="w-full text-left">
            <thead>
              <tr className="bg-slate-50 border-b border-slate-100">
                <th className="px-6 py-4 text-[10px] font-bold uppercase tracking-widest text-slate-400">Bourse</th>
                <th className="px-4 py-4 text-[10px] font-bold uppercase tracking-widest text-slate-400">Pays</th>
                <th className="px-4 py-4 text-[10px] font-bold uppercase tracking-widest text-slate-400">Niveau</th>
                <th className="px-4 py-4 text-[10px] font-bold uppercase tracking-widest text-slate-400">Deadline</th>
                <th className="px-4 py-4 text-[10px] font-bold uppercase tracking-widest text-slate-400">Statut</th>
                <th className="px-4 py-4 text-[10px] font-bold uppercase tracking-widest text-slate-400">Publi√©</th>
                <th className="px-6 py-4 text-[10px] font-bold uppercase tracking-widest text-slate-400 text-right">Actions</th>
              </tr>
            </thead>
            <tbody className="divide-y divide-slate-50">
              {isPending ? (
                [...Array(5)].map((_, i) => (
                  <tr key={i} className="animate-pulse">
                    <td className="px-6 py-4"><div className="h-4 bg-slate-100 rounded w-48" /></td>
                    <td className="px-4 py-4"><div className="h-4 bg-slate-100 rounded w-8" /></td>
                    <td className="px-4 py-4"><div className="h-4 bg-slate-100 rounded w-16" /></td>
                    <td className="px-4 py-4"><div className="h-4 bg-slate-100 rounded w-20" /></td>
                    <td className="px-4 py-4"><div className="h-6 bg-slate-100 rounded-full w-16" /></td>
                    <td className="px-4 py-4"><div className="h-6 bg-slate-100 rounded-full w-10" /></td>
                    <td className="px-6 py-4"><div className="h-4 bg-slate-100 rounded w-16 ml-auto" /></td>
                  </tr>
                ))
              ) : scholarships.length === 0 ? (
                <tr>
                  <td colSpan={7} className="px-6 py-16 text-center text-slate-400 text-sm">
                    Aucune bourse trouv√©e.{" "}
                    <button onClick={() => { setModalOpen(true); setEditingScholarship(null); }} className="text-[#1B365D] font-semibold hover:underline">Cr√©er la premi√®re</button>
                  </td>
                </tr>
              ) : (
                scholarships.map((s) => (
                  <tr key={s.id} className="hover:bg-slate-50/60 transition-colors group">
                    <td className="px-6 py-4">
                      <div className="flex items-center gap-3">
                        <div className="w-9 h-9 rounded-xl bg-[#0F1F3D]/5 flex items-center justify-center text-base flex-shrink-0">
                          <Flag country={s.pays_destination} />
                        </div>
                        <div>
                          <p className="text-sm font-semibold text-slate-800 max-w-[280px] truncate">{s.titre_fr}</p>
                          <p className="text-[11px] text-slate-400 truncate max-w-[280px]">{s.organisme_fr}</p>
                        </div>
                      </div>
                    </td>
                    <td className="px-4 py-4 text-lg"><Flag country={s.pays_destination} /></td>
                    <td className="px-4 py-4 text-xs text-slate-600 font-medium">{s.niveau}</td>
                    <td className="px-4 py-4 text-xs text-slate-600">
                      {s.date_limite
                        ? new Date(s.date_limite).toLocaleDateString("fr-FR", { day: "numeric", month: "short", year: "2-digit" })
                        : <span className="text-slate-300">‚Äî</span>}
                    </td>
                    <td className="px-4 py-4"><StatusBadge status={s.statut} /></td>
                    {/* FIX : toggle via statut === "publie" */}
                    <td className="px-4 py-4">
                      <button
                        onClick={() => handleQuickToggle(s)}
                        className={`relative w-9 h-5 rounded-full transition-colors ${s.statut === "publie" ? "bg-[#1B365D]" : "bg-slate-200"}`}
                      >
                        <span className={`absolute top-0.5 left-0.5 w-4 h-4 bg-white rounded-full shadow transition-transform ${s.statut === "publie" ? "translate-x-4" : ""}`} />
                      </button>
                    </td>
                    <td className="px-6 py-4">
                      <div className="flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                        <button onClick={() => { setEditingScholarship(s); setModalOpen(true); }} className="p-1.5 rounded-lg text-slate-400 hover:text-[#1B365D] hover:bg-[#1B365D]/5 transition-colors" title="Modifier">
                          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-4 h-4">
                            <path strokeLinecap="round" strokeLinejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931z" />
                          </svg>
                        </button>
                        <button onClick={() => handleDuplicate(s)} className="p-1.5 rounded-lg text-slate-400 hover:text-[#C9A84C] hover:bg-[#C9A84C]/5 transition-colors" title="Dupliquer">
                          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-4 h-4">
                            <path strokeLinecap="round" strokeLinejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75" />
                          </svg>
                        </button>
                        <button onClick={() => setDeleteId(s.id)} className="p-1.5 rounded-lg text-slate-400 hover:text-red-500 hover:bg-red-50 transition-colors" title="Supprimer">
                          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-4 h-4">
                            <path strokeLinecap="round" strokeLinejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />
                          </svg>
                        </button>
                      </div>
                    </td>
                  </tr>
                ))
              )}
            </tbody>
          </table>
        </div>

        {totalPages > 1 && (
          <div className="px-6 py-4 border-t border-slate-100 bg-slate-50/50 flex items-center justify-between">
            <span className="text-xs text-slate-500">
              Page <span className="font-bold text-slate-700">{page}</span> sur <span className="font-bold text-slate-700">{totalPages}</span> ‚Äî {total} r√©sultats
            </span>
            <div className="flex items-center gap-1.5">
              <button onClick={() => fetchData(page - 1)} disabled={page === 1} className="px-3 py-1.5 rounded-lg border border-slate-200 text-xs font-medium text-slate-600 hover:bg-white disabled:opacity-40 transition-colors">‚Üê Pr√©c√©dent</button>
              <button onClick={() => fetchData(page + 1)} disabled={page === totalPages} className="px-3 py-1.5 rounded-lg border border-slate-200 text-xs font-medium text-slate-600 hover:bg-white disabled:opacity-40 transition-colors">Suivant ‚Üí</button>
            </div>
          </div>
        )}
      </div>

      {/* Modal */}
      {modalOpen && (
        <ScholarshipModal scholarship={editingScholarship} onClose={() => setModalOpen(false)} onSave={handleSave} />
      )}

      {/* Confirmation suppression */}
      {deleteId && (
        <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-4">
          <div className="bg-white rounded-2xl p-8 max-w-sm w-full shadow-2xl text-center">
            <div className="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center mx-auto mb-4">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={1.5} className="w-6 h-6 text-red-600">
                <path strokeLinecap="round" strokeLinejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126z" />
              </svg>
            </div>
            <h3 className="text-lg font-bold text-slate-800 mb-2">Supprimer la bourse ?</h3>
            <p className="text-sm text-slate-500 mb-6">Cette action est irr√©versible.</p>
            <div className="flex gap-3 justify-center">
              <button onClick={() => setDeleteId(null)} className="px-5 py-2.5 rounded-xl border border-slate-200 text-slate-600 text-sm font-semibold hover:bg-slate-50 transition-colors">Annuler</button>
              <button onClick={() => handleDelete(deleteId)} className="px-5 py-2.5 rounded-xl bg-red-600 text-white text-sm font-semibold hover:bg-red-700 transition-colors shadow-md">Supprimer</button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}
// END OF FILE: src/components/admin/AdminScholarshipsClient.tsx

// FILE: src/components/Footer.tsx
-----------------------------------------------
"use client";

import Link from "next/link";
import { useLanguage } from "@/hooks/useLanguage";

export default function Footer() {
  const { dictionary } = useLanguage();

  return (
    <footer className="bg-salma-primary-dark text-white pt-20 pb-10">
      <div className="container mx-auto px-6">
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12 mb-16">
          
          {/* Colonne 1 : Branding */}
          <div className="space-y-6">
            <Link href="/" className="flex flex-col">
              <span className="text-3xl font-serif font-bold text-white leading-none">SALMA</span>
              <span className="text-[10px] uppercase tracking-[0.3em] text-salma-gold font-sans font-bold">Expertise AG Technologies</span>
            </Link>
            <p className="text-sm text-gray-400 leading-relaxed max-w-xs">
              {dictionary.footer.tagline}
            </p>
            <div className="p-4 border-l-2 border-salma-gold bg-white/5">
              <p className="text-xs italic text-salma-gold-light font-medium">
                &quot;{dictionary.footer.slogan}&quot;
              </p>
            </div>
          </div>

          {/* Colonne 2 : Liens Rapides */}
          <div>
            <h4 className="text-salma-gold font-bold uppercase tracking-widest text-xs mb-8">
              {dictionary.footer.links.title}
            </h4>
            <ul className="space-y-4">
              <li><Link href="/" className="text-sm text-gray-300 hover:text-white transition-colors">{dictionary.footer.links.home}</Link></li>
              <li><Link href="/bourses" className="text-sm text-gray-300 hover:text-white transition-colors">{dictionary.footer.links.bourses}</Link></li>
              <li><Link href="/a-propos" className="text-sm text-gray-300 hover:text-white transition-colors">{dictionary.footer.links.about}</Link></li>
              <li><Link href="/contact" className="text-sm text-gray-300 hover:text-white transition-colors">{dictionary.footer.links.contact}</Link></li>
              <li><Link href="/confidentialite" className="text-sm text-gray-300 hover:text-white transition-colors">{dictionary.cookies.link}
  </Link></li>
            </ul>
          </div>

          {/* Colonne 3 : Coordonn√©es */}
          <div>
            <h4 className="text-salma-gold font-bold uppercase tracking-widest text-xs mb-8">
              {dictionary.footer.contact.title}
            </h4>
            <ul className="space-y-6 text-sm text-gray-300">
              <li className="flex gap-4">
                <span className="text-salma-gold">üìç</span>
                <span>{dictionary.footer.contact.address}</span>
              </li>
              <li className="flex gap-4">
                <span className="text-salma-gold">üìû</span>
                <span>{dictionary.footer.contact.phones}</span>
              </li>
              <li className="flex gap-4">
                <span className="text-salma-gold">‚úâÔ∏è</span>
                <span className="break-all">{dictionary.footer.contact.email}</span>
              </li>
            </ul>
          </div>

          {/* Colonne 4 : Newsletter / Badge AGT */}
          <div>
            <h4 className="text-salma-gold font-bold uppercase tracking-widest text-xs mb-8">
              AG Technologies
            </h4>
            <div className="bg-white/5 p-6 rounded-2xl border border-white/10">
              <p className="text-xs text-gray-400 mb-4 italic">
                {dictionary.hero.badge}
              </p>
              <div className="flex gap-3">
                 {/* Ici on pourrait mettre des ic√¥nes de r√©seaux sociaux */}
                 <div className="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center hover:bg-salma-gold hover:text-salma-primary transition-all cursor-pointer">f</div>
                 <div className="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center hover:bg-salma-gold hover:text-salma-primary transition-all cursor-pointer">in</div>
              </div>
            </div>
          </div>

        </div>

        {/* Barre de copyright */}
        <div className="pt-10 border-t border-white/10 flex flex-col md:flex-row justify-between items-center gap-6">
          <p className="text-[10px] text-gray-500 uppercase tracking-widest">
            {dictionary.footer.rights}
          </p>
          <div className="flex gap-8 text-[10px] text-gray-500 uppercase tracking-widest">
            <Link href="/mentions-legales" className="hover:text-salma-gold transition-colors">Mentions L√©gales</Link>
            <Link href="/confidentialite" className="hover:text-salma-gold transition-colors">Confidentialit√©</Link>
          </div>
        </div>
      </div>
    </footer>
  );
}
// END OF FILE: src/components/Footer.tsx

// FILE: src/components/LanguageSwitcher.tsx
-----------------------------------------------
"use client";

import { useLanguage } from "@/hooks/useLanguage";

export default function LanguageSwitcher() {
  const { locale, setLocale } = useLanguage();

  return (
    <button
      onClick={() => setLocale(locale === "fr" ? "en" : "fr")}
      className="flex items-center gap-2 px-3 py-2 rounded-lg bg-salma-surface border border-salma-border hover:border-salma-gold transition-all group"
    >
      <span className="text-xs font-bold font-sans tracking-widest text-salma-text">
        {locale === "fr" ? "EN" : "FR"}
      </span>
      <svg className="w-4 h-4 text-salma-gold group-hover:rotate-180 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
      </svg>
    </button>
  );
}
// END OF FILE: src/components/LanguageSwitcher.tsx

// FILE: src/components/layout/ConditionalLayout.tsx
-----------------------------------------------
"use client";
// src/components/layout/ConditionalLayout.tsx
// Affiche Navbar + Footer + widgets UNIQUEMENT sur les pages visiteur.
// Les routes /admin/* ont leur propre layout et n'en ont pas besoin.

import { usePathname } from "next/navigation";
import Navbar from "@/components/Navbar";
import Footer from "@/components/Footer";
import WhatsAppButton from "@/components/ui/WhatsAppButton";
import ChatbotWidget from "@/components/ui/ChatbotWidget";
import CookieBanner from "@/components/ui/CookieBanner";

export default function ConditionalLayout({ children }: { children: React.ReactNode }) {
  const pathname = usePathname();
  const isAdmin = pathname?.startsWith("/admin");

  if (isAdmin) {
    // Pages admin : rendu nu, sans Navbar/Footer
    return <>{children}</>;
  }

  // Pages visiteur : layout complet
  return (
    <>
      <Navbar />
      <main>{children}</main>
      <Footer />
      <WhatsAppButton />
      <ChatbotWidget />
      <CookieBanner />
    </>
  );
}
// END OF FILE: src/components/layout/ConditionalLayout.tsx

// FILE: src/components/layout/nav/MobileMenu.tsx
-----------------------------------------------
"use client";

import Link from "next/link";
import { useState } from "react";
import type { NavContent, NavServiceItem } from "@/types";

/**
 * Menu Mobile Informatif - Responsive Extr√™me
 * Utilise les m√™mes cl√©s de contenu que le Desktop
 */
export default function MobileMenu({ content, onClose }: { content: NavContent; onClose: () => void })
 {
  const [activeAccordion, setActiveAccordion] = useState<string | null>(null);

  const toggleAccordion = (key: string) => {
    setActiveAccordion(activeAccordion === key ? null : key);
  };

  const bourses = content.nav_bourses;
  const services = content.nav_services;
  const contact = content.nav_contact;

  return (
    <div className="fixed inset-0 z-[110] lg:hidden animate-fade-in">
      {/* Backdrop flou pour focus sur le menu */}
      <div className="absolute inset-0 bg-salma-primary/20 backdrop-blur-sm" onClick={onClose} />

      {/* Panneau lat√©ral droit */}
      <div className="absolute top-0 right-0 w-[85%] max-w-[400px] h-full bg-white shadow-2xl flex flex-col animate-slide-in-right">
        
        {/* HEADER MOBILE */}
        <div className="p-6 border-b border-salma-border flex justify-between items-center bg-salma-bg/30">
          <div className="flex flex-col">
            <span className="text-xl font-serif font-bold text-salma-primary leading-none">SALMA</span>
            <span className="text-[8px] uppercase tracking-widest text-salma-gold font-bold">Bourses & Mobilit√©</span>
          </div>
          <button onClick={onClose} className="p-2 text-salma-primary hover:bg-salma-primary/10 rounded-full transition-colors">
            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6" />
            </svg>
          </button>
        </div>

        {/* CORPS DU MENU (Scrollable) */}
        <div className="flex-1 overflow-y-auto p-4 space-y-2">
          
          {/* ACCORDION : BOURSES */}
          <div className="border border-salma-border rounded-2xl overflow-hidden">
            <button 
              onClick={() => toggleAccordion('bourses')}
              className="w-full p-5 flex justify-between items-center bg-white hover:bg-salma-bg transition-colors"
            >
              <span className="text-sm font-bold text-salma-primary uppercase tracking-widest">{bourses.title}</span>
              <span className={`text-salma-gold transition-transform duration-300 ${activeAccordion === 'bourses' ? 'rotate-180' : ''}`}>‚ñº</span>
            </button>
            
            {activeAccordion === 'bourses' && (
              <div className="px-5 pb-5 space-y-4 animate-fade-in">
                <Link href="/bourses?pays=chine" onClick={onClose} className="block p-4 bg-salma-bg rounded-xl">
                  <p className="font-bold text-salma-primary text-xs">üá®üá≥ {bourses.china_label}</p>
                  <p className="text-[10px] text-salma-text-muted mt-1">{bourses.china_desc}</p>
                </Link>
                <Link href="/bourses?pays=allemagne" onClick={onClose} className="block p-4 bg-salma-bg rounded-xl">
                  <p className="font-bold text-salma-primary text-xs">üá©üá™ {bourses.germany_label}</p>
                  <p className="text-[10px] text-salma-text-muted mt-1">{bourses.germany_desc}</p>
                </Link>
              </div>
            )}
          </div>

          {/* ACCORDION : SERVICES */}
          <div className="border border-salma-border rounded-2xl overflow-hidden">
            <button 
              onClick={() => toggleAccordion('services')}
              className="w-full p-5 flex justify-between items-center bg-white hover:bg-salma-bg transition-colors"
            >
              <span className="text-sm font-bold text-salma-primary uppercase tracking-widest">{services.title}</span>
              <span className={`text-salma-gold transition-transform duration-300 ${activeAccordion === 'services' ? 'rotate-180' : ''}`}>‚ñº</span>
            </button>

            {activeAccordion === 'services' && (
              <div className="px-5 pb-5 grid grid-cols-1 gap-2 animate-fade-in">
                {services.items.map((item: NavServiceItem) => (
                  <Link key={item.id} href={item.href} onClick={onClose} className="flex items-center gap-4 p-3 bg-salma-bg rounded-xl">
                    <span className="text-xl">{item.icon}</span>
                    <div>
                      <p className="text-xs font-bold text-salma-primary">{item.label}</p>
                      <p className="text-[9px] text-salma-text-muted">{item.desc}</p>
                    </div>
                  </Link>
                ))}
              </div>
            )}
          </div>

          {/* SECTION FIXE : CONTACT & ACTIONS RAPIDES */}
          <div className="mt-4 p-2 space-y-2">
            <p className="px-4 text-[10px] font-black text-salma-gold uppercase tracking-[0.2em] mb-4">Actions Prioritaires</p>
            
            <Link href="/contact" onClick={onClose} className="flex items-center gap-4 p-4 bg-salma-primary text-white rounded-2xl shadow-lg">
              <span className="text-xl">üìÖ</span>
              <div>
                <p className="text-xs font-bold">{contact.rdv_label}</p>
                <p className="text-[9px] opacity-70">{contact.rdv_desc}</p>
              </div>
            </Link>

            <a href="https://wa.me/237699450984" target="_blank" className="flex items-center gap-4 p-4 bg-green-500 text-white rounded-2xl shadow-lg">
              <span className="text-xl">üí¨</span>
              <div>
                <p className="text-xs font-bold">{contact.whatsapp_label}</p>
                <p className="text-[9px] opacity-70">{contact.whatsapp_desc}</p>
              </div>
            </a>
          </div>
        </div>

        {/* FOOTER : NEWSLETTER MOBILE INTEGR√âE */}
        <div className="p-6 bg-salma-bg border-t border-salma-border">
          <p className="text-xs font-bold text-salma-primary mb-1">{contact.newsletter_title}</p>
          <p className="text-[10px] text-salma-text-muted mb-4 leading-tight">{contact.newsletter_desc}</p>
          <div className="flex gap-2">
            <input 
              type="email" 
              placeholder={contact.newsletter_placeholder} 
              className="flex-1 bg-white border border-salma-border rounded-xl px-4 py-3 text-xs outline-none focus:border-salma-gold" 
            />
            <button className="bg-salma-gold text-salma-primary px-5 py-3 rounded-xl text-xs font-bold shadow-md">
              {contact.newsletter_btn}
            </button>
          </div>
          
          <div className="mt-8 pt-6 border-t border-salma-border flex justify-center gap-6 opacity-40">
             <span className="text-[10px] font-bold">Facebook</span>
             <span className="text-[10px] font-bold">LinkedIn</span>
             <span className="text-[10px] font-bold">Instagram</span>
          </div>
        </div>
      </div>
    </div>
  );
}
// END OF FILE: src/components/layout/nav/MobileMenu.tsx

// FILE: src/components/layout/nav/NavDropdown.tsx
-----------------------------------------------
"use client";

import { useState } from "react";
import Link from "next/link";
import type { NavBourses, NavServices, NavContact,NavAbout } from "@/types";

type NavDropdownData = NavBourses | NavServices | NavContact | NavAbout;
/**
 * Menu d√©roulant informatif style Ecobank
 */
export default function NavDropdown({
  title,
  data,
  type,
  isAction = false,
}: {
  title: string;
  data: NavDropdownData;
  type: string;
  isAction?: boolean;
}) {
  const [isOpen, setIsOpen] = useState(false);

  return (
    <div
      className="relative h-20 flex items-center"
      onMouseEnter={() => setIsOpen(true)}
      onMouseLeave={() => setIsOpen(false)}
    >
      <button className={`
        px-4 py-2 text-xs font-bold uppercase tracking-widest transition-all flex items-center gap-2
        ${isAction ? "bg-salma-primary text-white rounded-lg ml-4 shadow-md" : "text-salma-primary hover:text-salma-gold"}
      `}>
        {title}
        {!isAction && <span className={`text-[10px] transition-transform ${isOpen ? "rotate-180" : ""}`}>‚ñº</span>}
      </button>

      {/* LE PANNEAU INFORMATIF */}
      {isOpen && !isAction && (
        <div className="absolute top-[80px] left-1/2 -translate-x-1/2 w-[400px] bg-white border border-salma-border rounded-2xl shadow-salma-lg p-6 animate-fade-in">
          {/* Petit triangle */}
          <div className="absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-l border-t border-salma-border rotate-45" />

          {/* CAS BOURSES */}
          {type === "bourses" && (() => {
            const d = data as NavBourses;
            return (
              <div className="grid grid-cols-1 gap-6">
                <Link href="/bourses?pays=chine" className="group block p-4 hover:bg-salma-bg rounded-xl transition-all">
                  <p className="font-bold text-salma-primary flex items-center gap-2">üá®üá≥ {d.china_label}</p>
                  <p className="text-xs text-salma-text-muted mt-1">{d.china_desc}</p>
                  <span className="text-[10px] font-bold text-salma-gold uppercase mt-2 block opacity-0 group-hover:opacity-100 transition-all">‚Üí {d.china_cta}</span>
                </Link>
                <div className="h-px bg-salma-border" />
                <Link href="/bourses?pays=allemagne" className="group block p-4 hover:bg-salma-bg rounded-xl transition-all">
                  <p className="font-bold text-salma-primary flex items-center gap-2">üá©üá™ {d.germany_label}</p>
                  <p className="text-xs text-salma-text-muted mt-1">{d.germany_desc}</p>
                  <span className="text-[10px] font-bold text-salma-gold uppercase mt-2 block opacity-0 group-hover:opacity-100 transition-all">‚Üí {d.germany_cta}</span>
                </Link>
              </div>
            );
          })()}

          {/* CAS SERVICES */}
          {type === "services" && (() => {
            const d = data as NavServices;
            return (
              <div className="grid grid-cols-2 gap-4">
                {d.items.map((item) => (
                  <Link key={item.id} href={item.href} className="p-3 hover:bg-salma-bg rounded-xl transition-all border border-transparent hover:border-salma-border">
                    <span className="text-xl mb-2 block">{item.icon}</span>
                    <p className="text-xs font-bold text-salma-primary">{item.label}</p>
                    <p className="text-[10px] text-salma-text-muted leading-tight mt-1">{item.desc}</p>
                  </Link>
                ))}
              </div>
            );
          })()}
        </div>
      )}

      {/* CAS NOUS CONTACTER (Action Menu) */}
      {isOpen && isAction && (() => {
        const d = data as NavContact;
        return (
          <div className="absolute top-[80px] right-0 w-[320px] bg-white border border-salma-border rounded-2xl shadow-salma-lg overflow-hidden animate-fade-in">
            <div className="p-2 space-y-1">
              <Link href="/contact" className="flex items-center gap-4 p-4 hover:bg-salma-primary hover:text-white rounded-xl transition-all group">
                <span className="text-xl">üìÖ</span>
                <div>
                  <p className="text-xs font-bold">{d.rdv_label}</p>
                  <p className="text-[10px] opacity-70">{d.rdv_desc}</p>
                </div>
              </Link>
              <a href="https://wa.me/237699450984" target="_blank" rel="noopener noreferrer" className="flex items-center gap-4 p-4 hover:bg-green-500 hover:text-white rounded-xl transition-all group">
                <span className="text-xl">üí¨</span>
                <div>
                  <p className="text-xs font-bold">{d.whatsapp_label}</p>
                  <p className="text-[10px] opacity-70">{d.whatsapp_desc}</p>
                </div>
              </a>
            </div>

            {/* MINI NEWSLETTER */}
            <div className="bg-salma-bg p-6 border-t border-salma-border">
              <p className="text-xs font-bold text-salma-primary mb-1">{d.newsletter_title}</p>
              <p className="text-[10px] text-salma-text-muted mb-4">{d.newsletter_desc}</p>
              <div className="flex gap-2">
                <input
                  type="email"
                  placeholder={d.newsletter_placeholder}
                  className="flex-1 bg-white border border-salma-border rounded-lg px-3 py-2 text-[10px] outline-none focus:border-salma-gold"
                />
                <button className="bg-salma-gold text-salma-primary px-3 py-2 rounded-lg text-[10px] font-bold">
                  {d.newsletter_btn}
                </button>
              </div>
            </div>
          </div>
        );
      })()}
    </div>
  );
}
// END OF FILE: src/components/layout/nav/NavDropdown.tsx

// FILE: src/components/Navbar.tsx
-----------------------------------------------
"use client";

import { useEffect, useState } from "react";
import Link from "next/link";
import { useLanguage } from "@/hooks/useLanguage";
import { cmsSwitcher } from "@/dictionaries/data/cms-switcher";
import NavDropdown from "@/components/layout/nav/NavDropdown";
import MobileMenu from "@/components/layout/nav/MobileMenu";
import LanguageSwitcher from "@/components/LanguageSwitcher";
import type { NavContent } from "@/types";


export default function Navbar() {
  const { locale } = useLanguage();
  const [content, setContent] = useState<NavContent | null>(null);
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);

  // Chargement du contenu via le switcher
  useEffect(() => {
  cmsSwitcher.getScopeContent("layout", locale).then(
    (data) => setContent(data as NavContent)
  );
}, [locale]);

  if (!content) return null; // Ou un squelette de chargement

  return (
    <nav className="sticky top-0 z-[100] w-full bg-white/95 backdrop-blur-md border-b border-salma-border shadow-sm">
      <div className="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
        
        {/* LOGO - Sans mention admin */}
        <Link href="/" className="flex flex-col group">
          <span className="text-2xl font-serif font-bold text-salma-primary leading-none">SALMA</span>
          <span className="text-[10px] uppercase tracking-[0.3em] text-salma-gold font-sans font-bold">Bourses & Mobilit√©</span>
        </Link>

        {/* MENU DESKTOP */}
        <div className="hidden lg:flex items-center gap-2">
          <NavDropdown title={content.nav_bourses.title} type="bourses" data={content.nav_bourses} />
          <NavDropdown title={content.nav_services.title} type="services" data={content.nav_services} />
          <NavDropdown title={content.nav_about.title} type="about" data={content.nav_about} />
          <NavDropdown title={content.nav_contact.title} type="contact" data={content.nav_contact} isAction />
          
          <div className="h-6 w-px bg-salma-border mx-4" />
          <LanguageSwitcher />
        </div>

        {/* BOUTON MOBILE */}
        <button 
          className="lg:hidden p-2 text-salma-primary" 
          onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
        >
          <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d={isMobileMenuOpen ? "M6 18L18 6" : "M4 6h16M4 12h16M4 18h16"} />
          </svg>
        </button>
      </div>

      {/* MENU MOBILE (Accordions) */}
      {isMobileMenuOpen && (
        <MobileMenu content={content} onClose={() => setIsMobileMenuOpen(false)} />
      )}
    </nav>
  );
}
// END OF FILE: src/components/Navbar.tsx

// FILE: src/components/ThemeSwitcher.tsx
-----------------------------------------------
"use client";

import { useTheme } from "next-themes";
import { useEffect, useState } from "react";

export default function ThemeSwitcher() {
  const {setTheme, resolvedTheme } = useTheme();
  const [mounted, setMounted] = useState(false);

  useEffect(() => setMounted(true), []);

  if (!mounted) return <div className="w-9 h-9" />; 

  const isDark = resolvedTheme === "dark";

  return (
    <button
      onClick={() => setTheme(isDark ? "light" : "dark")}
      className="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-salma-primary-light transition-all border border-transparent hover:border-salma-border"
      aria-label="Toggle Theme"
    >
      {isDark ? (
        // Ic√¥ne Soleil pour le mode Sombre
        <svg className="w-5 h-5 text-salma-gold" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
        </svg>
      ) : (
        // Ic√¥ne Lune pour le mode Clair
        <svg className="w-5 h-5 text-salma-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
        </svg>
      )}
    </button>
  );
}
// END OF FILE: src/components/ThemeSwitcher.tsx

// FILE: src/components/ui/ChatbotWidget.tsx
-----------------------------------------------
"use client";

import { useState, useEffect, useRef } from "react";
import { useLanguage } from "@/hooks/useLanguage";
import { chatbotRepository } from "@/repositories/chatbot.repository";
import { eventsRepository } from "@/repositories/events.repository";

interface Message {
  role: "user" | "bot";
  text: string;
}

export default function ChatbotWidget() {
  // FIX : Retrait de dictionary
  const { locale } = useLanguage(); 
  const [isOpen, setIsOpen] = useState(false);
  const [messages, setMessages] = useState<Message[]>([]);
  const [input, setInput] = useState("");
  const [isLoading, setIsLoading] = useState(false);
  const scrollRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    if (isOpen && messages.length === 0) {
      const welcome = locale === "fr" 
        ? "Bonjour ! Je suis l'assistant SALMA. Comment puis-je vous aider pour votre projet d'√©tudes ?"
        : "Hello! I am the SALMA assistant. How can I help you with your study project?";
      setMessages([{ role: "bot", text: welcome }]);
      eventsRepository.trackChatbotOpen();
    }
  }, [isOpen, locale, messages.length]);

  useEffect(() => {
    if (scrollRef.current) scrollRef.current.scrollTop = scrollRef.current.scrollHeight;
  }, [messages]);

  const handleSend = async () => {
    if (!input.trim() || isLoading) return;

    const userMsg = input;
    setInput("");
    setMessages((prev) => [...prev, { role: "user", text: userMsg }]);
    setIsLoading(true);

    try {
      const response = await chatbotRepository.query({ message: userMsg, langue: locale });
      setMessages((prev) => [...prev, { role: "bot", text: response.reponse }]);
    } catch {
      // FIX : Retrait de 'error'
      setMessages((prev) => [...prev, { role: "bot", text: "D√©sol√©, une erreur est survenue." }]);
    } finally {
      setIsLoading(false);
    }
  };
  return (
    <div className="fixed bottom-28 right-8 z-50 flex flex-col items-end">
      {/* Fen√™tre de Chat */}
      {isOpen && (
        <div className="mb-4 w-80 sm:w-96 h-[450px] bg-white dark:bg-salma-surface border border-salma-border rounded-3xl shadow-salma-lg flex flex-col overflow-hidden animate-fade-in">
          {/* Header */}
          <div className="bg-salma-primary p-4 text-white flex justify-between items-center">
            <div className="flex items-center gap-3">
              <div className="w-8 h-8 rounded-full bg-salma-gold flex items-center justify-center text-salma-primary font-bold">S</div>
              <span className="font-serif font-bold">Assistant SALMA</span>
            </div>
            <button onClick={() => setIsOpen(false)} className="text-white/70 hover:text-white">‚úï</button>
          </div>

          {/* Messages */}
          <div ref={scrollRef} className="flex-1 overflow-y-auto p-4 space-y-4 bg-salma-bg/30">
            {messages.map((m, i) => (
              <div key={i} className={`flex ${m.role === "user" ? "justify-end" : "justify-start"}`}>
                <div className={`max-w-[80%] p-3 rounded-2xl text-sm ${
                  m.role === "user" 
                    ? "bg-salma-primary text-white rounded-tr-none" 
                    : "bg-white dark:bg-salma-bg border border-salma-border text-salma-text rounded-tl-none shadow-sm"
                }`}>
                  {m.text}
                </div>
              </div>
            ))}
            {isLoading && <div className="text-xs text-salma-text-muted animate-pulse italic">SALMA r√©fl√©chit...</div>}
          </div>

          {/* Input */}
          <div className="p-4 border-t border-salma-border bg-white dark:bg-salma-surface">
            <div className="flex gap-2">
              <input
                type="text"
                value={input}
                onChange={(e) => setInput(e.target.value)}
                onKeyDown={(e) => e.key === "Enter" && handleSend()}
                placeholder="Posez votre question..."
                className="flex-1 bg-salma-bg border border-salma-border rounded-xl px-4 py-2 text-sm outline-none focus:border-salma-gold"
              />
              <button onClick={handleSend} className="bg-salma-gold text-salma-primary p-2 rounded-xl hover:scale-105 transition-transform">
                ‚û§
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Bouton d'ouverture */}
      <button
        onClick={() => setIsOpen(!isOpen)}
        className="bg-salma-primary text-white p-4 rounded-full shadow-salma-lg hover:scale-110 transition-all active:scale-95 border-2 border-salma-gold"
      >
        <svg className="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
        </svg>
      </button>
    </div>
  );
}
// END OF FILE: src/components/ui/ChatbotWidget.tsx

// FILE: src/components/ui/CookieBanner.tsx
-----------------------------------------------
"use client";
import { useState, useEffect } from "react";
import Link from "next/link";
import SalmaButton from "./SalmaButton";
import { useLanguage } from "@/hooks/useLanguage";

export default function CookieBanner() {
  const { dictionary } = useLanguage();
  const [isVisible, setIsVisible] = useState(false);

  useEffect(() => {
    const consent = localStorage.getItem("salma-cookie-consent");
    if (!consent) setIsVisible(true);
  }, []);

  const accept = () => {
    localStorage.setItem("salma-cookie-consent", "accepted");
    setIsVisible(false);
  };

  if (!isVisible) return null;

  return (
    <div className="fixed bottom-6 left-6 right-6 md:left-auto md:right-8 md:w-[400px] bg-white dark:bg-salma-surface border border-salma-border shadow-salma-lg rounded-3xl p-6 z-[60] animate-fade-in">
      <p className="text-sm text-salma-text-muted mb-4 leading-relaxed">
        {dictionary.cookies.text}{" "}
        <Link href="/confidentialite" className="text-salma-primary font-bold underline">
          {dictionary.cookies.link}
        </Link>.
      </p>
      <div className="flex gap-3">
        <SalmaButton onClick={accept} variant="primary" size="sm" className="flex-1">
          {dictionary.cookies.accept}
        </SalmaButton>
        <button onClick={() => setIsVisible(false)} className="text-xs text-salma-text-muted hover:underline">
          {dictionary.cookies.decline}
        </button>
      </div>
    </div>
  );
}
// END OF FILE: src/components/ui/CookieBanner.tsx

// FILE: src/components/ui/NewsletterForm.tsx
-----------------------------------------------
// src/components/ui/NewsletterForm.tsx
"use client";

import { useState } from "react";
import { useLanguage } from "@/hooks/useLanguage";
import { newsletterDictionary } from "@/dictionaries/data";
import { eventsRepository } from "@/repositories/events.repository";

export default function NewsletterForm() {
  const {locale } = useLanguage();
  const [email, setEmail] = useState("");
  const [status, setStatus] = useState<"idle" | "loading" | "success" | "error">("idle");

  const handleSubscribe = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!email) return;

    setStatus("loading");
    try {
      await newsletterDictionary.subscribe({ email, source: "footer" });
      eventsRepository.trackNewsletterSignup();
      setStatus("success");
      setEmail("");
    } catch {
      setStatus("error");
    }
  };

  return (
    <div className="w-full">
      {status === "success" ? (
        <p className="text-emerald-400 text-sm font-bold animate-fade-in">
          ‚úì {locale === "fr" ? "Inscription r√©ussie !" : "Subscribed successfully!"}
        </p>
      ) : (
        <form onSubmit={handleSubscribe} className="flex flex-col gap-3">
          <input
            type="email"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            placeholder="votre@email.com"
            required
            className="px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white text-sm outline-none focus:border-salma-gold transition-all"
          />
          <button
            type="submit"
            disabled={status === "loading"}
            className="bg-salma-gold text-salma-primary font-bold py-3 rounded-xl text-xs uppercase tracking-widest hover:bg-salma-gold-light transition-all disabled:opacity-50"
          >
            {status === "loading" ? "..." : (locale === "fr" ? "S'abonner" : "Subscribe")}
          </button>
          {status === "error" && (
            <p className="text-red-400 text-[10px]">Erreur. R√©essayez.</p>
          )}
        </form>
      )}
    </div>
  );
}
// END OF FILE: src/components/ui/NewsletterForm.tsx

// FILE: src/components/ui/SalmaBadge.tsx
-----------------------------------------------
import React from "react";

interface SalmaBadgeProps {
  status: "open" | "urgent" | "closed";
  label: string;
}

export default function SalmaBadge({ status, label }: SalmaBadgeProps) {
  const styles = {
    open: "bg-green-100 text-green-700 border-green-200",
    urgent: "bg-amber-100 text-amber-700 border-amber-200 animate-pulse",
    closed: "bg-red-100 text-red-700 border-red-200"
  };

  return (
    <span className={`px-2.5 py-0.5 rounded-full text-[10px] font-bold uppercase tracking-wider border ${styles[status]}`}>
      {label}
    </span>
  );
}
// END OF FILE: src/components/ui/SalmaBadge.tsx

// FILE: src/components/ui/SalmaButton.tsx
-----------------------------------------------
"use client";

import React from "react";

interface SalmaButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: "primary" | "accent" | "gold" | "outline";
  size?: "sm" | "md" | "lg";
  children: React.ReactNode;
}

export default function SalmaButton({
  variant = "primary",
  size = "md",
  children,
  className = "",
  ...props
}: SalmaButtonProps) {
  
  const baseStyles = "inline-flex items-center justify-center font-sans font-bold transition-all duration-300 rounded-lg active:scale-95";
  
  const variants = {
    primary: "bg-salma-primary text-white hover:bg-salma-accent shadow-salma-sm",
    accent: "bg-salma-accent text-white hover:bg-salma-primary shadow-salma-sm",
    gold: "bg-salma-gold text-salma-primary hover:bg-salma-gold-light shadow-salma-sm",
    outline: "border-2 border-salma-gold text-salma-gold hover:bg-salma-gold hover:text-white"
  };

  const sizes = {
    sm: "px-4 py-2 text-xs",
    md: "px-6 py-3 text-sm tracking-widest uppercase",
    lg: "px-8 py-4 text-base tracking-widest uppercase"
  };

  return (
    <button 
      className={`${baseStyles} ${variants[variant]} ${sizes[size]} ${className}`}
      {...props}
    >
      {children}
    </button>
  );
}
// END OF FILE: src/components/ui/SalmaButton.tsx

// FILE: src/components/ui/ScholarshipCard.tsx
-----------------------------------------------
"use client";

import Image from "next/image";
import Link from "next/link";
import { useLanguage } from "@/hooks/useLanguage";
import { getMediaUrl } from "@/lib/api-client";
import type { ScholarshipPublicListItem } from "@/types"; // Import depuis le nouveau barrel
import SalmaBadge from "./SalmaBadge";
import SalmaButton from "./SalmaButton";

interface ScholarshipCardProps {
  scholarship: ScholarshipPublicListItem;
}

export default function ScholarshipCard({ scholarship }: ScholarshipCardProps) {
  const { locale, dictionary } = useLanguage();

  // Mapping des textes selon la langue
  const title = locale === "fr" ? scholarship.titre_fr : scholarship.titre_en;
  const org = locale === "fr" ? scholarship.organisme_fr : scholarship.organisme_en;
  const langReq = locale === "fr" ? scholarship.exigence_langue_fr : scholarship.exigence_langue_en;
  
  // URL de l'image via le helper
  const imageUrl = getMediaUrl(scholarship.image_principale?.url_fichier);

  // Mapping des drapeaux
  const countryFlags: Record<string, string> = {
    chine: "üá®üá≥",
    allemagne: "üá©üá™",
    france: "üá´üá∑",
    canada: "üá®üá¶",
    autre: "üåç",
  };

  return (
    <div className="group bg-white dark:bg-salma-surface rounded-2xl border border-salma-border overflow-hidden shadow-salma-sm hover:shadow-salma-md transition-all duration-500 flex flex-col h-full">
      {/* --- HEADER : Image & Badges --- */}
      <div className="relative h-52 w-full overflow-hidden">
        <Image
          src={imageUrl || "/image.jpg"}
          alt={title}
          fill
          className="object-cover group-hover:scale-110 transition-transform duration-700"
        />
        <div className="absolute inset-0 bg-gradient-to-t from-salma-primary/60 to-transparent opacity-60" />

        {/* Badge Pays */}
        <div className="absolute top-4 right-4 bg-white/90 backdrop-blur-sm px-3 py-1 rounded-full text-[10px] font-black text-salma-primary flex items-center gap-2 shadow-sm uppercase">
          <span>{countryFlags[scholarship.pays_destination] || "üåç"}</span>
          {scholarship.pays_destination}
        </div>

        {/* Badge Statut */}
        <div className="absolute bottom-4 left-4">
          <SalmaBadge 
            status={scholarship.statut === 'publie' ? 'open' : scholarship.statut === 'expire' ? 'closed' : 'urgent'} 
            label={scholarship.statut} 
          />
        </div>
      </div>

      {/* --- BODY : Contenu --- */}
      <div className="p-6 flex flex-col flex-1">
        <div className="flex items-center gap-2 mb-2">
          <span className="text-salma-gold text-[10px] font-bold uppercase tracking-widest">
            {scholarship.niveau}
          </span>
          <span className="text-salma-text-muted text-[10px]">‚Ä¢</span>
          <span className="text-salma-gold text-[10px] font-bold uppercase tracking-widest">
            {scholarship.type_couverture}
          </span>
        </div>

        <h3 className="text-xl font-serif font-bold text-salma-primary dark:text-white leading-tight mb-3 line-clamp-2">
          {title}
        </h3>

        <p className="text-sm text-salma-text-muted line-clamp-2 mb-6 font-sans">
          {org}
        </p>

        {/* --- DETAILS --- */}
        <div className="mt-auto pt-4 border-t border-salma-border grid grid-cols-2 gap-4">
          <div>
            <span className="block text-[9px] text-salma-text-muted uppercase font-bold tracking-tighter">
              {dictionary.scholarships.language}
            </span>
            <span className="text-xs font-bold text-salma-primary dark:text-salma-gold">
              {langReq}
            </span>
          </div>
          <div>
            <span className="block text-[9px] text-salma-text-muted uppercase font-bold tracking-tighter">
              {dictionary.scholarships.deadline}
            </span>
            <span className="text-xs font-bold text-red-500">
              {scholarship.date_limite ? new Date(scholarship.date_limite).toLocaleDateString(locale) : "N/A"}
            </span>
          </div>
        </div>

        <Link href={`/bourses/${scholarship.id}`} className="w-full mt-6">
          <SalmaButton variant="outline" size="sm" className="w-full">
            {dictionary.scholarships.viewDetails}
          </SalmaButton>
        </Link>
      </div>
    </div>
  );
}
// END OF FILE: src/components/ui/ScholarshipCard.tsx

// FILE: src/components/ui/SectionTitle.tsx
-----------------------------------------------
import React from "react";

interface SectionTitleProps {
  title: string;
  subtitle?: string;
  align?: "left" | "center";
}

export default function SectionTitle({ 
  title, 
  subtitle, 
  align = "left" 
}: SectionTitleProps) {
  return (
    <div className={`mb-12 flex flex-col ${align === "center" ? "items-center text-center" : "items-start"}`}>
      {subtitle && (
        <span className="text-salma-gold font-sans font-bold text-xs tracking-[0.3em] uppercase mb-2">
          {subtitle}
        </span>
      )}
      <h2 className="text-3xl md:text-4xl font-serif text-salma-primary dark:text-white leading-tight">
        {title}
      </h2>
      <div className="gold-divider mt-4" />
    </div>
  );
}
// END OF FILE: src/components/ui/SectionTitle.tsx

// FILE: src/components/ui/WhatsAppButton.tsx
-----------------------------------------------
"use client";
import { useLanguage } from "@/hooks/useLanguage";

export default function WhatsAppButton() {
  const { dictionary } = useLanguage();
  const phoneNumber = "237699450984"; // Num√©ro AGT
  const message = encodeURIComponent(dictionary.contact.info.whatsappMsg);

  return (
    <a 
      href={`https://wa.me/${phoneNumber}?text=${message}`}
      target="_blank"
      rel="noopener noreferrer"
      className="fixed bottom-8 right-8 z-50 bg-[#25D366] text-white p-4 rounded-full shadow-2xl hover:scale-110 transition-transform active:scale-95 group"
    >
      <div className="absolute -top-12 right-0 bg-white text-black text-[10px] font-bold px-3 py-1 rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap">
       Besoin d&apos;aide ?
      </div>
      <svg className="w-7 h-7" fill="currentColor" viewBox="0 0 24 24">
        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L0 24l6.335-1.662c1.72.94 3.659 1.437 5.634 1.437h.005c6.558 0 11.895-5.335 11.898-11.893a11.821 11.821 0 00-3.48-8.413z" />
      </svg>
    </a>
  );
}
// END OF FILE: src/components/ui/WhatsAppButton.tsx

// FILE: src/config/i18n.ts
-----------------------------------------------
// src/config/i18n.ts
// ============================================================
//  SOURCE DE V√âRIT√â POUR L'INTERNATIONALISATION
//  Pour ajouter une nouvelle langue :
//    1. Ajouter son code dans le tableau `locales` ci-dessous
//    2. Cr√©er le fichier src/dictionaries/{code}.ts
//    3. L'importer dans src/dictionaries/index.ts
//  C'est tout ‚Äî aucun autre fichier √† modifier.
// ============================================================

export const locales = ["en", "fr"] as const;

export type Locale = (typeof locales)[number];

/** Langue affich√©e par d√©faut si la d√©tection syst√®me √©choue */
export const defaultLocale: Locale = "en";

/** Noms affichables dans le s√©lecteur de langue */
export const localeLabels: Record<Locale, string> = {
  en: "English",
  fr: "Fran√ßais",
};

/**
 * D√©tecte la langue pr√©f√©r√©e du navigateur.
 * Retourne une Locale support√©e, ou defaultLocale en fallback.
 * Doit √™tre appel√©e c√¥t√© client uniquement.
 */
export function detectLocale(): Locale {
  if (typeof window === "undefined") return defaultLocale;

  // Cherche dans localStorage (pr√©f√©rence sauvegard√©e)
  try {
    const saved = localStorage.getItem("salma-locale") as Locale | null;
    if (saved && locales.includes(saved)) return saved;
  } catch {
    // localStorage indisponible
  }

  // D√©tecte la langue du navigateur
  const browserLang = navigator.language?.split("-")[0] as Locale;
  if (locales.includes(browserLang)) return browserLang;

  return defaultLocale;
}
// END OF FILE: src/config/i18n.ts

// FILE: src/contexts/LanguageContext.tsx
-----------------------------------------------
// src/contexts/LanguageContext.tsx
"use client";

import { createContext, useState, useEffect, ReactNode } from "react";
import { type Locale, detectLocale } from "@/config/i18n";
import { getDictionary, type DictionaryType } from "@/dictionaries";

interface LanguageContextType {
  locale: Locale;
  dictionary: DictionaryType;
  setLocale: (locale: Locale) => void;
}

export const LanguageContext = createContext<LanguageContextType | undefined>(
  undefined
);

export function LanguageProvider({ children }: { children: ReactNode }) {
  // On initialise avec des valeurs par d√©faut pour le SSR (Serveur)
  const [locale, setLocaleState] = useState<Locale>("fr"); 
  const [dictionary, setDictionary] = useState<DictionaryType>(getDictionary("fr"));
  const [mounted, setMounted] = useState(false);

  useEffect(() => {
    const detected = detectLocale();
    setLocaleState(detected);
    setDictionary(getDictionary(detected));
    setMounted(true); 
  }, []);

  const setLocale = (newLocale: Locale) => {
    setLocaleState(newLocale);
    setDictionary(getDictionary(newLocale));
    try {
      localStorage.setItem("salma-locale", newLocale);
    } catch {}
  };

  // IMPORTANT : Le Provider doit TOUJOURS √™tre pr√©sent dans l'arbre
  // On utilise la visibilit√© CSS pour √©viter le flash de texte anglais/fran√ßais
  return (
    <LanguageContext.Provider value={{ locale, dictionary, setLocale }}>
      <div style={{ visibility: mounted ? "visible" : "hidden" }}>
        {children}
      </div>
    </LanguageContext.Provider>
  );
}
// END OF FILE: src/contexts/LanguageContext.tsx

// FILE: src/contexts/ThemeContext.tsx
-----------------------------------------------
// src/contexts/ThemeContext.tsx
"use client";

import { ThemeProvider as NextThemesProvider } from "next-themes";
import type { ThemeProviderProps } from "next-themes";

// ============================================================
//  THEME PROVIDER
//  Wrapper autour de next-themes.
//  Branch√© dans src/app/layout.tsx autour de tout l'arbre.
//
//  Usage dans un composant :
//  import { useTheme } from "@/hooks/useTheme";
//  const { theme, toggleTheme } = useTheme();
// ============================================================
export function ThemeProvider({ children, ...props }: ThemeProviderProps) {
  return (
    <NextThemesProvider
      attribute="class"       // Ajoute/retire la classe .dark sur <html>
      defaultTheme="system"   // Suit le th√®me syst√®me par d√©faut
      enableSystem            // Active la d√©tection syst√®me
      disableTransitionOnChange={false}
      {...props}
    >
      {children}
    </NextThemesProvider>
  );
}
// END OF FILE: src/contexts/ThemeContext.tsx

// FILE: src/dictionaries/data/cms.data-dictionary.ts
-----------------------------------------------
// src/dictionaries/data/cms.data-dictionary.ts
import { cmsPublicRepository, cmsAdminRepository } from "@/repositories/cms.repository";
import type { 
  SitePagePublic, 
  SitePageAdmin, 
  UpdateContentBlockPayload, 
  PitchVideo 
} from "@/types/api/cms.types";

export const cmsDictionary = {
  /** 
   * R√©cup√®re le contenu public d'une page par son slug 
   * Utilis√© par la vitrine (ex: /a-propos)
   */
  getPage: (slug: string): Promise<SitePagePublic> =>
    cmsPublicRepository.getPageBySlug(slug), // Correction du nom ici

  /** 
   * Config globale sous forme de map cl√©/valeur 
   */
  getConfigMap: async (): Promise<Record<string, string>> => {
    const configs = await cmsPublicRepository.getConfig();
    return configs.reduce((acc, c) => {
      acc[c.cle_config] = c.valeur_fr;
      return acc;
    }, {} as Record<string, string>);
  },

  /** 
   * Vid√©o de pitch active 
   */
  getActivePitchVideo: async (): Promise<PitchVideo | null> => {
    const videos = await cmsPublicRepository.getVideos();
    return videos.find((v) => v.est_active) ?? null;
  },

  // --- Espace Admin ---
  admin: {
    getPages: () => cmsAdminRepository.getPages(),
    getPage: (id: string): Promise<SitePageAdmin> => 
      cmsAdminRepository.getPageById(id),
    updateBloc: (pageId: string, blocId: string, payload: UpdateContentBlockPayload) => 
      cmsAdminRepository.patchBlock(pageId, blocId, payload),
  },
};
// END OF FILE: src/dictionaries/data/cms.data-dictionary.ts

// FILE: src/dictionaries/data/cms-switcher.ts
-----------------------------------------------
// src/dictionaries/data/cms-switcher.ts
// ==============================================================================
//  Switcher intelligent de contenu avec Fallback de s√©curit√©
//  G√®re le basculement entre Fichiers Statiques et API Django
// ==============================================================================

import { cmsPublicRepository } from "@/repositories/cms.repository";
import { Locale } from "@/config/i18n";

// Imports des fichiers statiques (FR)
import { frLayout } from "./static/layout/fr";
import { frHome } from "./static/home/fr";
import { frBourses } from "./static/bourses/fr";
import { frServices } from "./static/services/fr";
import { frAbout } from "./static/about/fr";
import { frContact } from "./static/contact/fr";

// Imports des fichiers statiques (EN)
import { enLayout } from "./static/layout/en";
import { enHome } from "./static/home/en";
import { enBourses } from "./static/bourses/en";
import { enServices } from "./static/services/en";
import { enAbout } from "./static/about/en";
import { enContact } from "./static/contact/en";

// Types des scopes autoris√©s
export type CmsScope = "layout" | "home" | "bourses" | "services" | "contact" | "about";

// On d√©finit un type g√©n√©rique pour le contenu pour √©viter le "any"
// eslint-disable-next-line @typescript-eslint/no-explicit-any
type DictionaryContent = Record<string, any>;

// Registre central des contenus statiques
const staticRegistry: Record<Locale, Record<CmsScope, DictionaryContent>> = {
  fr: {
    layout: frLayout,
    home: frHome,
    bourses: frBourses,
    services: frServices,
    about: frAbout,
    contact: frContact,
  },
  en: {
    layout: enLayout,
    home: enHome,
    bourses: enBourses,
    services: enServices,
    about: enAbout,
    contact: enContact,
  }
};

export const cmsSwitcher = {
  /**
   * R√©cup√®re le contenu d'un scope sp√©cifique.
   * R√àGLE : Si NEXT_PUBLIC_STATIC_CONTENT=true ou si l'API √©choue -> Retourne le statique.
   */
  getScopeContent: async (scope: CmsScope, locale: Locale): Promise<DictionaryContent> => {
    const isStaticMode = process.env.NEXT_PUBLIC_STATIC_CONTENT === 'true';
    const fallbackData = staticRegistry[locale][scope];

    // 1. Si on est en mode statique forc√©
    if (isStaticMode) {
      return fallbackData;
    }

    // 2. Tentative de r√©cup√©ration via l'API (Prod)
    try {
      const pageData = await cmsPublicRepository.getPageBySlug(scope);
      
      if (!pageData || !pageData.blocs) {
        return fallbackData;
      }

      // TODO: Impl√©menter le mapping API -> Dictionnaire ici quand les cl√©s seront synchronis√©es
      return fallbackData; 

    } catch (_error) {
      // 3. FALLBACK : On utilise le pr√©fixe "_" pour indiquer √† TS que la variable est ignor√©e
      console.warn(`[CMS Switcher] Serveur indisponible pour le scope "${scope}". Utilisation du fallback.`);
      return fallbackData;
    }
  }
};
// END OF FILE: src/dictionaries/data/cms-switcher.ts

// FILE: src/dictionaries/data/contact.data-dictionary.ts
-----------------------------------------------
// src/dictionaries/data/contact.data-dictionary.ts
// ==============================================================================
//  Dictionnaire de donn√©es ‚Äî Demandes de Contact
//
//  R√àGLE ARCHITECTURE :
//  Server Components ‚Üí data-dictionary ‚Üí repository ‚Üí api-client ‚Üí Django
//
//  Les composants ne connaissent QUE ce fichier.
// ==============================================================================

import {
  contactPublicRepository,
  contactAdminRepository,
} from "@/repositories/contact.repository";
import type {
  ContactRequest,
  CreateContactPayload,
  UpdateContactPayload,
  PaginatedContactResponse,
  ContactFilters,
} from "@/types/api/contact.types";

// ==============================================================================
//  VITRINE ‚Äî Soumission de contact / rendez-vous
// ==============================================================================

export const contactDictionary = {
  /**
   * Soumettre une demande de contact depuis la vitrine.
   * Utilis√© par : /contact (ContactForm)
   */
  submit: (payload: CreateContactPayload): Promise<ContactRequest> => {
    return contactPublicRepository.submit(payload);
  },

  /**
   * Soumettre une demande de rendez-vous.
   * Utilise le m√™me endpoint que le contact, avec un message pr√©fix√©.
   * Utilis√© par : formulaire de prise de RDV
   */
  submitAppointment: (payload: CreateContactPayload): Promise<ContactRequest> => {
    return contactPublicRepository.submit({
      ...payload,
      message: `[RENDEZ-VOUS] ${payload.message}`,
    });
  },

  // ==============================================================================
  //  ADMIN ‚Äî Dashboard
  // ==============================================================================

  admin: {
    /**
     * Liste des demandes de contact.
     * Utilis√© par : /admin/contacts (tableau)
     */
    getList: (filters?: ContactFilters): Promise<PaginatedContactResponse> => {
      return contactAdminRepository.getList(filters);
    },

    /**
     * D√©tail d'une demande avec bourses associ√©es.
     * Utilis√© par : /admin/contacts/[id]
     */
    getById: (id: string): Promise<ContactRequest> => {
      return contactAdminRepository.getById(id);
    },

    /**
     * Marquer comme lu.
     */
    markAsRead: (id: string): Promise<ContactRequest> => {
      return contactAdminRepository.patch(id, { est_lu: true });
    },

    /**
     * Ajouter une note admin.
     */
    addNote: (id: string, notes: string): Promise<ContactRequest> => {
      return contactAdminRepository.patch(id, { notes_admin: notes });
    },

    /**
     * Modifier partiellement (lu + notes).
     */
    patch: (id: string, payload: UpdateContactPayload): Promise<ContactRequest> => {
      return contactAdminRepository.patch(id, payload);
    },

    /**
     * Supprimer une demande.
     */
    delete: (id: string): Promise<void> => {
      return contactAdminRepository.delete(id);
    },

    /**
     * Compter les contacts non lus (pour badge notification).
     */
    getUnreadCount: async (): Promise<number> => {
      const response = await contactAdminRepository.getList({
        est_lu: false,
        page_size: 1,
      });
      return response.count;
    },
  },
};
// END OF FILE: src/dictionaries/data/contact.data-dictionary.ts

// FILE: src/dictionaries/data/index.ts
-----------------------------------------------
// src/dictionaries/data/index.ts
// ==============================================================================
//  Barrel export ‚Äî Dictionnaires de donn√©es SALMA
//
//  R√àGLE : Les Server Components et Client Components importent UNIQUEMENT d'ici.
//  Jamais directement depuis les repositories.
//
//  Usage :
//    import { scholarshipDictionary } from "@/dictionaries/data"
//    const featured = await scholarshipDictionary.getFeatured()
// ==============================================================================

export { scholarshipDictionary } from "./scholarship.data-dictionary";
export { cmsDictionary } from "./cms.data-dictionary";
export { contactDictionary } from "./contact.data-dictionary";
export { newsletterDictionary } from "./newsletter.data-dictionary";
export { kpiDictionary } from "./kpi.data-dictionary";

// Les modules sans dictionnaire d√©di√© sont accessibles via les repositories
// Usage : import { mediaRepository } from "@/repositories"
// END OF FILE: src/dictionaries/data/index.ts

// FILE: src/dictionaries/data/kpi.data-dictionary.ts
-----------------------------------------------
// src/dictionaries/data/kpi.data-dictionary.ts
// ==============================================================================
//  Dictionnaire de donn√©es ‚Äî KPI & Analytics
//  Point d'entr√©e unique pour toutes les stats du dashboard
// ==============================================================================

import { eventsRepository } from "@/repositories/events.repository";
import { kpiRepository} from "@/repositories/kpi.repository";
import type {
  KpiRealtime,
  KpiSnapshot,
  ConversionRate,
  VisitorEvent,
  VisitorEventPayload,
  EventFilters,
  KpiSnapshotFilters,
} from "@/types/api/kpi.types";
import type { PaginatedResponse } from "@/types/api/scholarship.types";

export const kpiDictionary = {
  // --- Tracking public (c√¥t√© client, silencieux) ----------------------------

  track: (payload: VisitorEventPayload): Promise<void> =>
    eventsRepository.track(payload),

  trackPageView: (page: string): Promise<void> =>
    eventsRepository.trackPageView(page),

  trackScholarshipView: (bourseId: string): Promise<void> =>
    eventsRepository.trackScholarshipView(bourseId),

  trackContact: (bourseId?: string): Promise<void> =>
    eventsRepository.trackContactSubmit(bourseId),

  trackWhatsapp: (bourseId?: string): Promise<void> =>
    eventsRepository.trackWhatsappClick(bourseId),

  trackNewsletter: (): Promise<void> =>
    eventsRepository.trackNewsletterSignup(),

  // --- Dashboard admin -------------------------------------------------------

  admin: {
    /**
     * Stats en temps r√©el ‚Äî widget principal du dashboard.
     * Appel√© avec polling c√¥t√© client (ex: toutes les 30s).
     */
    getRealtime: (): Promise<KpiRealtime> =>
      kpiRepository.adminGetRealtime(),

    /**
     * Snapshots historiques pour les graphiques.
     */
    getSnapshots: (filters?: KpiSnapshotFilters): Promise<KpiSnapshot[]> =>
      kpiRepository.adminGetSnapshots(filters),

    /**
     * Taux de conversion global + par bourse.
     */
    getConversion: (): Promise<ConversionRate> =>
      kpiRepository.adminGetConversion(),

    /**
     * √âv√©nements bruts filtrables (debug, analyse fine).
     */
    getEvents: (filters?: EventFilters): Promise<PaginatedResponse<VisitorEvent>> =>
      kpiRepository.adminGetEvents(filters),

    /**
     * Donn√©es pour le widget "Top bourses" du dashboard.
     * Retourne les 5 bourses avec le plus de vues.
     */
    getTopScholarships: async (limit = 5) => {
      const conversion = await kpiRepository.adminGetConversion();
      return conversion.par_bourse
        .sort((a, b) => b.nb_vues - a.nb_vues)
        .slice(0, limit);
    },
  },
};
// END OF FILE: src/dictionaries/data/kpi.data-dictionary.ts

// FILE: src/dictionaries/data/newsletter.data-dictionary.ts
-----------------------------------------------
// src/dictionaries/data/newsletter.data-dictionary.ts
// ==============================================================================
//  Dictionnaire de donn√©es ‚Äî Newsletter & Annonces
//
//  R√àGLE ARCHITECTURE :
//  Server Components ‚Üí data-dictionary ‚Üí repository ‚Üí api-client ‚Üí Django
//
//  Les composants ne connaissent QUE ce fichier.
// ==============================================================================

import { newsletterRepository } from "@/repositories/newsletter.repository";
import type {
  NewsletterInscriptionPayload,
  NewsletterDesinscriptionPayload,
  NewsletterSubscriber,
  Announcement,
  CreateAnnouncementPayload,
  UpdateAnnouncementPayload,
  SendAnnouncementResponse,
  PaginatedSubscriberResponse,
  PaginatedAnnouncementResponse,
  SubscriberFilters,
  AnnouncementFilters,
} from "@/types/api/newsletter.types";

// ==============================================================================
//  VITRINE ‚Äî Inscription / D√©sinscription
// ==============================================================================

export const newsletterDictionary = {
  /**
   * S'inscrire √† la newsletter depuis la vitrine.
   * Utilis√© par : footer, popup exit-intent
   */
  subscribe: (payload: NewsletterInscriptionPayload): Promise<{ detail: string }> => {
    return newsletterRepository.subscribe(payload);
  },

  /**
   * Se d√©sinscrire.
   * Utilis√© par : lien de d√©sinscription
   */
  unsubscribe: (payload: NewsletterDesinscriptionPayload): Promise<{ detail: string }> => {
    return newsletterRepository.unsubscribe(payload);
  },

  // ==============================================================================
  //  ADMIN ‚Äî Dashboard
  // ==============================================================================

  admin: {
    // --- Abonn√©s ---

    /**
     * Liste des abonn√©s.
     * Utilis√© par : /admin/newsletter/abonnes
     */
    getSubscribers: (filters?: SubscriberFilters): Promise<PaginatedSubscriberResponse> => {
      return newsletterRepository.adminGetSubscribers(filters);
    },

    /**
     * D√©tail d'un abonn√©.
     */
    getSubscriberById: (id: string): Promise<NewsletterSubscriber> => {
      return newsletterRepository.adminGetSubscriberById(id);
    },

    /**
     * Supprimer un abonn√©.
     */
    deleteSubscriber: (id: string): Promise<void> => {
      return newsletterRepository.adminDeleteSubscriber(id);
    },

    // --- Annonces ---

    /**
     * Liste des annonces.
     * Utilis√© par : /admin/newsletter/annonces
     */
    getAnnouncements: (filters?: AnnouncementFilters): Promise<PaginatedAnnouncementResponse> => {
      return newsletterRepository.adminGetAnnouncements(filters);
    },

    /**
     * D√©tail d'une annonce.
     */
    getAnnouncementById: (id: string): Promise<Announcement> => {
      return newsletterRepository.adminGetAnnouncementById(id);
    },

    /**
     * Cr√©er une annonce (brouillon).
     */
    createAnnouncement: (payload: CreateAnnouncementPayload): Promise<Announcement> => {
      return newsletterRepository.adminCreateAnnouncement(payload);
    },

    /**
     * Modifier compl√®tement une annonce.
     */
    updateAnnouncement: (id: string, payload: CreateAnnouncementPayload): Promise<Announcement> => {
      return newsletterRepository.adminUpdateAnnouncement(id, payload);
    },

    /**
     * Modifier partiellement.
     */
    patchAnnouncement: (id: string, payload: UpdateAnnouncementPayload): Promise<Announcement> => {
      return newsletterRepository.adminPatchAnnouncement(id, payload);
    },

    /**
     * Supprimer une annonce.
     */
    deleteAnnouncement: (id: string): Promise<void> => {
      return newsletterRepository.adminDeleteAnnouncement(id);
    },

    /**
     * Envoyer une annonce √† tous les abonn√©s actifs (simul√©).
     */
    sendAnnouncement: (id: string): Promise<SendAnnouncementResponse> => {
      return newsletterRepository.adminSendAnnouncement(id);
    },
  },
};
// END OF FILE: src/dictionaries/data/newsletter.data-dictionary.ts

// FILE: src/dictionaries/data/scholarship.data-dictionary.ts
-----------------------------------------------
// src/dictionaries/data/scholarship.data-dictionary.ts
import {
  scholarshipPublicRepository,
  scholarshipAdminRepository,
} from "@/repositories/scholarship.repository";
import type {
  ScholarshipPublicListItem,
  ScholarshipAdmin,
  ScholarshipListResponse,
  ScholarshipAdminListResponse,
  ScholarshipFilters,
  CreateScholarshipPayload,
  UpdateScholarshipPayload,
  FieldVisibilityMap,
} from "@/types/api/scholarship.types";
import { toFieldVisibilityMap } from "@/types/api/scholarship.types";

export const scholarshipDictionary = {
  /** Liste pagin√©e pour le catalogue */
  getCatalog: (filters?: ScholarshipFilters): Promise<ScholarshipListResponse> => {
    return scholarshipPublicRepository.getList(filters);
  },

  /** Bourses vedettes pour la Home */
  getFeatured: (): Promise<ScholarshipPublicListItem[]> => {
    return scholarshipPublicRepository.getFeatured();
  },

  /** D√©tail d'une bourse avec map de visibilit√© */
  getDetail: async (id: string) => {
    const scholarship = await scholarshipPublicRepository.getById(id);
    const visibilityMap = toFieldVisibilityMap(scholarship.visibilites);
    return { scholarship, visibilityMap };
  },

  // --- Espace Admin ---
  admin: {
    getList: (filters?: ScholarshipFilters): Promise<ScholarshipAdminListResponse> => {
      return scholarshipAdminRepository.getList(filters);
    },
    getById: (id: string): Promise<ScholarshipAdmin> => {
      return scholarshipAdminRepository.getById(id);
    },
    create: (payload: CreateScholarshipPayload): Promise<ScholarshipAdmin> => {
      return scholarshipAdminRepository.create(payload);
    },
    patch: (id: string, payload: UpdateScholarshipPayload): Promise<ScholarshipAdmin> => {
      return scholarshipAdminRepository.patch(id, payload);
    },
    delete: (id: string): Promise<void> => {
      return scholarshipAdminRepository.delete(id);
    },
    saveVisibility: (bourseId: string, visibilityMap: FieldVisibilityMap): Promise<void> => {
      const payload = Object.entries(visibilityMap).map(([nom_du_champ, est_visible]) => ({
        nom_du_champ,
        est_visible,
      }));
      return scholarshipAdminRepository.bulkUpdateVisibility(bourseId, payload);
    },
  },
};
// END OF FILE: src/dictionaries/data/scholarship.data-dictionary.ts

// FILE: src/dictionaries/data/static/about/en.ts
-----------------------------------------------
export const enAbout = {
  aboutPage: {
    title: "About SALMA",
    subtitle: "AG Technologies' Expertise",
    missionTitle: "Our Mission",
    missionDesc: "To facilitate access to international education for all Cameroonian talents.",
    visionTitle: "Why trust us?",
    visionDesc: "Located in Yaound√©, we operate with total transparency.",
  }
};
// END OF FILE: src/dictionaries/data/static/about/en.ts

// FILE: src/dictionaries/data/static/about/fr.ts
-----------------------------------------------
export const frAbout = {
  aboutPage: {
    title: "√Ä propos de SALMA",
    subtitle: "L'expertise d'AG Technologies",
    missionTitle: "Notre Mission",
    missionDesc: "Faciliter l'acc√®s √† l'√©ducation internationale pour tous les talents camerounais.",
    visionTitle: "Pourquoi nous faire confiance ?",
    visionDesc: "Install√©s √† Yaound√©, nous op√©rons avec une transparence totale.",
  }
};
// END OF FILE: src/dictionaries/data/static/about/fr.ts

// FILE: src/dictionaries/data/static/bourses/en.ts
-----------------------------------------------
export const enBourses = {
  catalog: {
    title: "All Scholarships",
    subtitle: "China & Germany",
    description: "Find the scholarship that matches your study project.",
    searchPlaceholder: "Search for a scholarship...",
    noResults: "No scholarships match your search.",
    found: "scholarships found"
  },
  scholarships: {
    deadline: "Deadline",
    language: "Language required",
    viewDetails: "View Details",
  }
};
// END OF FILE: src/dictionaries/data/static/bourses/en.ts

// FILE: src/dictionaries/data/static/bourses/fr.ts
-----------------------------------------------
export const frBourses = {
  catalog: {
    title: "Toutes nos bourses",
    subtitle: "Chine & Allemagne",
    description: "Trouvez la bourse qui correspond √† votre projet d'√©tudes.",
    searchPlaceholder: "Rechercher une bourse...",
    noResults: "Aucune bourse ne correspond √† votre recherche.",
    found: "bourses trouv√©es"
  },
  scholarships: {
    deadline: "Date limite",
    language: "Langue requise",
    viewDetails: "Consulter l'offre",
  }
};
// END OF FILE: src/dictionaries/data/static/bourses/fr.ts

// FILE: src/dictionaries/data/static/contact/en.ts
-----------------------------------------------
export const enContact = {
  contact: {
    title: "Let's talk about your project",
    subtitle: "Contact us",
    form: {
      name: "Full Name",
      email: "Email Address",
      phone: "Phone (WhatsApp)",
      message: "Your message",
      send: "Send my request",
      success: "Request sent successfully!"
    }
  },
  faq: {
    title: "Frequently Asked Questions",
    subtitle: "Everything about our services",
    items: [
      { q: "What are the visa processing times?", a: "Average of 03 weeks for China." },
      { q: "Is the refund guarantee real?", a: "Yes, it is a contractual commitment from AG Technologies." }
    ]
  }
};
// END OF FILE: src/dictionaries/data/static/contact/en.ts

// FILE: src/dictionaries/data/static/contact/fr.ts
-----------------------------------------------
export const frContact = {
  contact: {
    title: "Parlons de votre projet",
    subtitle: "Contactez-nous",
    form: {
      name: "Nom complet",
      email: "Adresse Email",
      phone: "T√©l√©phone (WhatsApp)",
      message: "Votre message",
      send: "Envoyer ma demande",
      success: "Demande envoy√©e avec succ√®s !"
    }
  },
  faq: {
    title: "Questions fr√©quentes",
    subtitle: "Tout savoir sur nos services",
    items: [
      { q: "Quels sont les d√©lais pour le visa ?", a: "En moyenne 03 semaines pour la Chine." },
      { q: "La garantie remboursement est-elle r√©elle ?", a: "Oui, c'est un engagement contractuel d'AG Technologies." }
    ]
  }
};
// END OF FILE: src/dictionaries/data/static/contact/fr.ts

// FILE: src/dictionaries/data/static/home/en.ts
-----------------------------------------------
export const enHome = {
  hero: {
    badge: "AG Technologies Expertise",
    title: "Achieve Your Dream of Studying in China & Germany",
    description: "Full support, visa processing in 3 weeks, and a satisfaction guarantee. Join top-tier global universities today.",
    ctaPrimary: "Find my scholarship",
    ctaSecondary: "Our visa services",
    trustIndicator: {
      count: "+500 students",
      text: "already supported this year"
    },
    imageAlt: "Study in China with SALMA",
    visaBadge: {
      number: "03",
      label: "Weeks for your Visa"
    }
  },
  trust: {
    expertise: {
      title: "AGT Expertise",
      desc: "End-to-end support by travel professionals."
    },
    speed: {
      title: "Visa in 3 Weeks",
      desc: "Optimized procedures for a fast departure."
    },
    guarantee: {
      title: "Satisfaction Guaranteed",
      desc: "Your success is our top priority."
    }
  },
  stats: {
    visas: { value: "500+", label: "Visas Obtained" },
    partners: { value: "25+", label: "Partner Universities" },
    experience: { value: "05+", label: "Years of Experience" },
    satisfaction: { value: "100%", label: "Success Rate" }
  },
  featuredScholarships: {
    title: "Featured Scholarships",
    subtitle: "Outstanding Opportunities",
    viewAll: "View all scholarships",
  },
  successStories: {
    title: "They succeeded with SALMA",
    subtitle: "Success Stories"
  }
};
// END OF FILE: src/dictionaries/data/static/home/en.ts

// FILE: src/dictionaries/data/static/home/fr.ts
-----------------------------------------------
export const frHome = {
  hero: {
    badge: "Expertise AG Technologies",
    title: "R√©alisez votre r√™ve d'√©tudes en Chine & Allemagne",
    description: "Accompagnement complet, obtention de visa en 3 semaines et garantie satisfait ou rembours√©. Rejoignez les meilleures universit√©s mondiales.",
    ctaPrimary: "Trouver ma bourse",
    ctaSecondary: "Nos services de visa",
    trustIndicator: {
      count: "+500 √©tudiants",
      text: "d√©j√† accompagn√©s cette ann√©e"
    },
    imageAlt: "√âtudier en Chine avec SALMA",
    visaBadge: {
      number: "03",
      label: "Semaines pour votre Visa"
    }
  },
  trust: {
    expertise: {
      title: "Expertise AGT",
      desc: "Un accompagnement de A √† Z par des professionnels."
    },
    speed: {
      title: "Visa en 3 semaines",
      desc: "Des proc√©dures optimis√©es pour un d√©part rapide."
    },
    guarantee: {
      title: "Satisfait ou Rembours√©",
      desc: "Votre r√©ussite est notre priorit√© absolue."
    }
  },
  stats: {
    visas: { value: "500+", label: "Visas Obtenus" },
    partners: { value: "25+", label: "Universit√©s Partenaires" },
    experience: { value: "05+", label: "Ann√©es d'Exp√©rience" },
    satisfaction: { value: "100%", label: "Taux de R√©ussite" }
  },
  featuredScholarships: {
    title: "Bourses √† la une",
    subtitle: "Opportunit√©s Exceptionnelles",
    viewAll: "Voir toutes les bourses",
  },
  successStories: {
    title: "Ils ont r√©ussi avec SALMA",
    subtitle: "Histoires de Succ√®s"
    // Les stories individuelles seront fetch√©es depuis l'API ou un repo d√©di√©
  }
};
// END OF FILE: src/dictionaries/data/static/home/fr.ts

// FILE: src/dictionaries/data/static/layout/en.ts
-----------------------------------------------
export const enLayout = {
  nav: {
    home: "Home",
    services: "Services",
    bourses: "Scholarships",
    about: "About",
    contact: "Contact",
    admin: "Admin",
  },
  footer: {
    tagline: "Your trusted partner for international mobility to China and Germany.",
    slogan: "Satisfied or Refunded ‚Äî Excellence serving your future.",
    links: {
      title: "Navigation",
      home: "Home",
      bourses: "Scholarships",
      services: "Services",
      about: "About",
      contact: "Contact"
    },
    contact: {
      title: "Contact Us",
      address: "Mont√©e Anne rouge, Kadji Building, Yaound√©",
      phones: "+237 6 99 45 09 84 / 6 51 74 03 28",
      email: "secretariatagtechnologies@gmail.com"
    },
    rights: "¬© 2026 SALMA by AG Technologies. All rights reserved."
  },
  cookies: {
    text: "We use cookies to improve your experience. Check our",
    link: "privacy policy",
    accept: "Accept",
    decline: "Decline"
  }
};
// END OF FILE: src/dictionaries/data/static/layout/en.ts

// FILE: src/dictionaries/data/static/layout/fr.ts
-----------------------------------------------
export const frLayout = {
  nav: {
    home: "Accueil",
    services: "Services",
    bourses: "Bourses",
    about: "√Ä propos",
    contact: "Contact",
    admin: "Admin",
  },
  footer: {
    tagline: "Votre partenaire de confiance pour la mobilit√© internationale vers la Chine et l'Allemagne.",
    slogan: "Satisfait ou Rembours√© ‚Äî L'excellence au service de votre avenir.",
    links: {
      title: "Navigation",
      home: "Accueil",
      bourses: "Bourses",
      services: "Services",
      about: "√Ä propos",
      contact: "Contact"
    },
    contact: {
      title: "Contactez-nous",
      address: "Mont√©e Anne rouge, Immeuble Kadji, Yaound√©",
      phones: "+237 6 99 45 09 84 / 6 51 74 03 28",
      email: "secretariatagtechnologies@gmail.com"
    },
    rights: "¬© 2026 SALMA by AG Technologies. Tous droits r√©serv√©s."
  },
  cookies: {
    text: "Nous utilisons des cookies pour am√©liorer votre exp√©rience. Consultez notre",
    link: "politique de confidentialit√©",
    accept: "Accepter",
    decline: "Refuser"
  }
};
// END OF FILE: src/dictionaries/data/static/layout/fr.ts

// FILE: src/dictionaries/data/static/services/en.ts
-----------------------------------------------
export const enServices = {
  servicesPage: {
    title: "Our Mobility Services",
    subtitle: "Comprehensive expertise for your journey",
    description: "Whether you are traveling to study, work, or visit, AG Technologies guarantees a simplified process.",
    items: {
      study: { title: "Study Visa", desc: "Guaranteed admission to top universities." },
      tourist: { title: "Tourist Visa", desc: "Explore the world in 3 weeks." },
      work: { title: "Work Visa", desc: "Professional opportunities and complete support." },
      insurance: { title: "Travel Insurance", desc: "International health protection compliant with consular requirements." }
    }
  }
};
// END OF FILE: src/dictionaries/data/static/services/en.ts

// FILE: src/dictionaries/data/static/services/fr.ts
-----------------------------------------------
export const frServices = {
  servicesPage: {
    title: "Nos Services de Mobilit√©",
    subtitle: "Une expertise compl√®te pour votre voyage",
    description: "Que vous partiez pour √©tudier, travailler ou visiter, AG Technologies vous garantit une proc√©dure simplifi√©e.",
    items: {
      study: { title: "Visa √âtude", desc: "Admission garantie dans les meilleures universit√©s." },
      tourist: { title: "Visa Touriste", desc: "Partez √† la d√©couverte du monde en 3 semaines." },
      work: { title: "Visa Travail", desc: "Opportunit√©s professionnelles et accompagnement complet." },
      insurance: { title: "Assurance Voyage", desc: "Protection sant√© conforme aux exigences consulaires." }
    }
  }
};
// END OF FILE: src/dictionaries/data/static/services/fr.ts

// FILE: src/dictionaries/en.ts
-----------------------------------------------
// src/dictionaries/en.ts
export const en = {
  metadata: {
    title: "SALMA Travel Agency ‚Äî Your China Visa in 3 Weeks",
    description: "SALMA is a professional agency specializing in China visa processing. Study, Tourist, Work Visas and Scholarships.",
  },

  nav: {
    home: "Home",
    services: "Services",
    bourses: "Scholarships",
    visa: "Visa",
    about: "About",
    contact: "Contact",
    getStarted: "Get Started",
    admin: "Admin",
  },

  scholarships: {
    sectionTitle: "Available Scholarships",
    deadline: "Deadline",
    language: "Language required",
    viewDetails: "View Details",
    levels: {
      LICENCE: "Bachelor",
      MASTER: "Master",
      DOCTORAT: "PhD / Doctorate",
      POST_DOC: "Post-Doc",
    },
    coverage: {
      TOTALE: "Full Scholarship",
      PARTIELLE: "Partial",
      SCOLARIT√â: "Tuition Fees",
      ALLOCATION: "Monthly Stipend",
    },
  },

  scholarshipDetail: {
    backToList: "Back to list",
    organization: "Funding Organization",
    eligibility: "Eligibility Criteria",
    benefits: "What the scholarship covers",
    studyFields: "Fields of study",
    applyTitle: "Interested in this scholarship?",
    applyDesc: "Contact our advisors to start your application process.",
    btnApply: "Apply via WhatsApp",
    btnForm: "Fill the form",
  },

  hero: {
    badge: "AG Technologies Expertise",
    title: "Achieve Your Dream of Studying in China & Germany",
    description: "Full support, visa processing in 3 weeks, and a satisfaction guarantee. Join top-tier global universities today.",
    ctaPrimary: "Find my scholarship",
    ctaSecondary: "Our visa services",
    trustIndicator: {
      count: "+500 students",
      text: "already supported this year",
    },
    imageAlt: "Study in China with SALMA",
    visaBadge: {
      number: "03",
      label: "Weeks for your Visa",
    },
  },

  trust: {
    expertise: {
      title: "AGT Expertise",
      desc: "End-to-end support by travel professionals.",
    },
    speed: {
      title: "Visa in 3 Weeks",
      desc: "Optimized procedures for a fast departure.",
    },
    guarantee: {
      title: "Satisfaction Guaranteed",
      desc: "Your success is our top priority.",
    },
  },

  stats: {
    visas: { value: "500+", label: "Visas Obtained" },
    partners: { value: "25+", label: "Partner Universities" },
    experience: { value: "05+", label: "Years of Experience" },
    satisfaction: { value: "100%", label: "Success Rate" },
  },

  featuredScholarships: {
    title: "Featured Scholarships",
    subtitle: "Outstanding Opportunities",
    viewAll: "View all scholarships",
  },

  successStories: {
    title: "They succeeded with SALMA",
    subtitle: "Success Stories",
    stories: [
      {
        name: "Marcelle T.",
        destination: "Peking University, China",
        quote: "Thanks to AGT's support, I got my full scholarship in less than two months. A professional and attentive team!",
        program: "Master in AI",
      },
      {
        name: "C√©dric M.",
        destination: "TU Berlin, Germany",
        quote: "The visa process seemed complex, but SALMA handled everything. Highly recommend for those aiming for Germany.",
        program: "BSc in Mechanics",
      },
      {
        name: "Awa B.",
        destination: "Fudan University, China",
        quote: "Satisfaction guaranteed is not just a slogan, it's a reality. My Chinese dream came true thanks to them.",
        program: "Master in Business",
      },
    ],
  },

  catalog: {
    title: "All Scholarships",
    subtitle: "China & Germany",
    description: "Find the scholarship that matches your study project in China or Germany.",
    searchPlaceholder: "Search for a scholarship...",
    filterAll: "All",
    filterCountry: "Country",
    filterLevel: "Study Level",
    noResults: "No scholarships match your search.",
    found: "scholarships found",
  },

  servicesPage: {
    title: "Our Mobility Services",
    subtitle: "Comprehensive expertise for your journey",
    description: "Whether you are traveling to study, work, or visit, AG Technologies guarantees a simplified and secured process.",
    items: {
      study: { title: "Study Visa", desc: "Guaranteed admission to the top-tier universities in China and Germany." },
      tourist: { title: "Tourist Visa", desc: "Explore the world with a fast 3-week processing time." },
      work: { title: "Work Visa", desc: "Professional opportunities and complete administrative and legal support." },
      insurance: { title: "Travel Insurance", desc: "International health protection compliant with all consular requirements." }
    }
  },

  aboutPage: {
    title: "About SALMA",
    subtitle: "AG Technologies' Expertise",
    missionTitle: "Our Mission",
    missionDesc: "To facilitate access to international education and mobility for all Cameroonian talents. We serve as a strategic bridge between Africa, China, and Germany.",
    visionTitle: "Why Trust Us?",
    visionDesc: "Located in Yaound√©, Kadji Building, we operate with total transparency. Our 'Satisfied or Refunded' slogan is not just a promise; it is our core work ethic.",
    partners: "Our University Partnerships",
  },

  contact: {
    title: "Let's talk about your project",
    subtitle: "Contact us",
    form: {
      name: "Full Name",
      email: "Email Address",
      phone: "Phone (WhatsApp)",
      subject: "Desired Scholarship",
      message: "Your message",
      send: "Send my request",
      success: "Request sent successfully!",
    },
    info: {
      address: "Mont√©e Anne rouge, Kadji Building, Yaound√©",
      email: "secretariatagtechnologies@gmail.com",
      whatsappMsg: "Hello SALMA, I would like information about scholarships for...",
    },
  },

  faq: {
    title: "Frequently Asked Questions",
    subtitle: "Everything about our services",
    items: [
      { q: "What are the visa processing times?", a: "Average of 03 weeks for China." },
      { q: "Is the refund guarantee real?", a: "Yes, it is a contractual commitment from AG Technologies." },
      { q: "Which countries do you cover?", a: "We specialize in China and Germany." },
    ],
  },

  common: {
    loading: "Loading...",
    error: "An error occurred",
    retry: "Retry",
    learnMore: "Learn More",
    close: "Close",
    back: "Back",
    next: "Next",
    previous: "Previous",
    seeAll: "See All",
    processingTime: "Processing Time",
    weeks: "weeks",
    guarantee: "Satisfaction Guaranteed",
  },

  footer: {
    tagline: "Your trusted partner for international mobility to China and Germany.",
    slogan: "Satisfied or Refunded ‚Äî Excellence serving your future.",
    links: {
      title: "Navigation",
      home: "Home",
      bourses: "Scholarships",
      services: "Services",
      about: "About",
      contact: "Contact",
    },
    contact: {
      title: "Contact Us",
      address: "Mont√©e Anne rouge, Kadji Building, Yaound√©",
      phones: "+237 6 99 45 09 84 / 6 51 74 03 28",
      email: "secretariatagtechnologies@gmail.com",
    },
    rights: "¬© 2026 SALMA by AG Technologies. All rights reserved.",
  },

  admin: {
    sidebar: {
      dashboard: "Dashboard",
      scholarships: "Scholarships Management",
      applications: "Applications",
      settings: "Settings",
      logout: "Logout",
    },
    scholarships: {
      title: "Scholarships",
      addBtn: "+ Add Scholarship",
      searchPlaceholder: "Search scholarship...",
      table: {
        title: "Scholarship Title",
        country: "Country",
        level: "Level",
        deadline: "Deadline",
        status: "Status",
        actions: "Actions",
        edit: "Edit",
        delete: "Delete",
        deleteConfirm: "Are you sure you want to delete this scholarship?",
      },
      status: {
        open: "Open",
        closed: "Closed",
        pending: "Pending",
      },
      country: {
        chine: "China",
        allemagne: "Germany",
        both: "China & Germany",
      },
      form: {
        addTitle: "Add New Scholarship",
        editTitle: "Edit Scholarship",
        title: "Scholarship Title",
        organization: "Funding Organization",
        country: "Destination Country",
        description: "Description",
        studyLevel: "Required Study Level",
        fieldOfStudy: "Field of Study",
        ageLimit: "Age Limit",
        languageReq: "Language Score (e.g. HSK 4, IELTS)",
        status: "Offer Status",
        deadline: "Deadline",
        coverageType: "Coverage Type",
        officialLink: "Official Link",
        cancel: "Cancel",
        save: "Save",
      }
    }
  },
  cookies: {
    text: "We use cookies to improve your experience and analyze our traffic. Check our",
    link: "privacy policy",
    accept: "Accept",
    decline: "Decline"
  }
} as const;
// END OF FILE: src/dictionaries/en.ts

// FILE: src/dictionaries/fr.ts
-----------------------------------------------
// src/dictionaries/fr.ts
export const fr = {
  metadata: {
    title: "SALMA Travel Agency ‚Äî Votre visa Chine en 3 semaines",
    description: "SALMA est une agence professionnelle sp√©cialis√©e dans l'obtention de visas pour la Chine. Visa √âtude, Touriste, Travail et Bourse d'√âtude.",
  },

  nav: {
    home: "Accueil",
    services: "Services",
    bourses: "Bourses",
    visa: "Visa",
    about: "√Ä propos",
    contact: "Contact",
    getStarted: "Commencer",
    admin: "Admin",
  },

  scholarships: {
    sectionTitle: "Bourses Disponibles",
    deadline: "Date limite",
    language: "Langue requise",
    viewDetails: "Consulter l'offre",
    levels: { 
      LICENCE: "Licence",
      MASTER: "Master", 
      DOCTORAT: "Doctorat",
      POST_DOC: "Post-Doctorat"
    },
    coverage: { 
      TOTALE: "Bourse Compl√®te", 
      PARTIELLE: "Partielle",
      SCOLARIT√â: "Frais de Scolarit√©",
      ALLOCATION: "Allocation Mensuelle"
    }
  },

  scholarshipDetail: {
    backToList: "Retour √† la liste",
    organization: "Organisme financier",
    eligibility: "Crit√®res d'√©ligibilit√©",
    benefits: "Ce que couvre la bourse",
    studyFields: "Domaines d'√©tudes",
    applyTitle: "Cette bourse vous int√©resse ?",
    applyDesc: "Contactez nos conseillers pour monter votre dossier de candidature.",
    btnApply: "Postuler via WhatsApp",
    btnForm: "Remplir le formulaire"
  },

  hero: {
    badge: "Expertise AG Technologies",
    title: "R√©alisez votre r√™ve d'√©tudes en Chine & Allemagne",
    description: "Accompagnement complet, obtention de visa en 3 semaines et garantie satisfait ou rembours√©. Rejoignez les meilleures universit√©s mondiales.",
    ctaPrimary: "Trouver ma bourse",
    ctaSecondary: "Nos services de visa",
    trustIndicator: {
      count: "+500 √©tudiants",
      text: "d√©j√† accompagn√©s cette ann√©e"
    },
    imageAlt: "√âtudier en Chine avec SALMA",
    visaBadge: {
      number: "03",
      label: "Semaines pour votre Visa"
    }
  },

  trust: {
    expertise: {
      title: "Expertise AGT",
      desc: "Un accompagnement de A √† Z par des professionnels."
    },
    speed: {
      title: "Visa en 3 semaines",
      desc: "Des proc√©dures optimis√©es pour un d√©part rapide."
    },
    guarantee: {
      title: "Satisfait ou Rembours√©",
      desc: "Votre r√©ussite est notre priorit√© absolue."
    }
  },

  stats: {
    visas: { value: "500+", label: "Visas Obtenus" },
    partners: { value: "25+", label: "Universit√©s Partenaires" },
    experience: { value: "05+", label: "Ann√©es d'Exp√©rience" },
    satisfaction: { value: "100%", label: "Taux de R√©ussite" }
  },

  featuredScholarships: {
    title: "Bourses √† la une",
    subtitle: "Opportunit√©s Exceptionnelles",
    viewAll: "Voir toutes les bourses",
  },

  successStories: {
    title: "Ils ont r√©ussi avec SALMA",
    subtitle: "Histoires de Succ√®s",
    stories: [
      {
        name: "Marcelle T.",
        destination: "Universit√© de P√©kin, Chine",
        quote: "Gr√¢ce √† l'accompagnement d'AGT, j'ai obtenu ma bourse compl√®te en moins de deux mois. Une √©quipe professionnelle et √† l'√©coute !",
        program: "Master en IA"
      },
      {
        name: "C√©dric M.",
        destination: "TU Berlin, Allemagne",
        quote: "Le processus de visa semblait complexe, mais SALMA a tout g√©r√©. Je recommande vivement pour ceux qui visent l'Allemagne.",
        program: "Licence en M√©canique"
      },
      {
        name: "Awa B.",
        destination: "Universit√© de Fudan, Chine",
        quote: "Satisfaite ou rembours√©e n'est pas qu'un slogan, c'est une r√©alit√©. Mon r√™ve chinois est devenu possible gr√¢ce √† eux.",
        program: "Master en Commerce"
      }
    ]
  },

  catalog: {
    title: "Toutes nos bourses",
     subtitle: "Chine & Allemagne",
    description: "Trouvez la bourse qui correspond √† votre projet d'√©tudes en Chine ou en Allemagne.",
    searchPlaceholder: "Rechercher une bourse...",
    filterAll: "Tous",
    filterCountry: "Pays",
    filterLevel: "Niveau d'√©tudes",
    noResults: "Aucune bourse ne correspond √† votre recherche.",
    found: "bourses trouv√©es"
  },

  servicesPage: {
    title: "Nos Services de Mobilit√©",
    subtitle: "Une expertise compl√®te pour votre voyage",
    description: "Que vous partiez pour √©tudier, travailler ou visiter, AG Technologies vous garantit une proc√©dure simplifi√©e et s√©curis√©e.",
    items: {
      study: { title: "Visa √âtude", desc: "Admission garantie dans les meilleures universit√©s de Chine et d'Allemagne." },
      tourist: { title: "Visa Touriste", desc: "Partez √† la d√©couverte du monde avec une proc√©dure rapide en 3 semaines." },
      work: { title: "Visa Travail", desc: "Opportunit√©s professionnelles et accompagnement administratif complet." },
      insurance: { title: "Assurance Voyage", desc: "Protection sant√© internationale conforme aux exigences consulaires." }
    }
  },

  aboutPage: {
    title: "√Ä propos de SALMA",
    subtitle: "L'expertise d'AG Technologies",
    missionTitle: "Notre Mission",
    missionDesc: "Faciliter l'acc√®s √† l'√©ducation internationale et √† la mobilit√© pour tous les talents camerounais. Nous servons de pont entre l'Afrique, la Chine et l'Allemagne.",
    visionTitle: "Pourquoi nous faire confiance ?",
    visionDesc: "Install√©s √† Yaound√©, Immeuble Kadji, nous op√©rons avec une transparence totale. Notre slogan 'Satisfait ou Rembours√©' n'est pas qu'une promesse, c'est notre √©thique de travail.",
    partners: "Nos Partenariats Universitaires",
  },

  contact: {
    title: "Parlons de votre projet",
    subtitle: "Contactez-nous",
    form: {
      name: "Nom complet",
      email: "Adresse Email",
      phone: "T√©l√©phone (WhatsApp)",
      subject: "Bourse souhait√©e",
      message: "Votre message",
      send: "Envoyer ma demande",
      success: "Demande envoy√©e avec succ√®s !"
    },
    info: {
      address: "Mont√©e Anne rouge, Immeuble Kadji, Yaound√©",
      email: "secretariatagtechnologies@gmail.com",
      whatsappMsg: "Bonjour SALMA, je souhaiterais avoir des informations sur les bourses pour..."
    }
  },

  faq: {
    title: "Questions fr√©quentes",
    subtitle: "Tout savoir sur nos services",
    items: [
      { q: "Quels sont les d√©lais pour le visa ?", a: "En moyenne 03 semaines pour la Chine." },
      { q: "La garantie remboursement est-elle r√©elle ?", a: "Oui, c'est un engagement contractuel d'AG Technologies." },
      { q: "Quels pays couvrez-vous ?", a: "Nous sommes sp√©cialis√©s sur la Chine et l'Allemagne." }
    ]
  },

  common: {
    loading: "Chargement...",
    error: "Une erreur est survenue",
    retry: "R√©essayer",
    learnMore: "En savoir plus",
    close: "Fermer",
    back: "Retour",
    next: "Suivant",
    previous: "Pr√©c√©dent",
    seeAll: "Voir tout",
    processingTime: "D√©lai de traitement",
    weeks: "semaines",
    guarantee: "Satisfait ou rembours√©",
  },

  footer: {
    tagline: "Votre partenaire de confiance pour la mobilit√© internationale vers la Chine et l'Allemagne.",
    slogan: "Satisfait ou Rembours√© ‚Äî L'excellence au service de votre avenir.",
    links: {
      title: "Navigation",
      home: "Accueil",
      bourses: "Bourses",
      services: "Services",
      about: "√Ä propos",
      contact: "Contact"
    },
    contact: {
      title: "Contactez-nous",
      address: "Mont√©e Anne rouge, Immeuble Kadji, Yaound√©",
      phones: "+237 6 99 45 09 84 / 6 51 74 03 28",
      email: "secretariatagtechnologies@gmail.com"
    },
    rights: "¬© 2026 SALMA by AG Technologies. Tous droits r√©serv√©s."
  },

  admin: {
    sidebar: {
      dashboard: "Tableau de bord",
      scholarships: "Gestion des Bourses",
      applications: "Candidatures",
      settings: "Param√®tres",
      logout: "D√©connexion",
    },
    scholarships: {
      title: "Bourses d'√©tudes",
      addBtn: "+ Ajouter une bourse",
      searchPlaceholder: "Rechercher une bourse...",
      table: {
        title: "Titre de la bourse",
        country: "Pays",
        level: "Niveau",
        deadline: "Date limite",
        status: "Statut",
        actions: "Actions",
        edit: "√âditer",
        delete: "Supprimer",
        deleteConfirm: "Voulez-vous vraiment supprimer cette bourse ?",
      },
      status: {
        open: "Ouvert",
        closed: "Ferm√©",
        pending: "En attente",
      },
      country: {
        chine: "Chine",
        allemagne: "Allemagne",
        both: "Chine & Allemagne",
      },
      form: {
        addTitle: "Ajouter une nouvelle bourse",
        editTitle: "Modifier la bourse",
        title: "Titre de la bourse",
        organization: "Organisme financeur",
        country: "Pays de destination",
        description: "Description",
        studyLevel: "Niveau d'√©tudes requis",
        fieldOfStudy: "Domaine d'√©tudes",
        ageLimit: "√Çge limite",
        languageReq: "Score de langue (ex: HSK 4, IELTS)",
        status: "Statut de l'offre",
        deadline: "Date limite",
        coverageType: "Type de couverture",
        officialLink: "Lien officiel",
        cancel: "Annuler",
        save: "Enregistrer",
      }
    }
  },
  cookies: {
    text: "Nous utilisons des cookies pour am√©liorer votre exp√©rience et analyser notre trafic. Consultez notre",
    link: "politique de confidentialit√©",
    accept: "Accepter",
    decline: "Refuser"
  }
} as const;
// END OF FILE: src/dictionaries/fr.ts

// FILE: src/dictionaries/index.ts
-----------------------------------------------
import { fr } from "./fr";
import { en } from "./en";
import type { Locale } from "@/config/i18n";

// Utilitaire pour transformer les types "litt√©raux" (as const) en type "string"
// Cela permet d'avoir des textes diff√©rents entre FR et EN tout en gardant la m√™me structure
type DeepString<T> = {
  [K in keyof T]: T[K] extends object ? DeepString<T[K]> : string;
};

// On d√©finit le type global bas√© sur la structure de FR
export type DictionaryType = DeepString<typeof fr>;

// Registre des dictionnaires
// On utilise "as DictionaryType" pour assouplir la v√©rification des valeurs textuelles
const dictionaries: Record<Locale, DictionaryType> = {
  fr: fr as DictionaryType,
  en: en as DictionaryType,
};

export function getDictionary(locale: Locale): DictionaryType {
  return dictionaries[locale];
}
// END OF FILE: src/dictionaries/index.ts

// FILE: src/hooks/useAuth.ts
-----------------------------------------------
// src/hooks/useAuth.ts
// ==============================================================================
//  Hook useAuth ‚Äî √âtat d'authentification JWT c√¥t√© client
//  Usage dans tout Client Component du dashboard admin
//
//  const { user, isLoading, isAuthenticated, login, logout } = useAuth();
// ==============================================================================
"use client";

import { useState, useEffect, useCallback } from "react";
import { useRouter } from "next/navigation";
import { authRepository } from "@/repositories/auth.repository";
import { tokenStorage } from "@/lib/api-client";
import type { AdminUser, LoginPayload } from "@/types/api/auth.types";

interface AuthState {
  user: AdminUser | null;
  isLoading: boolean;
  isAuthenticated: boolean;
  error: string | null;
}

export function useAuth() {
  const router = useRouter();
  const [state, setState] = useState<AuthState>({
    user: null,
    isLoading: true,
    isAuthenticated: false,
    error: null,
  });

  // ---------------------------------------------------------------------------
  //  Au montage : v√©rifier si un token existe et r√©cup√©rer le profil
  // ---------------------------------------------------------------------------
  useEffect(() => {
    const init = async () => {
      const hasToken = authRepository.isAuthenticated();

      if (!hasToken) {
        setState({ user: null, isLoading: false, isAuthenticated: false, error: null });
        return;
      }

      try {
        const user = await authRepository.getMe();
        setState({ user, isLoading: false, isAuthenticated: true, error: null });
      } catch {
        // Token invalide ou expir√© ‚Üí tenter un refresh
        try {
          await authRepository.refreshToken();
          const user = await authRepository.getMe();
          setState({ user, isLoading: false, isAuthenticated: true, error: null });
        } catch {
          // Refresh √©chou√© ‚Üí d√©connexion propre
          tokenStorage.clear();
          setState({ user: null, isLoading: false, isAuthenticated: false, error: null });
        }
      }
    };

    init();
  }, []);

  // ---------------------------------------------------------------------------
  //  Login
  // ---------------------------------------------------------------------------
  const login = useCallback(
    async (payload: LoginPayload, redirectTo = "/admin/dashboard") => {
      setState((prev) => ({ ...prev, isLoading: true, error: null }));

      try {
        const response = await authRepository.login(payload);
        setState({
          user: response.user,
          isLoading: false,
          isAuthenticated: true,
          error: null,
        });
        router.push(redirectTo);
      } catch (err) {
        const message =
          err instanceof Error ? err.message : "Identifiants incorrects.";
        setState((prev) => ({ ...prev, isLoading: false, error: message }));
        throw err; // Re-throw pour que le formulaire puisse r√©agir
      }
    },
    [router]
  );

  // ---------------------------------------------------------------------------
  //  Logout
  // ---------------------------------------------------------------------------
  const logout = useCallback(async () => {
    setState((prev) => ({ ...prev, isLoading: true }));
    await authRepository.logout();
    setState({ user: null, isLoading: false, isAuthenticated: false, error: null });
    router.push("/admin/login");
  }, [router]);

  // ---------------------------------------------------------------------------
  //  Clear error
  // ---------------------------------------------------------------------------
  const clearError = useCallback(() => {
    setState((prev) => ({ ...prev, error: null }));
  }, []);

  return {
    user: state.user,
    isLoading: state.isLoading,
    isAuthenticated: state.isAuthenticated,
    error: state.error,
    login,
    logout,
    clearError,
  };
}
// END OF FILE: src/hooks/useAuth.ts

// FILE: src/hooks/useLanguage.ts
-----------------------------------------------
// src/hooks/useLanguage.ts
"use client";

import { useContext } from "react";
import { LanguageContext } from "@/contexts/LanguageContext";

// ============================================================
//  HOOK useLanguage
//  Usage dans n'importe quel composant :
//
//  const { locale, dictionary, setLocale } = useLanguage();
//  <h1>{dictionary.hero.title}</h1>
//  <button onClick={() => setLocale("fr")}>FR</button>
// ============================================================
export function useLanguage() {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error("useLanguage doit √™tre utilis√© dans un <LanguageProvider>");
  }
  return context;
}
// END OF FILE: src/hooks/useLanguage.ts

// FILE: src/hooks/useTheme.ts
-----------------------------------------------
// src/hooks/useTheme.ts
"use client";

import { useTheme as useNextTheme } from "next-themes";

// ============================================================
//  HOOK useTheme
//  Wrapper autour de next-themes pour une API plus simple.
//
//  Usage dans n'importe quel composant :
//
//  const { theme, isDark, toggleTheme, setTheme } = useTheme();
//
//  <button onClick={toggleTheme}>
//    {isDark ? "Mode clair" : "Mode sombre"}
//  </button>
// ============================================================
export function useTheme() {
  const { theme, setTheme, resolvedTheme } = useNextTheme();

  const isDark = resolvedTheme === "dark";

  const toggleTheme = () => {
    setTheme(isDark ? "light" : "dark");
  };

  return {
    theme,           // "light" | "dark" | "system"
    resolvedTheme,   // "light" | "dark" (jamais "system")
    isDark,          // boolean ‚Äî pratique pour les conditions
    toggleTheme,     // bascule light ‚Üî dark
    setTheme,        // contr√¥le direct si besoin
  };
}
// END OF FILE: src/hooks/useTheme.ts

// FILE: src/lib/api-client.ts
-----------------------------------------------
// src/lib/api-client.ts
// ==============================================================================
//  Client HTTP central du projet SALMA
//  - Toutes les requ√™tes passent par ici
//  - Gestion automatique du token JWT (Authorization header)
//  - Gestion des erreurs unifi√©e
//  - Support des query params, revalidation ISR et multipart/form-data
// ==============================================================================

export const API_URL = process.env.NEXT_PUBLIC_API_URL || "http://127.0.0.1:8000/api";
export const BACKEND_URL = process.env.NEXT_PUBLIC_BACKEND_URL || "http://127.0.0.1:8000";

// ==============================================================================
//  Types
// ==============================================================================

export interface ApiError {
  status: number;
  message: string;
  detail?: Record<string, unknown>;
}

export class ApiException extends Error {
  status: number;
  detail?: Record<string, unknown>;

  constructor(error: ApiError) {
    super(error.message);
    this.name = "ApiException";
    this.status = error.status;
    this.detail = error.detail;
  }
}

interface FetchOptions extends RequestInit {
  /** Query params ajout√©s √† l'URL : { page: "2", country: "cn" } */
  params?: Record<string, string | number | boolean | undefined>;
  /** Secondes de revalidation ISR Next.js (Server Components uniquement) */
  revalidate?: number | false;
  /** Si true, ne pas ajouter Content-Type (pour FormData/multipart) */
  isMultipart?: boolean;
}

// ==============================================================================
//  Helpers JWT
//  C√¥t√© client uniquement ‚Äî les Server Components utilisent les cookies httpOnly
// ==============================================================================

const TOKEN_KEY = "salma_access_token";
const REFRESH_KEY = "salma_refresh_token";

export const tokenStorage = {
  getAccess: (): string | null => {
    if (typeof window === "undefined") return null;
    return localStorage.getItem(TOKEN_KEY);
  },
  getRefresh: (): string | null => {
    if (typeof window === "undefined") return null;
    return localStorage.getItem(REFRESH_KEY);
  },
  set: (access: string, refresh: string): void => {
    if (typeof window === "undefined") return;
    localStorage.setItem(TOKEN_KEY, access);
    localStorage.setItem(REFRESH_KEY, refresh);
  },
  clear: (): void => {
    if (typeof window === "undefined") return;
    localStorage.removeItem(TOKEN_KEY);
    localStorage.removeItem(REFRESH_KEY);
  },
};

// ==============================================================================
//  Helper ‚Äî construire l'URL compl√®te d'un m√©dia Django
//  Usage : getMediaUrl("/media/bourses/image.jpg") ‚Üí "http://....:8000/media/..."
// ==============================================================================
export function getMediaUrl(path: string | null | undefined): string | null {
  if (!path) return null;
  if (path.startsWith("http")) return path; // d√©j√† absolu
  return `${BACKEND_URL}${path.startsWith("/") ? path : `/${path}`}`;
}

// ==============================================================================
//  Fonction de fetch centrale
// ==============================================================================

async function apiFetch<T>(endpoint: string, options: FetchOptions = {}): Promise<T> {
  const { params, revalidate, isMultipart, ...customConfig } = options;

  // --- Construction de l'URL ---
  const url = new URL(`${API_URL}${endpoint.startsWith("/") ? endpoint : `/${endpoint}`}`);
  if (params) {
    Object.entries(params).forEach(([key, value]) => {
      if (value !== undefined && value !== null && value !== "") {
        url.searchParams.append(key, String(value));
      }
    });
  }

  // --- Headers ---
  const headers: Record<string, string> = {};

  // Content-Type automatique (sauf pour FormData)
  if (!isMultipart) {
    headers["Content-Type"] = "application/json";
  }

  // Injection du token JWT si disponible (c√¥t√© client)
  const token = tokenStorage.getAccess();
  if (token) {
    headers["Authorization"] = `Bearer ${token}`;
  }

  // Merge avec les headers personnalis√©s
  if (customConfig.headers) {
    Object.assign(headers, customConfig.headers);
  }

  // --- Config fetch ---
  const config: RequestInit = {
    ...customConfig,
    headers,
    // Support ISR Next.js pour les Server Components
    next: revalidate !== undefined ? { revalidate } : customConfig.next,
  };

  // --- Ex√©cution ---
  try {
    const response = await fetch(url.toString(), config);

    // R√©ponse vide (DELETE, etc.)
    if (response.status === 204) return {} as T;

    // Tentative de parsing JSON
    const data = await response.json().catch(() => ({}));

    // Erreur HTTP
    if (!response.ok) {
      throw new ApiException({
        status: response.status,
        message: extractErrorMessage(data, response.status),
        detail: data,
      });
    }

    return data as T;
  } catch (error) {
    // Re-throw si c'est d√©j√† notre type d'erreur
    if (error instanceof ApiException) throw error;

    // Erreur r√©seau (backend inaccessible, CORS, etc.)
    throw new ApiException({
      status: 0,
      message: "Impossible de contacter le serveur. V√©rifie ta connexion ou l'adresse API.",
      detail: { originalError: String(error) },
    });
  }
}

// ==============================================================================
//  Helper ‚Äî Extraction du message d'erreur Django DRF
// ==============================================================================

function extractErrorMessage(data: Record<string, unknown>, status: number): string {
  if (typeof data?.detail === "string") return data.detail;
  if (typeof data?.message === "string") return data.message;
  if (status === 401) return "Non authentifi√©. Veuillez vous connecter.";
  if (status === 403) return "Acc√®s refus√©. Vous n'avez pas les permissions n√©cessaires.";
  if (status === 404) return "Ressource introuvable.";
  if (status === 422 || status === 400) return "Donn√©es invalides. V√©rifiez le formulaire.";
  if (status >= 500) return "Erreur serveur. Contactez l'administrateur.";
  return `Erreur inattendue (${status})`;
}

// ==============================================================================
//  API publique du client ‚Äî utilis√©e par tous les repositories
// ==============================================================================

export const api = {
  get: <T>(url: string, options?: FetchOptions) =>
    apiFetch<T>(url, { ...options, method: "GET" }),

  post: <T>(url: string, body: unknown, options?: FetchOptions) =>
    apiFetch<T>(url, { ...options, method: "POST", body: JSON.stringify(body) }),

  put: <T>(url: string, body: unknown, options?: FetchOptions) =>
    apiFetch<T>(url, { ...options, method: "PUT", body: JSON.stringify(body) }),

  patch: <T>(url: string, body: unknown, options?: FetchOptions) =>
    apiFetch<T>(url, { ...options, method: "PATCH", body: JSON.stringify(body) }),

  delete: <T>(url: string, options?: FetchOptions) =>
    apiFetch<T>(url, { ...options, method: "DELETE" }),

  /** Pour les uploads fichiers (FormData ‚Äî pas de Content-Type automatique) */
  upload: <T>(url: string, formData: FormData, options?: FetchOptions) =>
    apiFetch<T>(url, { ...options, method: "POST", body: formData, isMultipart: true }),

  /** Upload avec m√©thode PATCH (ex: mise √† jour partielle avec fichier) */
  uploadPatch: <T>(url: string, formData: FormData, options?: FetchOptions) =>
    apiFetch<T>(url, { ...options, method: "PATCH", body: formData, isMultipart: true }),
};
// END OF FILE: src/lib/api-client.ts

// FILE: src/middleware.ts
-----------------------------------------------
import { NextRequest, NextResponse } from "next/server";

export function middleware(request: NextRequest) {
  const { pathname } = request.nextUrl;
  const authCookie = request.cookies.get("salma_auth")?.value;

  const isLoginPage = pathname === "/admin/login";
  const isAdminPage = pathname.startsWith("/admin") && !isLoginPage;

  // 1. Si on tente d'acc√©der √† l'admin sans cookie -> Login
  if (isAdminPage && !authCookie) {
    const url = new URL("/admin/login", request.url);
    url.searchParams.set("redirect", pathname);
    return NextResponse.redirect(url);
  }

  // 2. Si on est sur Login mais qu'on a d√©j√† un cookie -> Dashboard
  // C'est CA qui casse la boucle infinie
  if (isLoginPage && authCookie) {
    return NextResponse.redirect(new URL("/admin/dashboard", request.url));
  }

  return NextResponse.next();
}

export const config = {
  matcher: ["/admin/:path*"],
};
// END OF FILE: src/middleware.ts

// FILE: src/repositories/auth.repository.ts
-----------------------------------------------
// src/repositories/auth.repository.ts
import { api, tokenStorage } from "@/lib/api-client";
import type {
  LoginPayload,
  LoginResponse,
  LogoutPayload,
  RegisterPayload,
  AdminUser,
  ChangePasswordPayload,
  ResetPasswordRequestPayload,
  ResetPasswordConfirmPayload,
  UpdateProfilePayload,
  TokenRefreshPayload,
  TokenRefreshResponse,
} from "@/types/api/auth.types";

const BASE = "/auth";

export const authRepository = {
  /**
   * POST /api/auth/login
   * Connexion ‚Üí retourne les tokens + profil
   */
  login: async (payload: LoginPayload): Promise<LoginResponse> => {
    const response = await api.post<LoginResponse>(`${BASE}/login`, payload);
    
    // 1. Stockage Client (localStorage) pour les futurs appels API
    tokenStorage.set(response.access, response.refresh);

    // 2. Stockage Cookie pour le Middleware Next.js (Protection des routes serveur)
    if (typeof document !== "undefined") {
      // Expire dans 24h, accessible sur tout le domaine
      document.cookie = `salma_auth=${response.access}; path=/; max-age=86400; SameSite=Lax`;
    }
    
    return response;
  },

  /**
   * POST /api/auth/logout
   * D√©connexion ‚Üí invalide le token et nettoie tout
   */
  logout: async (): Promise<void> => {
    const refresh = tokenStorage.getRefresh();
    if (refresh) {
      const payload: LogoutPayload = { refresh };
      await api.post<void>(`${BASE}/logout`, payload).catch(() => {});
    }
    
    // Nettoyage localStorage
    tokenStorage.clear();

    // Nettoyage Cookie
    if (typeof document !== "undefined") {
      document.cookie = "salma_auth=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;";
    }
  },

  /**
   * GET /api/auth/me
   * R√©cup√©rer le profil de l'admin connect√©
   */
  getMe: async (): Promise<AdminUser> => {
    return api.get<AdminUser>(`${BASE}/me`);
  },

  /**
   * POST /api/auth/register
   */
  register: async (payload: RegisterPayload): Promise<AdminUser> => {
    return api.post<AdminUser>(`${BASE}/register`, payload);
  },

  /**
   * PATCH /api/auth/me
   */
  updateProfile: async (payload: UpdateProfilePayload): Promise<AdminUser> => {
    return api.patch<AdminUser>(`${BASE}/me`, payload);
  },

  /**
   * PUT /api/auth/change-password
   */
  changePassword: async (payload: ChangePasswordPayload): Promise<void> => {
    return api.put<void>(`${BASE}/change-password`, payload);
  },

  /**
   * POST /api/auth/reset-password
   */
  requestPasswordReset: async (payload: ResetPasswordRequestPayload): Promise<void> => {
    return api.post<void>(`${BASE}/reset-password`, payload);
  },

  /**
   * POST /api/auth/reset-password/confirm
   */
  confirmPasswordReset: async (payload: ResetPasswordConfirmPayload): Promise<void> => {
    return api.post<void>(`${BASE}/reset-password/confirm`, payload);
  },

  /**
   * POST /api/auth/token/refresh
   */
  refreshToken: async (): Promise<TokenRefreshResponse | null> => {
    const refresh = tokenStorage.getRefresh();
    if (!refresh) return null;

    const payload: TokenRefreshPayload = { refresh };
    const response = await api.post<TokenRefreshResponse>(`${BASE}/token/refresh`, payload);

    const newRefresh = response.refresh ?? refresh;
    tokenStorage.set(response.access, newRefresh);

    return response;
  },

  /**
   * V√©rifie la pr√©sence locale d'un token
   */
  isAuthenticated: (): boolean => {
    return !!tokenStorage.getAccess();
  },
};
// END OF FILE: src/repositories/auth.repository.ts

// FILE: src/repositories/chatbot.repository.ts
-----------------------------------------------
// src/repositories/chatbot.repository.ts
import { api as apiClient } from "@/lib/api-client";
import type {
  FaqEntry,
  ChatbotMessagePayload,   // Au lieu de ChatbotQueryPayload
  ChatbotMessageResponse,  // Au lieu de ChatbotResponse
  CreateFaqEntryPayload,   // Au lieu de CreateFaqPayload
  UpdateFaqEntryPayload,   // Au lieu de UpdateFaqPayload
} from "@/types/api/chatbot.types";

export const chatbotRepository = {
  /** POST /api/chatbot/message ‚Äî interroger le chatbot (public) */
  query: (payload: ChatbotMessagePayload): Promise<ChatbotMessageResponse> =>
    apiClient.post("/chatbot/message", payload),

  /** GET /api/admin/chatbot/questions */
  adminGetFaqs: (): Promise<FaqEntry[]> =>
    apiClient.get<FaqEntry[]>("/admin/chatbot/questions"),

  /** GET /api/admin/chatbot/questions/{id} */
  adminGetFaq: (id: string): Promise<FaqEntry> =>
    apiClient.get(`/admin/chatbot/questions/${id}`),

  /** POST /api/admin/chatbot/questions */
  adminCreateFaq: (payload: CreateFaqEntryPayload): Promise<FaqEntry> =>
    apiClient.post("/admin/chatbot/questions", payload),

  /** PATCH /api/admin/chatbot/questions/{id} */
  adminUpdateFaq: (id: string, payload: UpdateFaqEntryPayload): Promise<FaqEntry> =>
    apiClient.patch(`/admin/chatbot/questions/${id}`, payload),

  /** DELETE /api/admin/chatbot/questions/{id} */
  adminDeleteFaq: (id: string): Promise<void> =>
    apiClient.delete(`/admin/chatbot/questions/${id}`),
};
// END OF FILE: src/repositories/chatbot.repository.ts

// FILE: src/repositories/cms.repository.ts
-----------------------------------------------
// src/repositories/cms.repository.ts
// ==============================================================================
//  Repository ‚Äî CMS (Pages, Blocs, Config, Vid√©os)
//  20 endpoints : 4 publics + 16 admin
// ==============================================================================

import { api } from "@/lib/api-client";
import type {
  SitePagePublic,
  SitePageAdmin,
  CreateSitePagePayload,
  UpdateSitePagePayload,
  ContentBlock,
  CreateContentBlockPayload,
  UpdateContentBlockPayload,
  SiteConfig,
  CreateSiteConfigPayload,
  UpdateSiteConfigPayload,
  PitchVideo,
  CreatePitchVideoPayload,
  UpdatePitchVideoPayload,
} from "@/types/api/cms.types";

// ==============================================================================
//  Endpoints PUBLICS (vitrine)
// ==============================================================================

export const cmsPublicRepository = {
  /**
   * GET /api/pages
   * Liste des pages publi√©es
   */
  getPages: (): Promise<SitePagePublic[]> => {
    return api.get<SitePagePublic[]>("/pages", { revalidate: 120 });
  },

  /**
   * GET /api/pages/{slug}
   * Contenu complet d'une page (blocs visibles uniquement)
   */
  getPageBySlug: (slug: string): Promise<SitePagePublic> => {
    return api.get<SitePagePublic>(`/pages/${slug}`, { revalidate: 60 });
  },

  /**
   * GET /api/config
   * Configurations globales du site
   */
  getConfig: (): Promise<SiteConfig[]> => {
    return api.get<SiteConfig[]>("/config", { revalidate: 120 });
  },

  /**
   * GET /api/videos
   * Vid√©os de pitch actives
   */
  getVideos: (): Promise<PitchVideo[]> => {
    return api.get<PitchVideo[]>("/videos", { revalidate: 120 });
  },
};

// ==============================================================================
//  Endpoints ADMIN (dashboard)
// ==============================================================================

export const cmsAdminRepository = {

  // --- Pages -----------------------------------------------------------------

  /**
   * GET /api/admin/pages
   * Liste de toutes les pages (publi√©es ou non)
   */
  getPages: (): Promise<SitePageAdmin[]> => {
    return api.get<SitePageAdmin[]>("/admin/pages");
  },

  /**
   * GET /api/admin/pages/{id}
   * D√©tail avec tous les blocs
   */
  getPageById: (id: string): Promise<SitePageAdmin> => {
    return api.get<SitePageAdmin>(`/admin/pages/${id}`);
  },

  /**
   * POST /api/admin/pages
   * Cr√©er une page
   */
  createPage: (payload: CreateSitePagePayload): Promise<SitePageAdmin> => {
    return api.post<SitePageAdmin>("/admin/pages", payload);
  },

  /**
   * PUT /api/admin/pages/{id}
   * Modifier compl√®tement une page
   */
  updatePage: (id: string, payload: CreateSitePagePayload): Promise<SitePageAdmin> => {
    return api.put<SitePageAdmin>(`/admin/pages/${id}`, payload);
  },

  /**
   * PATCH /api/admin/pages/{id}
   * Modifier partiellement
   */
  patchPage: (id: string, payload: UpdateSitePagePayload): Promise<SitePageAdmin> => {
    return api.patch<SitePageAdmin>(`/admin/pages/${id}`, payload);
  },

  /**
   * DELETE /api/admin/pages/{id}
   */
  deletePage: (id: string): Promise<void> => {
    return api.delete<void>(`/admin/pages/${id}`);
  },

  // --- Blocs de contenu (nested sous pages) ----------------------------------

  /**
   * POST /api/admin/pages/{pageId}/blocs
   * Ajouter un bloc √† une page
   */
  createBlock: (pageId: string, payload: CreateContentBlockPayload): Promise<ContentBlock> => {
    return api.post<ContentBlock>(`/admin/pages/${pageId}/blocs`, payload);
  },

  /**
   * PUT /api/admin/pages/{pageId}/blocs/{blocId}
   * Modifier compl√®tement un bloc
   */
  updateBlock: (pageId: string, blocId: string, payload: CreateContentBlockPayload): Promise<ContentBlock> => {
    return api.put<ContentBlock>(`/admin/pages/${pageId}/blocs/${blocId}`, payload);
  },

  /**
   * PATCH /api/admin/pages/{pageId}/blocs/{blocId}
   * Modifier partiellement un bloc
   */
  patchBlock: (pageId: string, blocId: string, payload: UpdateContentBlockPayload): Promise<ContentBlock> => {
    return api.patch<ContentBlock>(`/admin/pages/${pageId}/blocs/${blocId}`, payload);
  },

  /**
   * DELETE /api/admin/pages/{pageId}/blocs/{blocId}
   */
  deleteBlock: (pageId: string, blocId: string): Promise<void> => {
    return api.delete<void>(`/admin/pages/${pageId}/blocs/${blocId}`);
  },

  // --- Config globale --------------------------------------------------------

  /**
   * GET /api/admin/config
   * Liste de toutes les configs
   */
  getConfigs: (): Promise<SiteConfig[]> => {
    return api.get<SiteConfig[]>("/admin/config");
  },

  /**
   * POST /api/admin/config
   * Cr√©er une config
   */
  createConfig: (payload: CreateSiteConfigPayload): Promise<SiteConfig> => {
    return api.post<SiteConfig>("/admin/config", payload);
  },

  /**
   * PUT /api/admin/config/{cle}
   * Modifier compl√®tement
   */
  updateConfig: (cle: string, payload: CreateSiteConfigPayload): Promise<SiteConfig> => {
    return api.put<SiteConfig>(`/admin/config/${cle}`, payload);
  },

  /**
   * PATCH /api/admin/config/{cle}
   * Modifier partiellement
   */
  patchConfig: (cle: string, payload: UpdateSiteConfigPayload): Promise<SiteConfig> => {
    return api.patch<SiteConfig>(`/admin/config/${cle}`, payload);
  },

  /**
   * DELETE /api/admin/config/{cle}
   */
  deleteConfig: (cle: string): Promise<void> => {
    return api.delete<void>(`/admin/config/${cle}`);
  },

  // --- Vid√©os de pitch -------------------------------------------------------

  /**
   * GET /api/admin/videos
   * Liste des vid√©os
   */
  getVideos: (): Promise<PitchVideo[]> => {
    return api.get<PitchVideo[]>("/admin/videos");
  },

  /**
   * GET /api/admin/videos/{id}
   * D√©tail d'une vid√©o
   */
  getVideoById: (id: string): Promise<PitchVideo> => {
    return api.get<PitchVideo>(`/admin/videos/${id}`);
  },

  /**
   * POST /api/admin/videos
   * Ajouter une vid√©o
   */
  createVideo: (payload: CreatePitchVideoPayload): Promise<PitchVideo> => {
    return api.post<PitchVideo>("/admin/videos", payload);
  },

  /**
   * PUT /api/admin/videos/{id}
   * Modifier compl√®tement
   */
  updateVideo: (id: string, payload: CreatePitchVideoPayload): Promise<PitchVideo> => {
    return api.put<PitchVideo>(`/admin/videos/${id}`, payload);
  },

  /**
   * PATCH /api/admin/videos/{id}
   * Modifier partiellement
   */
  patchVideo: (id: string, payload: UpdatePitchVideoPayload): Promise<PitchVideo> => {
    return api.patch<PitchVideo>(`/admin/videos/${id}`, payload);
  },

  /**
   * DELETE /api/admin/videos/{id}
   */
  deleteVideo: (id: string): Promise<void> => {
    return api.delete<void>(`/admin/videos/${id}`);
  },
};
// END OF FILE: src/repositories/cms.repository.ts

// FILE: src/repositories/contact.repository.ts
-----------------------------------------------
// src/repositories/contact.repository.ts
// ==============================================================================
//  Repository ‚Äî Demandes de Contact
//  5 endpoints : 1 public + 4 admin
// ==============================================================================

import { api } from "@/lib/api-client";
import type {
  ContactRequest,
  CreateContactPayload,
  UpdateContactPayload,
  PaginatedContactResponse,
  ContactFilters,
} from "@/types/api/contact.types";

const PUBLIC = "/contact";
const ADMIN = "/admin/contacts";

// ==============================================================================
//  Endpoint PUBLIC (vitrine)
// ==============================================================================

export const contactPublicRepository = {
  /**
   * POST /api/contact
   * Soumettre une demande de contact (+ bourses optionnelles + newsletter)
   */
  submit: (payload: CreateContactPayload): Promise<ContactRequest> => {
    return api.post<ContactRequest>(PUBLIC, payload);
  },
};

// ==============================================================================
//  Endpoints ADMIN (dashboard)
// ==============================================================================

export const contactAdminRepository = {
  /**
   * GET /api/admin/contacts
   * Liste des demandes (filtres : lu/non lu)
   */
  getList: (filters?: ContactFilters): Promise<PaginatedContactResponse> => {
    const params: Record<string, string> = {};
    if (filters?.est_lu !== undefined) params.est_lu = String(filters.est_lu);
    if (filters?.search) params.search = filters.search;
    if (filters?.page) params.page = String(filters.page);
    if (filters?.page_size) params.page_size = String(filters.page_size);
    if (filters?.ordering) params.ordering = filters.ordering;

    return api.get<PaginatedContactResponse>(ADMIN, { params });
  },

  /**
   * GET /api/admin/contacts/{id}
   * D√©tail avec bourses associ√©es
   */
  getById: (id: string): Promise<ContactRequest> => {
    return api.get<ContactRequest>(`${ADMIN}/${id}`);
  },

  /**
   * PATCH /api/admin/contacts/{id}
   * Marquer lu, ajouter notes
   */
  patch: (id: string, payload: UpdateContactPayload): Promise<ContactRequest> => {
    return api.patch<ContactRequest>(`${ADMIN}/${id}`, payload);
  },

  /**
   * DELETE /api/admin/contacts/{id}
   * Supprimer une demande
   */
  delete: (id: string): Promise<void> => {
    return api.delete<void>(`${ADMIN}/${id}`);
  },
};
// END OF FILE: src/repositories/contact.repository.ts

// FILE: src/repositories/events.repository.ts
-----------------------------------------------

// src/repositories/events.repository.ts
// ==============================================================================
//  Tracking silencieux des √©v√©nements visiteurs (c√¥t√© client uniquement)
// ==============================================================================
import { api as apiClient } from "@/lib/api-client";
import type { VisitorEventPayload } from "@/types/api/kpi.types";

const TRACKING_ENABLED = process.env.NEXT_PUBLIC_ENABLE_TRACKING === "true";

export const eventsRepository = {
  /**
   * POST /api/evenements ‚Äî enregistrer un √©v√©nement visiteur
   * Silencieux : ne throw jamais (√©chec ignor√© pour ne pas impacter l'UX)
   */
  track: async (payload: VisitorEventPayload): Promise<void> => {
    if (!TRACKING_ENABLED) return;
    try {
      await apiClient.post("/evenements", payload);
    } catch {
      // Tracking silencieux ‚Äî on n'impacte jamais l'UX en cas d'erreur
    }
  },

  /** Raccourcis pour les √©v√©nements les plus fr√©quents */
  trackPageView: (page: string) =>
    eventsRepository.track({ type: "PAGE_VIEW", page }),

  trackScholarshipView: (bourseId: string, page?: string) =>
    eventsRepository.track({ type: "BOURSE_VUE", bourse_id: bourseId, page }),

  trackContactSubmit: (bourseId?: string) =>
    eventsRepository.track({ type: "CONTACT_SOUMIS", bourse_id: bourseId }),

  trackNewsletterSignup: () =>
    eventsRepository.track({ type: "NEWSLETTER_INSCRIPTION" }),

  trackWhatsappClick: (bourseId?: string) =>
    eventsRepository.track({ type: "WHATSAPP_CLIC", bourse_id: bourseId }),

  trackChatbotOpen: () =>
    eventsRepository.track({ type: "CHATBOT_OUVERT" }),

  trackAppointmentSubmit: () =>
    eventsRepository.track({ type: "RENDEZ_VOUS_SOUMIS" }),
};
// END OF FILE: src/repositories/events.repository.ts

// FILE: src/repositories/index.ts
-----------------------------------------------
// src/repositories/index.ts
// ==============================================================================
//  Barrel export ‚Äî tous les repositories SALMA
//  Usage : import { scholarshipAdminRepository, authRepository } from "@/repositories"
// ==============================================================================

// --- Auth --------------------------------------------------------------------
export { authRepository } from "./auth.repository";

// --- Bourses -----------------------------------------------------------------
export { scholarshipPublicRepository, scholarshipAdminRepository } from "./scholarship.repository";

// --- M√©dias ------------------------------------------------------------------
export { mediaRepository } from "./media.repository";

// --- CMS (Pages, Blocs, Config, Vid√©os) -------------------------------------
export { cmsPublicRepository, cmsAdminRepository } from "./cms.repository";

// --- Contact -----------------------------------------------------------------
export { contactPublicRepository, contactAdminRepository } from "./contact.repository";

// --- Newsletter & Annonces ---------------------------------------------------
export { newsletterRepository } from "./newsletter.repository";

// --- T√©moignages -------------------------------------------------------------
export { testimonialPublicRepository, testimonialAdminRepository } from "./testimonial.repository";

// --- Chatbot -----------------------------------------------------------------
export { chatbotRepository } from "./chatbot.repository";

// --- Services ----------------------------------------------------------------
export { serviceRepository } from "./service.repository";

// --- KPI & Analytics ---------------------------------------------------------
export { kpiRepository } from "./kpi.repository";

// --- Tracking visiteurs ------------------------------------------------------
export { eventsRepository } from "./events.repository";
// END OF FILE: src/repositories/index.ts

// FILE: src/repositories/kpi.repository.ts
-----------------------------------------------

// src/repositories/kpi.repository.ts
// ==============================================================================
import { api as apiClient } from "@/lib/api-client";
import type {
  KpiSnapshot,
  KpiRealtime,
  ConversionRate,
  VisitorEvent,
  EventFilters,
  KpiSnapshotFilters,
} from "@/types/api/kpi.types";
import type { PaginatedResponse } from "@/types";

export const kpiRepository = {
  /** GET /api/admin/kpi/snapshots */
  adminGetSnapshots: (filters?: KpiSnapshotFilters): Promise<KpiSnapshot[]> => {
    const params: Record<string, string> = {};
    if (filters?.date_debut) params.date_debut = filters.date_debut;
    if (filters?.date_fin) params.date_fin = filters.date_fin;
    if (filters?.periode) params.periode = filters.periode;
    return apiClient.get("/admin/kpi/snapshots", { params });
  },

  /** GET /api/admin/kpi/snapshots/{date} */
  adminGetSnapshotByDate: (date: string): Promise<KpiSnapshot> =>
    apiClient.get(`/admin/kpi/snapshots/${date}`),

  /** GET /api/admin/kpi/temps-reel */
  adminGetRealtime: (): Promise<KpiRealtime> =>
    apiClient.get("/admin/kpi/temps-reel"),

  /** GET /api/admin/kpi/conversion */
  adminGetConversion: (): Promise<ConversionRate> =>
    apiClient.get("/admin/kpi/conversion"),

  /** GET /api/admin/kpi/evenements */
  adminGetEvents: (filters?: EventFilters): Promise<PaginatedResponse<VisitorEvent>> => {
    const params: Record<string, string> = {};
    if (filters?.type) params.type = filters.type;
    if (filters?.page) params.page = filters.page;
    if (filters?.bourse_id) params.bourse_id = filters.bourse_id;
    if (filters?.date_debut) params.date_debut = filters.date_debut;
    if (filters?.date_fin) params.date_fin = filters.date_fin;
    return apiClient.get("/admin/kpi/evenements", { params });
  },
};


// END OF FILE: src/repositories/kpi.repository.ts

// FILE: src/repositories/media.repository.ts
-----------------------------------------------
// src/repositories/media.repository.ts
// ==============================================================================
//  Repository ‚Äî M√©dias (Biblioth√®que de fichiers)
//  5 endpoints admin uniquement
// ==============================================================================

import { api } from "@/lib/api-client";
import type {
  MediaAsset,
  UploadMediaPayload,
  UpdateMediaPayload,
  PaginatedMediaResponse,
  MediaFilters,
} from "@/types/api/media.types";

const ADMIN = "/admin/medias";

export const mediaRepository = {
  /**
   * GET /api/admin/medias
   * Biblioth√®que de fichiers
   */
  getList: (filters?: MediaFilters): Promise<PaginatedMediaResponse> => {
    const params: Record<string, string> = {};
    if (filters?.type_mime) params.type_mime = filters.type_mime;
    if (filters?.search) params.search = filters.search;
    if (filters?.page) params.page = String(filters.page);
    if (filters?.page_size) params.page_size = String(filters.page_size);
    if (filters?.ordering) params.ordering = filters.ordering;

    return api.get<PaginatedMediaResponse>(ADMIN, { params });
  },

  /**
   * GET /api/admin/medias/{id}
   * D√©tail d'un fichier
   */
  getById: (id: string): Promise<MediaAsset> => {
    return api.get<MediaAsset>(`${ADMIN}/${id}`);
  },

  /**
   * POST /api/admin/medias
   * Uploader un fichier (multipart/form-data)
   */
  upload: (payload: UploadMediaPayload): Promise<MediaAsset> => {
    const formData = new FormData();
    formData.append("fichier", payload.fichier);
    if (payload.nom_fichier) formData.append("nom_fichier", payload.nom_fichier);
    if (payload.texte_alt_fr) formData.append("texte_alt_fr", payload.texte_alt_fr);
    if (payload.texte_alt_en) formData.append("texte_alt_en", payload.texte_alt_en);

    return api.upload<MediaAsset>(ADMIN, formData);
  },

  /**
   * PATCH /api/admin/medias/{id}
   * Modifier les m√©tadonn√©es (nom, texte alt)
   */
  update: (id: string, payload: UpdateMediaPayload): Promise<MediaAsset> => {
    return api.patch<MediaAsset>(`${ADMIN}/${id}`, payload);
  },

  /**
   * DELETE /api/admin/medias/{id}
   * Supprimer un fichier
   */
  delete: (id: string): Promise<void> => {
    return api.delete<void>(`${ADMIN}/${id}`);
  },
};
// END OF FILE: src/repositories/media.repository.ts

// FILE: src/repositories/newsletter.repository.ts
-----------------------------------------------
// src/repositories/newsletter.repository.ts
// ==============================================================================
//  Repository ‚Äî Newsletter & Annonces
//  12 endpoints : 2 publics + 10 admin
// ==============================================================================

import { api } from "@/lib/api-client";
import type {
  NewsletterSubscriber,
  NewsletterInscriptionPayload,
  NewsletterDesinscriptionPayload,
  Announcement,
  CreateAnnouncementPayload,
  UpdateAnnouncementPayload,
  SendAnnouncementResponse,
  PaginatedSubscriberResponse,
  PaginatedAnnouncementResponse,
  SubscriberFilters,
  AnnouncementFilters,
} from "@/types/api/newsletter.types";

// ==============================================================================
//  Endpoints PUBLICS (vitrine)
// ==============================================================================

export const newsletterRepository = {
  /**
   * POST /api/newsletter/inscription
   * S'inscrire √† la newsletter
   */
  subscribe: (payload: NewsletterInscriptionPayload): Promise<{ detail: string }> => {
    return api.post<{ detail: string }>("/newsletter/inscription", payload);
  },

  /**
   * POST /api/newsletter/desinscription
   * Se d√©sinscrire
   */
  unsubscribe: (payload: NewsletterDesinscriptionPayload): Promise<{ detail: string }> => {
    return api.post<{ detail: string }>("/newsletter/desinscription", payload);
  },

  // ==============================================================================
  //  Admin ‚Äî Abonn√©s
  // ==============================================================================

  /**
   * GET /api/admin/newsletter/abonnes
   * Liste des abonn√©s (filtres : actif, pays, niveau)
   */
  adminGetSubscribers: (filters?: SubscriberFilters): Promise<PaginatedSubscriberResponse> => {
    const params: Record<string, string> = {};
    if (filters?.est_actif !== undefined) params.est_actif = String(filters.est_actif);
    if (filters?.pays) params.pays = filters.pays;
    if (filters?.niveau_etudes) params.niveau_etudes = filters.niveau_etudes;
    if (filters?.destination_souhaitee) params.destination_souhaitee = filters.destination_souhaitee;
    if (filters?.search) params.search = filters.search;
    if (filters?.page) params.page = String(filters.page);
    if (filters?.page_size) params.page_size = String(filters.page_size);
    if (filters?.ordering) params.ordering = filters.ordering;

    return api.get<PaginatedSubscriberResponse>("/admin/newsletter/abonnes", { params });
  },

  /**
   * GET /api/admin/newsletter/abonnes/{id}
   * D√©tail d'un abonn√©
   */
  adminGetSubscriberById: (id: string): Promise<NewsletterSubscriber> => {
    return api.get<NewsletterSubscriber>(`/admin/newsletter/abonnes/${id}`);
  },

  /**
   * DELETE /api/admin/newsletter/abonnes/{id}
   * Supprimer un abonn√©
   */
  adminDeleteSubscriber: (id: string): Promise<void> => {
    return api.delete<void>(`/admin/newsletter/abonnes/${id}`);
  },

  // ==============================================================================
  //  Admin ‚Äî Annonces
  // ==============================================================================

  /**
   * GET /api/admin/annonces
   * Liste des annonces
   */
  adminGetAnnouncements: (filters?: AnnouncementFilters): Promise<PaginatedAnnouncementResponse> => {
    const params: Record<string, string> = {};
    if (filters?.statut) params.statut = filters.statut;
    if (filters?.search) params.search = filters.search;
    if (filters?.page) params.page = String(filters.page);
    if (filters?.page_size) params.page_size = String(filters.page_size);
    if (filters?.ordering) params.ordering = filters.ordering;

    return api.get<PaginatedAnnouncementResponse>("/admin/annonces", { params });
  },

  /**
   * GET /api/admin/annonces/{id}
   * D√©tail avec bourses li√©es
   */
  adminGetAnnouncementById: (id: string): Promise<Announcement> => {
    return api.get<Announcement>(`/admin/annonces/${id}`);
  },

  /**
   * POST /api/admin/annonces
   * Cr√©er une annonce (brouillon)
   */
  adminCreateAnnouncement: (payload: CreateAnnouncementPayload): Promise<Announcement> => {
    return api.post<Announcement>("/admin/annonces", payload);
  },

  /**
   * PUT /api/admin/annonces/{id}
   * Modifier compl√®tement
   */
  adminUpdateAnnouncement: (id: string, payload: CreateAnnouncementPayload): Promise<Announcement> => {
    return api.put<Announcement>(`/admin/annonces/${id}`, payload);
  },

  /**
   * PATCH /api/admin/annonces/{id}
   * Modifier partiellement
   */
  adminPatchAnnouncement: (id: string, payload: UpdateAnnouncementPayload): Promise<Announcement> => {
    return api.patch<Announcement>(`/admin/annonces/${id}`, payload);
  },

  /**
   * DELETE /api/admin/annonces/{id}
   * Supprimer
   */
  adminDeleteAnnouncement: (id: string): Promise<void> => {
    return api.delete<void>(`/admin/annonces/${id}`);
  },

  /**
   * POST /api/admin/annonces/{id}/envoyer
   * Envoyer √† tous les abonn√©s actifs (simul√©)
   */
  adminSendAnnouncement: (id: string): Promise<SendAnnouncementResponse> => {
    return api.post<SendAnnouncementResponse>(`/admin/annonces/${id}/envoyer`, {});
  },
};
// END OF FILE: src/repositories/newsletter.repository.ts

// FILE: src/repositories/scholarship.repository.ts
-----------------------------------------------
// src/repositories/scholarship.repository.ts
// ==============================================================================
//  Repository ‚Äî Bourses
//  25 endpoints : 3 publics + 22 admin
// ==============================================================================

import { api } from "@/lib/api-client";
import type {
  ScholarshipPublicListItem,
  ScholarshipPublicDetail,
  ScholarshipAdmin,
  ScholarshipListResponse,
  ScholarshipAdminListResponse,
  ScholarshipFilters,
  CreateScholarshipPayload,
  UpdateScholarshipPayload,
  UpdateFieldVisibilityPayload,
  AddScholarshipImagePayload,
  ScholarshipField,
  ScholarshipBenefit,
  ScholarshipEligibility,
  ScholarshipImage
} from "@/types/api/scholarship.types";

const PUBLIC = "/bourses";
const ADMIN = "/admin/bourses";

// ==============================================================================
//  Endpoints PUBLICS (vitrine)
// ==============================================================================

export const scholarshipPublicRepository = {
  /**
   * GET /api/bourses
   * Liste pagin√©e des bourses publi√©es (infos minimales pour le catalogue)
   */
  getList: (filters?: ScholarshipFilters): Promise<ScholarshipListResponse> => {
    const params: Record<string, string> = {};
    if (filters?.pays_destination) params.pays_destination = filters.pays_destination;
    if (filters?.niveau) params.niveau = filters.niveau;
    if (filters?.type_couverture) params.type_couverture = filters.type_couverture;
    if (filters?.est_mise_en_avant !== undefined) params.est_mise_en_avant = String(filters.est_mise_en_avant);
    if (filters?.search) params.search = filters.search;
    if (filters?.page) params.page = String(filters.page);
    if (filters?.page_size) params.page_size = String(filters.page_size);
    if (filters?.ordering) params.ordering = filters.ordering;

    return api.get<ScholarshipListResponse>(PUBLIC, {
      params,
      revalidate: 60, // ISR : revalide toutes les 60 secondes
    });
  },

  /**
   * GET /api/bourses/{id}
   * D√©tail public avec field_visibility appliqu√©
   */
  getById: (id: string): Promise<ScholarshipPublicDetail> => {
    return api.get<ScholarshipPublicDetail>(`${PUBLIC}/${id}`, {
      revalidate: 60,
    });
  },

  /**
   * GET /api/bourses/vedette
   * Bourses mises en avant (pour la home page)
   */
  getFeatured: (): Promise<ScholarshipPublicListItem[]> => {
    return api.get<ScholarshipPublicListItem[]>(`${PUBLIC}/mise-en-avant`, {
      revalidate: 60,
    });
  },
};

// ==============================================================================
//  Endpoints ADMIN (dashboard)
// ==============================================================================

export const scholarshipAdminRepository = {
  /**
   * GET /api/admin/bourses
   * Liste compl√®te (tous statuts, tous champs)
   */
  getList: (filters?: ScholarshipFilters): Promise<ScholarshipAdminListResponse> => {
    const params: Record<string, string> = {};
    if (filters?.pays_destination) params.pays_destination = filters.pays_destination;
    if (filters?.niveau) params.niveau = filters.niveau;
    if (filters?.statut) params.statut = filters.statut;
    if (filters?.search) params.search = filters.search;
    if (filters?.page) params.page = String(filters.page);
    if (filters?.ordering) params.ordering = filters.ordering;

    return api.get<ScholarshipAdminListResponse>(ADMIN, { params });
  },

  /**
   * GET /api/admin/bourses/{id}
   * D√©tail complet pour √©dition
   */
  getById: (id: string): Promise<ScholarshipAdmin> => {
    return api.get<ScholarshipAdmin>(`${ADMIN}/${id}`);
  },

  /**
   * POST /api/admin/bourses
   * Cr√©er une nouvelle bourse
   */
  create: (payload: CreateScholarshipPayload): Promise<ScholarshipAdmin> => {
    return api.post<ScholarshipAdmin>(ADMIN, payload);
  },

  /**
   * PUT /api/admin/bourses/{id}
   * Modifier compl√®tement une bourse
   */
  update: (id: string, payload: CreateScholarshipPayload): Promise<ScholarshipAdmin> => {
    return api.put<ScholarshipAdmin>(`${ADMIN}/${id}`, payload);
  },

  /**
   * PATCH /api/admin/bourses/{id}
   * Modifier partiellement (ex: juste le statut)
   */
  patch: (id: string, payload: UpdateScholarshipPayload): Promise<ScholarshipAdmin> => {
    return api.patch<ScholarshipAdmin>(`${ADMIN}/${id}`, payload);
  },

  /**
   * DELETE /api/admin/bourses/{id}
   */
  delete: (id: string): Promise<void> => {
    return api.delete<void>(`${ADMIN}/${id}`);
  },

  /**
   * POST /api/admin/bourses/{id}/dupliquer
   * Dupliquer une bourse (cr√©e un brouillon)
   */
  duplicate: (id: string): Promise<ScholarshipAdmin> => {
    return api.post<ScholarshipAdmin>(`${ADMIN}/${id}/dupliquer`, {});
  },

  // --- Visibilit√© des champs ------------------------------------------------

  /**
   * GET /api/admin/bourses/{id}/visibilites
   * R√©cup√©rer la visibilit√© de tous les champs
   */
  getVisibility: (id: string) => {
    return api.get<{ nom_du_champ: string; est_visible: boolean }[]>(
      `${ADMIN}/${id}/visibilites`
    );
  },

  /**
   * PATCH /api/admin/bourses/{id}/visibilites/{champId}
   * Modifier la visibilit√© d'un champ
   */
  updateFieldVisibility: (
    bourseId: string,
    champId: string,
    payload: UpdateFieldVisibilityPayload
  ) => {
    return api.patch(`${ADMIN}/${bourseId}/visibilites/${champId}`, payload);
  },

  /**
   * POST /api/admin/bourses/{id}/visibilites/bulk
   * Mettre √† jour plusieurs visibilit√©s d'un coup
   */
 bulkUpdateVisibility: (
  bourseId: string,
  visibilities: UpdateFieldVisibilityPayload[]
): Promise<void> => { // Ajoute le type de retour ici
  return api.post<void>(`${ADMIN}/${bourseId}/visibilites/bulk`, { visibilities: visibilities });
},

  // --- Images ---------------------------------------------------------------

  /**
   * GET /api/admin/bourses/{id}/images
   */
  getImages: (id: string) => {
    return api.get(`${ADMIN}/${id}/images`);
  },

  /**
   * POST /api/admin/bourses/{id}/images
   * Ajouter une image √† une bourse
   */
 // FIX : Typage ScholarshipImage au lieu de any
  addImage: (bourseId: string, payload: AddScholarshipImagePayload): Promise<ScholarshipImage> => {
    return api.post<ScholarshipImage>(`${ADMIN}/${bourseId}/images`, payload);
  },

  /**
   * DELETE /api/admin/bourses/{id}/images/{imgId}
   */
  removeImage: (bourseId: string, imgId: string): Promise<void> => {
    return api.delete(`${ADMIN}/${bourseId}/images/${imgId}`);
  },

  /**
   * PUT /api/admin/bourses/{id}/images/{imgId}/principale
   * D√©finir comme image principale
   */
  setMainImage: (bourseId: string, imgId: string) => {
    return api.put(`${ADMIN}/${bourseId}/images/${imgId}/principale`, {});
  },

  // --- Domaines, avantages, crit√®res ----------------------------------------

  /** Domaines d'√©tudes */
  getFields: (): Promise<ScholarshipField[]> =>
    api.get<ScholarshipField[]>("/admin/domaines"),
  createField: (payload: Omit<ScholarshipField, "id">): Promise<ScholarshipField> =>
    api.post<ScholarshipField>("/admin/domaines", payload),
  deleteField: (id: string): Promise<void> =>
    api.delete(`/admin/domaines/${id}`),

  /** Avantages */
  getBenefits: (): Promise<ScholarshipBenefit[]> =>
    api.get<ScholarshipBenefit[]>("/admin/avantages"),
  createBenefit: (payload: Omit<ScholarshipBenefit, "id">): Promise<ScholarshipBenefit> =>
    api.post<ScholarshipBenefit>("/admin/avantages", payload),
  deleteBenefit: (id: string): Promise<void> =>
    api.delete(`/admin/avantages/${id}`),

  /** Crit√®res d'√©ligibilit√© */
  getEligibilities: (): Promise<ScholarshipEligibility[]> =>
    api.get<ScholarshipEligibility[]>("/admin/criteres"),
  createEligibility: (payload: Omit<ScholarshipEligibility, "id">): Promise<ScholarshipEligibility> =>
    api.post<ScholarshipEligibility>("/admin/criteres", payload),
  deleteEligibility: (id: string): Promise<void> =>
    api.delete(`/admin/criteres/${id}`),
};
// END OF FILE: src/repositories/scholarship.repository.ts

// FILE: src/repositories/service.repository.ts
-----------------------------------------------
// src/repositories/service.repository.ts
// ==============================================================================
import { api as apiClient } from "@/lib/api-client";
import type { 
  ServicePublic, 
  ServiceAdmin, 
  CreateServicePayload, 
  UpdateServicePayload 
} from "@/types/api/service.types";

export const serviceRepository = {
  /** GET /api/services ‚Äî liste publique des services actifs */
  getPublicList: (): Promise<ServicePublic[]> =>
    apiClient.get<ServicePublic[]>("/services", { revalidate: 300 }),

  /** GET /api/services/{slug} */
  getPublicBySlug: (slug: string): Promise<ServicePublic> =>
    apiClient.get<ServicePublic>(`/services/${slug}`, { revalidate: 300 }),

  /** GET /api/admin/services */
  adminGetList: (): Promise<ServiceAdmin[]> =>
    apiClient.get<ServiceAdmin[]>("/admin/services"),

  /** GET /api/admin/services/{id} */
  adminGetById: (id: string): Promise<ServiceAdmin> =>
    apiClient.get<ServiceAdmin>(`/admin/services/${id}`),

  /** POST /api/admin/services */
  adminCreate: (payload: CreateServicePayload): Promise<ServiceAdmin> =>
    apiClient.post<ServiceAdmin>("/admin/services", payload),

  /** PUT /api/admin/services/{id} */
  adminUpdate: (id: string, payload: CreateServicePayload): Promise<ServiceAdmin> =>
    apiClient.put<ServiceAdmin>(`/admin/services/${id}`, payload),

  /** PATCH /api/admin/services/{id} */
  adminPatch: (id: string, payload: UpdateServicePayload): Promise<ServiceAdmin> =>
    apiClient.patch<ServiceAdmin>(`/admin/services/${id}`, payload),

  /** DELETE /api/admin/services/{id} */
  adminDelete: (id: string): Promise<void> =>
    apiClient.delete(`/admin/services/${id}`),
};
// END OF FILE: src/repositories/service.repository.ts

// FILE: src/repositories/testimonial.repository.ts
-----------------------------------------------
// src/repositories/testimonial.repository.ts
// ==============================================================================
//  Repository ‚Äî T√©moignages
//  8 endpoints : 2 publics + 6 admin
// ==============================================================================

import { api } from "@/lib/api-client";
import type {
  TestimonialPublic,
  TestimonialAdmin,
  SubmitTestimonialPayload,
  CreateTestimonialPayload,
  UpdateTestimonialPayload,
  PaginatedTestimonialResponse,
  TestimonialFilters,
} from "@/types/api/testimonial.types";

const PUBLIC = "/temoignages";
const ADMIN = "/admin/temoignages";

// ==============================================================================
//  Endpoints PUBLICS (vitrine)
// ==============================================================================

export const testimonialPublicRepository = {
  /**
   * GET /api/temoignages
   * Liste des t√©moignages approuv√©s et affich√©s
   */
  getList: (): Promise<TestimonialPublic[]> => {
    return api.get<TestimonialPublic[]>(PUBLIC, { revalidate: 300 });
  },

  /**
   * POST /api/temoignages
   * Soumettre un t√©moignage (formulaire site ou lien email)
   */
  submit: (payload: SubmitTestimonialPayload): Promise<{ detail: string }> => {
    return api.post<{ detail: string }>(PUBLIC, payload);
  },
};

// ==============================================================================
//  Endpoints ADMIN (dashboard)
// ==============================================================================

export const testimonialAdminRepository = {
  /**
   * GET /api/admin/temoignages
   * Liste compl√®te (approuv√©s + en attente)
   */
  getList: (filters?: TestimonialFilters): Promise<PaginatedTestimonialResponse> => {
    const params: Record<string, string> = {};
    if (filters?.est_approuve !== undefined) params.est_approuve = String(filters.est_approuve);
    if (filters?.est_affiche_sur_site !== undefined) params.est_affiche_sur_site = String(filters.est_affiche_sur_site);
    if (filters?.source) params.source = filters.source;
    if (filters?.search) params.search = filters.search;
    if (filters?.page) params.page = String(filters.page);
    if (filters?.page_size) params.page_size = String(filters.page_size);
    if (filters?.ordering) params.ordering = filters.ordering;

    return api.get<PaginatedTestimonialResponse>(ADMIN, { params });
  },

  /**
   * GET /api/admin/temoignages/{id}
   * D√©tail d'un t√©moignage
   */
  getById: (id: string): Promise<TestimonialAdmin> => {
    return api.get<TestimonialAdmin>(`${ADMIN}/${id}`);
  },

  /**
   * POST /api/admin/temoignages
   * Cr√©er manuellement (depuis WhatsApp/mail)
   */
  create: (payload: CreateTestimonialPayload): Promise<TestimonialAdmin> => {
    return api.post<TestimonialAdmin>(ADMIN, payload);
  },

  /**
   * PUT /api/admin/temoignages/{id}
   * Modifier compl√®tement
   */
  update: (id: string, payload: CreateTestimonialPayload): Promise<TestimonialAdmin> => {
    return api.put<TestimonialAdmin>(`${ADMIN}/${id}`, payload);
  },

  /**
   * PATCH /api/admin/temoignages/{id}
   * Modifier partiellement (ex: approuver)
   */
  patch: (id: string, payload: UpdateTestimonialPayload): Promise<TestimonialAdmin> => {
    return api.patch<TestimonialAdmin>(`${ADMIN}/${id}`, payload);
  },

  /**
   * DELETE /api/admin/temoignages/{id}
   */
  delete: (id: string): Promise<void> => {
    return api.delete<void>(`${ADMIN}/${id}`);
  },
};
// END OF FILE: src/repositories/testimonial.repository.ts

// FILE: src/sections/visitor/ContactForm.tsx
-----------------------------------------------
// src/sections/visitor/ContactForm.tsx
// ==============================================================================
//  Formulaire de Contact ‚Äî envoi r√©el vers POST /api/contact
//  Validation c√¥t√© client, tracking CONTACT_SOUMIS, √©tat success
// ==============================================================================
"use client";

import { useState } from "react";
import { useLanguage } from "@/hooks/useLanguage";
import { contactDictionary } from "@/dictionaries/data/contact.data-dictionary";
import { eventsRepository } from "@/repositories/events.repository";
import SalmaButton from "@/components/ui/SalmaButton";
import type { CreateContactPayload } from "@/types/api/contact.types";

// --- Validation simple (pas besoin de Zod en d√©pendance externe) -------------

interface FormErrors {
  nom_complet?: string;
  email?: string;
  message?: string;
}

function validateForm(
  data: CreateContactPayload,
  locale: "fr" | "en"
): FormErrors {
  const errors: FormErrors = {};
  const t = locale === "fr"
    ? { required: "Ce champ est requis", emailInvalid: "Email invalide", messageTooShort: "Message trop court (min. 10 caract√®res)" }
    : { required: "This field is required", emailInvalid: "Invalid email", messageTooShort: "Message too short (min. 10 characters)" };

  if (!data.nom_complet.trim()) errors.nom_complet = t.required;
  if (!data.email.trim()) {
    errors.email = t.required;
  } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(data.email)) {
    errors.email = t.emailInvalid;
  }
  if (!data.message.trim()) {
    errors.message = t.required;
  } else if (data.message.trim().length < 10) {
    errors.message = t.messageTooShort;
  }

  return errors;
}

// --- Composant ---------------------------------------------------------------

type FormStatus = "idle" | "submitting" | "success" | "error";

export default function ContactForm() {
  const { dictionary, locale } = useLanguage();

  const [formData, setFormData] = useState<CreateContactPayload>({
    nom_complet: "",
    email: "",
    telephone: "",
    whatsapp: "",
    message: "",
    accepte_newsletter: false,
  });
  const [errors, setErrors] = useState<FormErrors>({});
  const [status, setStatus] = useState<FormStatus>("idle");
  const [errorMessage, setErrorMessage] = useState("");

  const handleChange = (
    e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>
  ) => {
    const { name, value, type } = e.target;
    const checked = type === "checkbox" ? (e.target as HTMLInputElement).checked : undefined;
    setFormData((prev) => ({
      ...prev,
      [name]: type === "checkbox" ? checked : value,
    }));
    // Effacer l'erreur de ce champ
    if (errors[name as keyof FormErrors]) {
      setErrors((prev) => ({ ...prev, [name]: undefined }));
    }
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    // Validation
    const validationErrors = validateForm(formData, locale);
    if (Object.keys(validationErrors).length > 0) {
      setErrors(validationErrors);
      return;
    }

    setStatus("submitting");
    setErrors({});
    setErrorMessage("");

    try {
      await contactDictionary.submit(formData);

      // Tracking silencieux
      eventsRepository.trackContactSubmit();

      setStatus("success");
      // Reset form
      setFormData({
        nom_complet: "",
        email: "",
        telephone: "",
        whatsapp: "",
        message: "",
        accepte_newsletter: false,
      });
    } catch (err: unknown) {
      setStatus("error");
      const msg = err instanceof Error ? err.message : "";
      setErrorMessage(
        msg || (locale === "fr"
          ? "Une erreur est survenue. Veuillez r√©essayer."
          : "An error occurred. Please try again.")
      );
    }
  };

  // Labels i18n
  const t = {
    title: dictionary.contact.title,
    subtitle: dictionary.contact.subtitle,
    name: dictionary.contact.form.name,
    email: dictionary.contact.form.email,
    phone: dictionary.contact.form.phone,
    message: dictionary.contact.form.message,
    send: dictionary.contact.form.send,
    success: dictionary.contact.form.success,
    address: dictionary.contact.info.address,
    emailInfo: dictionary.contact.info.email,
    newsletter: locale === "fr"
      ? "Je souhaite recevoir les offres de bourses par email"
      : "I want to receive scholarship offers by email",
    whatsapp: locale === "fr" ? "Num√©ro WhatsApp" : "WhatsApp number",
    errorGeneric: locale === "fr"
      ? "Une erreur est survenue"
      : "An error occurred",
    sendAnother: locale === "fr"
      ? "Envoyer une autre demande"
      : "Send another request",
    successTitle: locale === "fr"
      ? "Demande envoy√©e !"
      : "Request sent!",
    successDesc: locale === "fr"
      ? "Notre √©quipe vous contactera dans les 24h. V√©rifiez aussi votre WhatsApp !"
      : "Our team will contact you within 24h. Also check your WhatsApp!",
  };

  // Input style helper
  const inputClass = (field?: string) =>
    `w-full p-4 rounded-xl bg-salma-bg border outline-none transition-all text-sm text-salma-text placeholder:text-salma-text-muted/60 ${
      field && errors[field as keyof FormErrors]
        ? "border-red-400 focus:border-red-500"
        : "border-salma-border focus:border-salma-gold"
    }`;

  return (
    <section id="contact" className="py-24 bg-white dark:bg-salma-bg">
      <div className="container mx-auto px-6">
        <div className="max-w-5xl mx-auto bg-salma-surface border border-salma-border rounded-[2rem] overflow-hidden shadow-salma-lg grid grid-cols-1 md:grid-cols-2">

          {/* ‚îÄ‚îÄ Infos de contact ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */}
          <div className="p-10 md:p-12 bg-salma-primary text-white flex flex-col justify-between">
            <div>
              <h2 className="text-3xl font-serif font-bold mb-4">{t.title}</h2>
              <p className="text-salma-gold-light text-sm mb-10">{t.subtitle}</p>

              <div className="space-y-5">
                <div className="flex gap-4 items-start">
                  <span className="text-salma-gold text-lg mt-0.5">üìç</span>
                  <p className="text-sm leading-relaxed">{t.address}</p>
                </div>
                <div className="flex gap-4 items-start">
                  <span className="text-salma-gold text-lg mt-0.5">‚úâÔ∏è</span>
                  <p className="text-sm">{t.emailInfo}</p>
                </div>
                <div className="flex gap-4 items-start">
                  <span className="text-salma-gold text-lg mt-0.5">üìû</span>
                  <p className="text-sm">+237 6 99 45 09 84 / 6 51 74 03 28</p>
                </div>
              </div>
            </div>

            <div className="mt-10 pt-6 border-t border-white/10">
              <p className="text-[10px] uppercase tracking-widest opacity-50">
                AG Technologies Group
              </p>
            </div>
          </div>

          {/* ‚îÄ‚îÄ Formulaire ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */}
          <div className="p-10 md:p-12">

            {/* √âtat succ√®s */}
            {status === "success" ? (
              <div className="flex flex-col items-center justify-center h-full text-center gap-4 py-8">
                <div className="w-16 h-16 rounded-full bg-emerald-100 flex items-center justify-center">
                  <svg className="w-8 h-8 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                  </svg>
                </div>
                <h3 className="text-xl font-serif font-bold text-salma-primary">
                  {t.successTitle}
                </h3>
                <p className="text-sm text-salma-text-muted max-w-xs">
                  {t.successDesc}
                </p>
                <button
                  onClick={() => setStatus("idle")}
                  className="mt-4 text-sm font-semibold text-salma-gold hover:text-salma-gold-dark transition-colors underline underline-offset-4"
                >
                  {t.sendAnother}
                </button>
              </div>
            ) : (
              <form onSubmit={handleSubmit} className="space-y-4" noValidate>
                {/* Nom */}
                <div>
                  <input
                    type="text"
                    name="nom_complet"
                    value={formData.nom_complet}
                    onChange={handleChange}
                    placeholder={t.name}
                    className={inputClass("nom_complet")}
                  />
                  {errors.nom_complet && (
                    <p className="mt-1 text-xs text-red-500">{errors.nom_complet}</p>
                  )}
                </div>

                {/* Email */}
                <div>
                  <input
                    type="email"
                    name="email"
                    value={formData.email}
                    onChange={handleChange}
                    placeholder={t.email}
                    className={inputClass("email")}
                  />
                  {errors.email && (
                    <p className="mt-1 text-xs text-red-500">{errors.email}</p>
                  )}
                </div>

                {/* T√©l√©phone + WhatsApp c√¥te √† c√¥te */}
                <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                  <input
                    type="tel"
                    name="telephone"
                    value={formData.telephone}
                    onChange={handleChange}
                    placeholder={t.phone}
                    className={inputClass()}
                  />
                  <input
                    type="tel"
                    name="whatsapp"
                    value={formData.whatsapp}
                    onChange={handleChange}
                    placeholder={t.whatsapp}
                    className={inputClass()}
                  />
                </div>

                {/* Message */}
                <div>
                  <textarea
                    name="message"
                    value={formData.message}
                    onChange={handleChange}
                    placeholder={t.message}
                    rows={4}
                    className={inputClass("message")}
                  />
                  {errors.message && (
                    <p className="mt-1 text-xs text-red-500">{errors.message}</p>
                  )}
                </div>

                {/* Checkbox newsletter */}
                <label className="flex items-start gap-3 cursor-pointer group">
                  <input
                    type="checkbox"
                    name="accepte_newsletter"
                    checked={formData.accepte_newsletter}
                    onChange={handleChange}
                    className="mt-0.5 w-4 h-4 rounded border-salma-border text-salma-gold focus:ring-salma-gold accent-salma-gold"
                  />
                  <span className="text-xs text-salma-text-muted group-hover:text-salma-text transition-colors leading-relaxed">
                    {t.newsletter}
                  </span>
                </label>

                {/* Erreur serveur */}
                {status === "error" && (
                  <div className="p-3 rounded-lg bg-red-50 border border-red-200 text-sm text-red-600">
                    {errorMessage || t.errorGeneric}
                  </div>
                )}

                {/* Bouton submit */}
                <SalmaButton
                  type="submit"
                  variant="primary"
                  className="w-full py-4 shadow-xl"
                  disabled={status === "submitting"}
                >
                  {status === "submitting" ? (
                    <span className="flex items-center gap-2">
                      <svg className="animate-spin w-4 h-4" fill="none" viewBox="0 0 24 24">
                        <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" />
                        <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z" />
                      </svg>
                      {locale === "fr" ? "Envoi en cours..." : "Sending..."}
                    </span>
                  ) : (
                    t.send
                  )}
                </SalmaButton>
              </form>
            )}
          </div>

        </div>
      </div>
    </section>
  );
}

// END OF FILE: src/sections/visitor/ContactForm.tsx

// FILE: src/sections/visitor/FeaturedScholarships.tsx
-----------------------------------------------
// src/sections/visitor/FeaturedScholarships.tsx
// ==============================================================================
//  Section Bourses Vedette ‚Äî re√ßoit les donn√©es r√©elles en props (Server Component)
//  Fallback propre si aucune bourse disponible
// ==============================================================================
"use client";

import Link from "next/link";
import Image from "next/image";
import { useLanguage } from "@/hooks/useLanguage";
import SectionTitle from "@/components/ui/SectionTitle";
import SalmaButton from "@/components/ui/SalmaButton";
import { getMediaUrl } from "@/lib/api-client";
import type { ScholarshipPublicListItem } from "@/types/api/scholarship.types";

interface Props {
  scholarships: ScholarshipPublicListItem[];
}

// Labels d'affichage pour les √©num√©rations Django
const LEVEL_LABELS: Record<string, string> = {
  licence: "Licence",
  master: "Master",
  doctorat: "Doctorat",
  postdoc: "Post-Doc",
  formation: "Formation",
  autre: "Autre",
};

const COVERAGE_LABELS: Record<string, { fr: string; color: string }> = {
  complete:   { fr: "Bourse compl√®te",  color: "bg-emerald-50 text-emerald-700 border-emerald-200" },
  partielle:  { fr: "Partielle",        color: "bg-blue-50 text-blue-700 border-blue-200" },
  logement:   { fr: "Logement inclus",  color: "bg-purple-50 text-purple-700 border-purple-200" },
  transport:  { fr: "Transport",        color: "bg-orange-50 text-orange-700 border-orange-200" },
  autre:      { fr: "Aide financi√®re",  color: "bg-gray-50 text-gray-700 border-gray-200" },
};

const COUNTRY_FLAGS: Record<string, string> = {
  chine:     "üá®üá≥",
  allemagne: "üá©üá™",
  france:    "üá´üá∑",
  canada:    "üá®üá¶",
  autre:     "üåç",
};

function ScholarshipCard({ scholarship, locale }: { scholarship: ScholarshipPublicListItem; locale: "fr" | "en" }) {
  const title = locale === "fr" ? scholarship.titre_fr : scholarship.titre_en;
  const org   = locale === "fr" ? scholarship.organisme_fr : scholarship.organisme_en;
  const imageUrl = getMediaUrl(scholarship.image_principale?.url_fichier);
  const coverage = COVERAGE_LABELS[scholarship.type_couverture] ?? COVERAGE_LABELS.autre;
  const flag = COUNTRY_FLAGS[scholarship.pays_destination] ?? "üåç";

  const deadlineDate = scholarship.date_limite
    ? new Date(scholarship.date_limite).toLocaleDateString("fr-FR", { day: "2-digit", month: "short", year: "numeric" })
    : null;

  const isUrgent = scholarship.date_limite
    ? new Date(scholarship.date_limite).getTime() - Date.now() < 30 * 24 * 60 * 60 * 1000
    : false;

  return (
    <Link
      href={`/bourses/${scholarship.id}`}
      className="group flex flex-col bg-white border border-salma-border rounded-2xl overflow-hidden shadow-sm hover:shadow-salma-lg transition-all duration-300 hover:-translate-y-1"
    >
      {/* Image */}
      <div className="relative h-44 bg-salma-surface overflow-hidden">
        {imageUrl ? (
          <Image
            src={imageUrl}
            alt={title}
            fill
            className="object-cover group-hover:scale-105 transition-transform duration-500"
          />
        ) : (
          <div className="absolute inset-0 flex items-center justify-center bg-gradient-to-br from-salma-primary/10 to-salma-gold/10">
            <span className="text-5xl">{flag}</span>
          </div>
        )}
        {/* Badge urgent */}
        {isUrgent && (
          <div className="absolute top-3 left-3">
            <span className="px-2.5 py-1 bg-red-500 text-white text-[10px] font-bold uppercase tracking-widest rounded-full shadow">
              Urgent
            </span>
          </div>
        )}
        {/* Badge vedette */}
        {scholarship.est_mise_en_avant && (
          <div className="absolute top-3 right-3">
            <span className="px-2.5 py-1 bg-salma-gold text-white text-[10px] font-bold uppercase tracking-widest rounded-full shadow">
              ‚≠ê Vedette
            </span>
          </div>
        )}
      </div>

      {/* Contenu */}
      <div className="flex flex-col flex-1 p-5 gap-3">
        {/* Pays + Niveau */}
        <div className="flex items-center gap-2">
          <span className="text-xs font-semibold text-salma-text-muted flex items-center gap-1">
            {flag} {scholarship.pays_destination.charAt(0).toUpperCase() + scholarship.pays_destination.slice(1)}
          </span>
          <span className="text-salma-border">¬∑</span>
          <span className="text-xs font-semibold text-salma-text-muted">
            {LEVEL_LABELS[scholarship.niveau] ?? scholarship.niveau}
          </span>
        </div>

        {/* Titre */}
        <h3 className="text-sm font-bold text-salma-primary leading-snug group-hover:text-salma-gold transition-colors line-clamp-2">
          {title}
        </h3>

        {/* Organisme */}
        <p className="text-xs text-salma-text-muted truncate">{org}</p>

        {/* Domaines */}
        {scholarship.domaines.length > 0 && (
          <div className="flex flex-wrap gap-1.5">
            {scholarship.domaines.slice(0, 3).map((d) => (
              <span key={d.id} className="px-2 py-0.5 bg-salma-bg border border-salma-border rounded-full text-[10px] font-medium text-salma-text-muted">
                {locale === "fr" ? d.nom_fr : d.nom_en}
              </span>
            ))}
          </div>
        )}

        {/* Footer de la carte */}
        <div className="mt-auto pt-3 border-t border-salma-border flex items-center justify-between">
          {/* Badge couverture */}
          <span className={`px-2.5 py-1 text-[10px] font-semibold rounded-full border ${coverage.color}`}>
            {coverage.fr}
          </span>
          {/* Date limite */}
          {deadlineDate && (
            <span className={`text-[10px] font-medium ${isUrgent ? "text-red-500 font-bold" : "text-salma-text-muted"}`}>
              {isUrgent ? "‚ö† " : ""}Limite : {deadlineDate}
            </span>
          )}
        </div>
      </div>
    </Link>
  );
}

// Carte squelette pendant le chargement
function SkeletonCard() {
  return (
    <div className="flex flex-col bg-white border border-salma-border rounded-2xl overflow-hidden animate-pulse">
      <div className="h-44 bg-salma-surface" />
      <div className="p-5 space-y-3">
        <div className="h-3 bg-salma-surface rounded w-1/3" />
        <div className="h-4 bg-salma-surface rounded w-4/5" />
        <div className="h-3 bg-salma-surface rounded w-2/3" />
        <div className="h-8 bg-salma-surface rounded-full w-1/2 mt-auto" />
      </div>
    </div>
  );
}

export default function FeaturedScholarships({ scholarships }: Props) {
  const { dictionary, locale } = useLanguage();

  return (
    <section className="py-24 bg-white dark:bg-salma-bg">
      <div className="container mx-auto px-6">

        <div className="flex flex-col md:flex-row md:items-end justify-between gap-6 mb-12">
          <SectionTitle
            title={dictionary.featuredScholarships.title}
            subtitle={dictionary.featuredScholarships.subtitle}
            align="left"
          />
          <Link href="/bourses">
            <SalmaButton variant="outline" className="hidden md:flex">
              {dictionary.featuredScholarships.viewAll}
            </SalmaButton>
          </Link>
        </div>

        {/* √âtat vide */}
        {scholarships.length === 0 ? (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <SkeletonCard />
            <SkeletonCard />
            <SkeletonCard />
          </div>
        ) : (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {scholarships.slice(0, 3).map((s) => (
              <ScholarshipCard key={s.id} scholarship={s} locale={locale} />
            ))}
          </div>
        )}

        <div className="mt-12 flex justify-center md:hidden">
          <Link href="/bourses" className="w-full">
            <SalmaButton variant="outline" className="w-full">
              {dictionary.featuredScholarships.viewAll}
            </SalmaButton>
          </Link>
        </div>
      </div>
    </section>
  );
}

// END OF FILE: src/sections/visitor/FeaturedScholarships.tsx

// FILE: src/sections/visitor/Hero.tsx
-----------------------------------------------
"use client";

import Image from "next/image";
import { useLanguage } from "@/hooks/useLanguage";
import SalmaButton from "@/components/ui/SalmaButton";

export default function Hero() {
  const { dictionary } = useLanguage();

  return (
    <section className="relative min-h-[85vh] flex items-center overflow-hidden bg-white dark:bg-salma-bg">
      <div className="absolute top-0 right-0 -translate-y-1/2 translate-x-1/4 w-[600px] h-[600px] bg-salma-accent/5 rounded-full blur-3xl" />

      <div className="container mx-auto px-6 grid grid-cols-1 lg:grid-cols-2 gap-12 items-center relative z-10">
        
        <div className="flex flex-col items-start space-y-6 animate-fade-in">
          <span className="px-4 py-1.5 rounded-full bg-salma-accent/10 text-salma-accent text-xs font-black uppercase tracking-widest border border-salma-accent/20">
            {dictionary.hero.badge}
          </span>
          
          <h1 className="text-4xl md:text-6xl font-serif font-bold leading-tight text-salma-primary dark:text-white">
            {dictionary.hero.title}
          </h1>
          
          <p className="text-lg md:text-xl text-salma-text-muted max-w-lg leading-relaxed">
            {dictionary.hero.description}
          </p>

          <div className="flex flex-col sm:flex-row gap-4 w-full sm:w-auto pt-4">
            <SalmaButton variant="primary" size="lg">
              {dictionary.hero.ctaPrimary}
            </SalmaButton>
            <SalmaButton variant="outline" size="lg">
              {dictionary.hero.ctaSecondary}
            </SalmaButton>
          </div>

          {/* Indicateur de confiance corrig√© */}
          <div className="pt-8 flex items-center gap-4 border-t border-salma-border w-full">
            <div className="flex -space-x-3">
              {[1, 2, 3].map((i) => (
                <div key={i} className="w-10 h-10 rounded-full border-2 border-white bg-gray-200 overflow-hidden">
                   <Image src={`https://i.pravatar.cc/100?img=${i+10}`} width={40} height={40} alt="User" />
                </div>
              ))}
            </div>
            <p className="text-xs text-salma-text-muted font-medium">
              <span className="text-salma-gold font-bold">{dictionary.hero.trustIndicator.count}</span> {dictionary.hero.trustIndicator.text}
            </p>
          </div>
        </div>

        <div className="relative hidden lg:block h-[600px] w-full animate-fade-in" style={{ animationDelay: '0.2s' }}>
          <div className="absolute inset-0 rounded-3xl overflow-hidden shadow-salma-lg border-8 border-white dark:border-salma-surface transform rotate-2">
            <Image 
              src="/image.jpg" 
              alt={dictionary.hero.imageAlt} 
              fill 
              className="object-cover"
              priority
               sizes="(max-width: 768px) 100vw, 50vw" 
            />
          </div>
          
          {/* Badge d√©lai corrig√© */}
          <div className="absolute -bottom-6 -left-6 bg-salma-gold p-6 rounded-2xl shadow-xl text-salma-primary max-w-[180px] -rotate-3">
            <span className="block text-4xl font-bold">{dictionary.hero.visaBadge.number}</span>
            <span className="text-xs font-black uppercase tracking-tight leading-none">
              {dictionary.hero.visaBadge.label}
            </span>
          </div>
        </div>
      </div>
    </section>
  );
}
// END OF FILE: src/sections/visitor/Hero.tsx

// FILE: src/sections/visitor/StatsCounter.tsx
-----------------------------------------------
// src/sections/visitor/StatsCounter.tsx
"use client";

import { useLanguage } from "@/hooks/useLanguage";
import type { KpiRealtime } from "@/types/api/kpi.types";

interface Props {
  kpi?: KpiRealtime | null;
}

export default function StatsCounter({ kpi }: Props) {
  const { dictionary } = useLanguage();

  // On simplifie : on ne garde que value et label
  const stats = [
    {
      id: "visas",
      value: dictionary.stats.visas.value,
      label: dictionary.stats.visas.label,
    },
    {
      id: "partners",
      value: dictionary.stats.partners.value,
      label: dictionary.stats.partners.label,
    },
    {
      id: "experience",
      value: dictionary.stats.experience.value,
      label: dictionary.stats.experience.label,
    },
    {
      id: "satisfaction",
      value: kpi
        ? `${Math.round(kpi.taux_conversion_global * 100)}%`
        : dictionary.stats.satisfaction.value,
      label: dictionary.stats.satisfaction.label,
    },
  ];

  return (
    <section className="py-20 bg-salma-accent/5 dark:bg-salma-surface/20">
      <div className="container mx-auto px-6">
        <div className="grid grid-cols-2 lg:grid-cols-4 gap-8 md:gap-12">
          {stats.map((stat) => (
            <div key={stat.id} className="flex flex-col items-center text-center group">
              <span className="text-4xl md:text-5xl font-serif font-bold text-salma-primary dark:text-salma-gold mb-2 transition-transform group-hover:scale-110 duration-300">
                {stat.value}
              </span>
              <div className="w-8 h-1 bg-salma-gold rounded-full mb-4 opacity-50" />
              <span className="text-xs md:text-sm font-sans font-bold uppercase tracking-widest text-salma-text-muted">
                {stat.label}
              </span>
            </div>
          ))}
        </div>
      </div>
    </section>
  );
}
// END OF FILE: src/sections/visitor/StatsCounter.tsx

// FILE: src/sections/visitor/SuccessStories.tsx
-----------------------------------------------
// src/sections/visitor/SuccessStories.tsx
// ==============================================================================
//  Section T√©moignages ‚Äî donn√©es r√©elles depuis l'API (approuv√©s uniquement)
//  Utilise TestimonialPublic (types corrects) + fallback si aucune donn√©e
// ==============================================================================
"use client";

import { useLanguage } from "@/hooks/useLanguage";
import Image from "next/image";
import SectionTitle from "@/components/ui/SectionTitle";
import { getMediaUrl } from "@/lib/api-client";
import type { TestimonialPublic } from "@/types/api/testimonial.types";

interface Props {
  testimonials: TestimonialPublic[];
}

function StarRating({ note }: { note: number }) {
  return (
    <div className="flex gap-0.5">
      {Array.from({ length: 5 }).map((_, i) => (
        <svg
          key={i}
          className={`w-3.5 h-3.5 ${i < note ? "text-salma-gold" : "text-salma-border"}`}
          fill="currentColor"
          viewBox="0 0 20 20"
        >
          <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
        </svg>
      ))}
    </div>
  );
}

// Donn√©es de fallback si aucun t√©moignage approuv√© en BD
const FALLBACK_TESTIMONIALS: TestimonialPublic[] = [
  {
    id: "fallback-1",
    nom_auteur: "Aminata K.",
    pays_auteur: "Cameroun",
    citation_fr:
      "Gr√¢ce √† SALMA, j'ai obtenu ma bourse CSC en moins de 2 mois. L'√©quipe m'a accompagn√©e √† chaque √©tape du dossier.",
    citation_en:
      "Thanks to SALMA, I got my CSC scholarship in less than 2 months. The team supported me at every step.",
    note: 5,
    photo: null,
    date_creation: "2025-09-15",
  },
  {
    id: "fallback-2",
    nom_auteur: "Jean-Baptiste M.",
    pays_auteur: "Cameroun",
    citation_fr:
      "Professionnel et efficace. Mon visa allemand a √©t√© obtenu en 3 semaines comme promis.",
    citation_en:
      "Professional and efficient. My German visa was obtained in 3 weeks as promised.",
    note: 5,
    photo: null,
    date_creation: "2025-10-20",
  },
  {
    id: "fallback-3",
    nom_auteur: "Fatou D.",
    pays_auteur: "Cameroun",
    citation_fr:
      "L'√©quipe a r√©pondu √† toutes mes questions rapidement. Je recommande vivement !",
    citation_en:
      "The team answered all my questions quickly. I highly recommend them!",
    note: 5,
    photo: null,
    date_creation: "2025-11-10",
  },
];

export default function SuccessStories({ testimonials }: Props) {
  const { dictionary, locale } = useLanguage();

  // Utiliser les donn√©es r√©elles ou le fallback
  const displayed =
    testimonials.length > 0 ? testimonials.slice(0, 3) : FALLBACK_TESTIMONIALS;

  return (
    <section className="py-24 bg-salma-surface/30 dark:bg-salma-surface/10">
      <div className="container mx-auto px-6">
        <div className="text-center mb-14">
          <SectionTitle
            title={
              dictionary.successStories?.title ??
              (locale === "fr"
                ? "Ils ont r√©ussi gr√¢ce √† SALMA"
                : "They succeeded with SALMA")
            }
            subtitle={
              dictionary.successStories?.subtitle ??
              (locale === "fr"
                ? "Histoires de Succ√®s"
                : "Success Stories")
            }
            align="center"
          />
        </div>

        <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
          {displayed.map((t) => {
            const citation =
              locale === "fr" ? t.citation_fr : (t.citation_en || t.citation_fr);
            const photoUrl = t.photo
              ? getMediaUrl(t.photo.url_fichier)
              : null;

            return (
              <div
                key={t.id}
                className="flex flex-col bg-white dark:bg-salma-surface border border-salma-border rounded-2xl p-6 gap-4 shadow-sm hover:shadow-salma-lg transition-all duration-300"
              >
                {/* √âtoiles */}
                <StarRating note={t.note} />

                {/* Citation */}
                <blockquote className="text-sm text-salma-text leading-relaxed flex-1 italic">
                  &ldquo;{citation}&rdquo;
                </blockquote>

                {/* Auteur */}
                <div className="flex items-center gap-3 pt-3 border-t border-salma-border">
                  {photoUrl ? (
                    <Image
                      src={photoUrl}
                      alt={t.nom_auteur}
                      width={40}
                      height={40}
                      className="w-10 h-10 rounded-full object-cover"
                    />
                  ) : (
                    <div className="w-10 h-10 rounded-full bg-salma-primary/10 flex items-center justify-center flex-shrink-0">
                      <span className="text-sm font-bold text-salma-primary">
                        {t.nom_auteur.charAt(0).toUpperCase()}
                      </span>
                    </div>
                  )}
                  <div>
                    <p className="text-xs font-bold text-salma-text">
                      {t.nom_auteur}
                    </p>
                    {t.pays_auteur && (
                      <p className="text-[10px] text-salma-text-muted">
                        {t.pays_auteur}
                      </p>
                    )}
                  </div>
                </div>
              </div>
            );
          })}
        </div>
      </div>
    </section>
  );
}

// END OF FILE: src/sections/visitor/SuccessStories.tsx

// FILE: src/sections/visitor/TrustBar.tsx
-----------------------------------------------
"use client";

import { useLanguage } from "@/hooks/useLanguage";

export default function TrustBar() {
  const { dictionary } = useLanguage();

  const trustItems = [
    {
      id: "expertise",
      title: dictionary.trust.expertise.title,
      desc: dictionary.trust.expertise.desc,
      icon: (
        <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
        </svg>
      ),
    },
    {
      id: "speed",
      title: dictionary.trust.speed.title,
      desc: dictionary.trust.speed.desc,
      icon: (
        <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      ),
    },
    {
      id: "guarantee",
      title: dictionary.trust.guarantee.title,
      desc: dictionary.trust.guarantee.desc,
      icon: (
        <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z" />
        </svg>
      ),
    },
  ];

  return (
    <section className="relative z-20 -mt-10 px-6">
      <div className="max-w-6xl mx-auto bg-white dark:bg-salma-surface border border-salma-border shadow-salma-lg rounded-3xl overflow-hidden">
        <div className="grid grid-cols-1 md:grid-cols-3 divide-y md:divide-y-0 md:divide-x divide-salma-border">
          {trustItems.map((item) => (
            <div 
              key={item.id} 
              className="p-8 flex items-start gap-6 hover:bg-salma-accent/5 transition-colors group"
            >
              <div className="text-salma-gold group-hover:scale-110 transition-transform duration-300">
                {item.icon}
              </div>
              <div>
                <h3 className="text-sm font-bold uppercase tracking-widest text-salma-primary dark:text-white mb-1">
                  {item.title}
                </h3>
                <p className="text-xs text-salma-text-muted leading-relaxed">
                  {item.desc}
                </p>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  );
}
// END OF FILE: src/sections/visitor/TrustBar.tsx

// FILE: src/types/api/auth.types.ts
-----------------------------------------------
// src/types/api/auth.types.ts
// ==============================================================================
//  Types TypeScript ‚Äî Module Authentification
//  Calque sur AdminUser Django + endpoints JWT
// ==============================================================================

export type AdminRole = "super_admin" | "admin" | "editor";

export interface AdminUser {
  id: string;
  email: string;
  nom_complet: string;
  role: AdminRole;
  is_active: boolean;
  derniere_connexion: string | null;
  date_creation: string;
}

// --- R√©ponse login -----------------------------------------------------------

export interface LoginResponse {
  access: string;
  refresh: string;
  user: AdminUser;
}

// --- Payloads ----------------------------------------------------------------

export interface LoginPayload {
  email: string;
  password: string;
}

export interface LogoutPayload {
  refresh: string;
}

export interface RegisterPayload {
  email: string;
  nom_complet: string;
  role: AdminRole;
  password: string;
}

export interface ChangePasswordPayload {
  old_password: string;
  new_password: string;
}

export interface ResetPasswordRequestPayload {
  email: string;
}

export interface ResetPasswordConfirmPayload {
  token: string;
  new_password: string;
}

export interface UpdateProfilePayload {
  nom_complet?: string;
  email?: string;
}

// --- Token refresh -----------------------------------------------------------

export interface TokenRefreshPayload {
  refresh: string;
}

export interface TokenRefreshResponse {
  access: string;
  refresh?: string; // ROTATE_REFRESH_TOKENS = True ‚Üí nouveau refresh renvoy√©
}
// END OF FILE: src/types/api/auth.types.ts

// FILE: src/types/api/chatbot.types.ts
-----------------------------------------------
// src/types/api/chatbot.types.ts
// ==============================================================================
//  Types TypeScript ‚Äî Module Chatbot IA
//  Calque sur FaqEntry Django + ChatbotMessageSerializer + views
// ==============================================================================

// --- FaqEntry (admin CRUD) ---------------------------------------------------

export interface FaqEntry {
  id: string;
  question_fr: string;
  question_en: string;
  reponse_fr: string;
  reponse_en: string;
  categorie: string;
  ordre_affichage: number;
  est_actif: boolean;
}

export interface CreateFaqEntryPayload {
  question_fr: string;
  question_en: string;
  reponse_fr: string;
  reponse_en: string;
  categorie?: string;
  ordre_affichage?: number;
  est_actif?: boolean;
}

export type UpdateFaqEntryPayload = Partial<CreateFaqEntryPayload>;

// --- Chatbot message (public) ------------------------------------------------

/** POST /api/chatbot/message ‚Äî payload */
export interface ChatbotMessagePayload {
  message: string;
  langue?: "fr" | "en";
}

/** Suggestion de FAQ li√©e */
export interface ChatbotSuggestion {
  question: string;
  id: string;
}

/** R√©ponse du chatbot */
export interface ChatbotMessageResponse {
  reponse: string;
  source: "faq" | "fallback";
  faq_id: string | null;
  suggestions: ChatbotSuggestion[];
}

// --- R√©ponse pagin√©e admin ---------------------------------------------------

export interface PaginatedFaqResponse {
  count: number;
  next: string | null;
  previous: string | null;
  results: FaqEntry[];
}

// --- Filtres admin -----------------------------------------------------------

export interface FaqFilters {
  categorie?: string;
  est_actif?: boolean;
  search?: string;
  page?: number;
  page_size?: number;
  ordering?: string;
}
// END OF FILE: src/types/api/chatbot.types.ts

// FILE: src/types/api/cms.types.ts
-----------------------------------------------
// src/types/api/cms.types.ts
// ==============================================================================
//  Types TypeScript ‚Äî Module CMS (Contenu du Site)
//  Calque sur SitePage, ContentBlock, SiteConfig, PitchVideo Django + serializers
// ==============================================================================

import type { MediaAssetMinimal } from "./media.types";

// --- √ânum√©rations ------------------------------------------------------------

export type TypeBloc =
  | "HERO"
  | "TEXTE"
  | "IMAGE"
  | "CTA"
  | "STATS"
  | "BARRE_CONFIANCE"
  | "VIDEO"
  | "TEMOIGNAGES";

// --- ContentBlock ------------------------------------------------------------

export interface ContentBlock {
  id: string;
  cle_bloc: string;
  type_bloc: TypeBloc;
  contenu_fr: string;
  contenu_en: string;
  image: MediaAssetMinimal | null;
  lien_cta: string;
  est_visible: boolean;
  ordre_affichage: number;
  date_modification: string;
}

export interface CreateContentBlockPayload {
  cle_bloc: string;
  type_bloc: TypeBloc;
  contenu_fr?: string;
  contenu_en?: string;
  image_id?: string | null;
  lien_cta?: string;
  est_visible?: boolean;
  ordre_affichage?: number;
}

export type UpdateContentBlockPayload = Partial<CreateContentBlockPayload>;

// --- SitePage ----------------------------------------------------------------

/** Public : page + blocs visibles uniquement */
export interface SitePagePublic {
  id: string;
  slug: string;
  titre_fr: string;
  titre_en: string;
  blocs: ContentBlock[];
}

/** Admin : page + tous les blocs */
export interface SitePageAdmin {
  id: string;
  slug: string;
  titre_fr: string;
  titre_en: string;
  est_publiee: boolean;
  ordre_affichage: number;
  date_modification: string;
  blocs: ContentBlock[];
}

export interface CreateSitePagePayload {
  slug: string;
  titre_fr: string;
  titre_en: string;
  est_publiee?: boolean;
  ordre_affichage?: number;
}

export type UpdateSitePagePayload = Partial<CreateSitePagePayload>;

// --- SiteConfig --------------------------------------------------------------

export interface SiteConfig {
  id: string;
  cle_config: string;
  valeur_fr: string;
  valeur_en: string;
  date_modification: string;
}

export interface CreateSiteConfigPayload {
  cle_config: string;
  valeur_fr?: string;
  valeur_en?: string;
}

export type UpdateSiteConfigPayload = Partial<CreateSiteConfigPayload>;

// --- PitchVideo --------------------------------------------------------------

export interface PitchVideo {
  id: string;
  titre_fr: string;
  titre_en: string;
  url_video: string;
  thumbnail: MediaAssetMinimal | null;
  est_active: boolean;
  page_affichage: string;
  date_modification: string;
}

export interface CreatePitchVideoPayload {
  titre_fr: string;
  titre_en: string;
  url_video: string;
  thumbnail_id?: string | null;
  est_active?: boolean;
  page_affichage?: string;
}

export type UpdatePitchVideoPayload = Partial<CreatePitchVideoPayload>;
// END OF FILE: src/types/api/cms.types.ts

// FILE: src/types/api/contact.types.ts
-----------------------------------------------
// src/types/api/contact.types.ts
// ==============================================================================
//  Types TypeScript ‚Äî Module Demandes de Contact
//  Calque sur ContactRequest Django + serializers DRF
// ==============================================================================

// --- Bourse associ√©e (vue l√©g√®re dans la r√©ponse admin) ----------------------

export interface ContactBourseAssociee {
  id: string;
  titre_fr: string;
  titre_en: string;
}

// --- Mod√®le admin (lecture) --------------------------------------------------

export interface ContactRequest {
  statut: string;
  id: string;
  nom_complet: string;
  email: string;
  telephone: string;
  whatsapp: string;
  message: string;
  accepte_newsletter: boolean;
  est_lu: boolean;
  notes_admin: string;
  date_creation: string;
  bourses_associees: ContactBourseAssociee[];
}

// --- Payload soumission publique (POST /api/contact) -------------------------

export interface CreateContactPayload {
  nom_complet: string;
  email: string;
  telephone?: string;
  whatsapp?: string;
  message: string;
  accepte_newsletter?: boolean;
  bourses_ids?: string[];
}

// --- Payload admin (PATCH ‚Äî marquer lu, ajouter notes) -----------------------

export interface UpdateContactPayload {
  est_lu?: boolean;
  notes_admin?: string;
}

// --- R√©ponse pagin√©e ---------------------------------------------------------

export interface PaginatedContactResponse {
  count: number;
  next: string | null;
  previous: string | null;
  results: ContactRequest[];
}

// --- Filtres admin -----------------------------------------------------------

export interface ContactFilters {
  est_lu?: boolean;
  search?: string;
  page?: number;
  page_size?: number;
  ordering?: string;
}
// END OF FILE: src/types/api/contact.types.ts

// FILE: src/types/api/kpi.types.ts
-----------------------------------------------
// src/types/api/kpi.types.ts
// ==============================================================================

export type EventType =
  | "PAGE_VIEW"
  | "BOURSE_VUE"
  | "BOURSE_CLIC_DETAIL"
  | "CONTACT_SOUMIS"
  | "NEWSLETTER_INSCRIPTION"
  | "CHATBOT_OUVERT"
  | "WHATSAPP_CLIC"
  | "RENDEZ_VOUS_SOUMIS";

// --- Tracking c√¥t√© visiteur (public) -----------------------------------------

export interface VisitorEventPayload {
  type: EventType;
  page?: string;           // URL ou slug de page
  bourse_id?: string;      // si l'√©v√©nement concerne une bourse
  metadata?: Record<string, string | number | boolean>;
}

// --- Snapshots KPI (admin) ---------------------------------------------------

export interface KpiSnapshot {
  id: string;
  date: string;            // "2026-02-27"
  total_visiteurs: number;
  total_vues_bourses: number;
  total_contacts: number;
  total_newsletter: number;
  taux_conversion: number; // 0.0 ‚Üí 1.0 (ex: 0.035 = 3.5%)
  bourses_les_plus_vues: BourseKpi[];
}

export interface BourseKpi {
  bourse_id: string;
  titre: string;
  nb_vues: number;
  nb_contacts: number;
  taux_conversion: number;
}

// --- Stats temps r√©el --------------------------------------------------------

export interface KpiRealtime {
  total_visiteurs:number;
  visiteurs_aujourd_hui: number;
  vues_bourses_aujourd_hui: number;
  contacts_aujourd_hui: number;
  contacts_en_attente: number;
  abonnes_total: number;
  taux_conversion_global: number;
  evolution_7j: {
    visiteurs: number[];  // array de 7 valeurs (j-6 ‚Üí aujourd'hui)
    contacts: number[];
  };
}

// --- Taux de conversion -------------------------------------------------------

export interface ConversionRate {
  global: number;
  par_bourse: BourseKpi[];
  par_page: { page: string; vues: number; conversions: number; taux: number }[];
}

// --- √âv√©nements bruts --------------------------------------------------------

export interface VisitorEvent {
  id: string;
  type: EventType;
  page: string;
  bourse_id: string | null;
  ip_hash: string;          // IP hash√©e (pas de donn√©es personnelles)
  user_agent: string;
  metadata: Record<string, unknown>;
  date_creation: string;
}

export interface EventFilters {
  type?: EventType;
  page?: string;
  bourse_id?: string;
  date_debut?: string;
  date_fin?: string;
  page_number?: number;
}

export interface KpiSnapshotFilters {
  date_debut?: string;
  date_fin?: string;
  periode?: "jour" | "semaine" | "mois";
}
// END OF FILE: src/types/api/kpi.types.ts

// FILE: src/types/api/media.types.ts
-----------------------------------------------
// src/types/api/media.types.ts
// ==============================================================================
//  Types TypeScript ‚Äî Module M√©dias
//  Calque sur MediaAsset Django + serializers DRF
// ==============================================================================

// --- Mod√®le complet (admin) --------------------------------------------------

export interface MediaAsset {
  id: string;
  nom_fichier: string;
  fichier: string;              // URL relative ou absolue du fichier upload√©
  url_fichier: string;          // URL compl√®te auto-g√©n√©r√©e
  texte_alt_fr: string;
  texte_alt_en: string;
  type_mime: string;
  taille_octets: number;
  date_upload: string;          // ISO datetime
}

// --- Mod√®le minimal (inclusion dans d'autres mod√®les) -----------------------
//     Correspond √† MediaAssetMinimalSerializer

export interface MediaAssetMinimal {
  id: string;
  url_fichier: string;
  texte_alt_fr: string;
  texte_alt_en: string;
}

// --- Payloads ----------------------------------------------------------------

/** Upload d'un fichier ‚Äî FormData (multipart) */
export interface UploadMediaPayload {
  fichier: File;
  nom_fichier?: string;
  texte_alt_fr?: string;
  texte_alt_en?: string;
}

/** Modification m√©tadonn√©es (PATCH) */
export interface UpdateMediaPayload {
  nom_fichier?: string;
  texte_alt_fr?: string;
  texte_alt_en?: string;
}

// --- R√©ponse pagin√©e ---------------------------------------------------------

export interface PaginatedMediaResponse {
  count: number;
  next: string | null;
  previous: string | null;
  results: MediaAsset[];
}

// --- Filtres -----------------------------------------------------------------

export interface MediaFilters {
  type_mime?: string;
  search?: string;
  page?: number;
  page_size?: number;
  ordering?: string;
}
// END OF FILE: src/types/api/media.types.ts

// FILE: src/types/api/newsletter.types.ts
-----------------------------------------------
// src/types/api/newsletter.types.ts
// ==============================================================================
//  Types TypeScript ‚Äî Module Newsletter & Annonces
//  Calque sur NewsletterSubscriber, Announcement Django + serializers DRF
// ==============================================================================

import type { ScholarshipLevel, ScholarshipCountry } from "./scholarship.types";

// --- √ânum√©rations ------------------------------------------------------------

export type StatutAnnonce = "BROUILLON" | "PROGRAMME" | "ENVOYE";

// --- NewsletterSubscriber ----------------------------------------------------

export interface NewsletterSubscriber {
  id: string;
  email: string;
  nom_complet: string;
  telephone: string;
  pays: string;
  niveau_etudes: ScholarshipLevel | "";
  destination_souhaitee: ScholarshipCountry | "";
  source: string;
  est_actif: boolean;
  date_inscription: string;
  date_desinscription: string | null;
}

// --- Payloads publics --------------------------------------------------------

/** POST /api/newsletter/inscription */
export interface NewsletterInscriptionPayload {
  email: string;
  nom_complet?: string;
  telephone?: string;
  pays?: string;
  source?: string;
  niveau_etudes?: ScholarshipLevel | "";
  destination_souhaitee?: ScholarshipCountry | "";
}

/** POST /api/newsletter/desinscription */
export interface NewsletterDesinscriptionPayload {
  email: string;
}

// --- Bourse li√©e (vue l√©g√®re dans Announcement) ------------------------------

export interface AnnouncementBourseLinked {
  id: string;
  titre_fr: string;
}

// --- Announcement ------------------------------------------------------------

export interface Announcement {
  id: string;
  titre_fr: string;
  titre_en: string;
  contenu_fr: string;
  contenu_en: string;
  image: string | null;         // ID du m√©dia (FK)
  statut: StatutAnnonce;
  date_envoi: string | null;
  date_creation: string;
  bourses_liees: AnnouncementBourseLinked[];
}

export interface CreateAnnouncementPayload {
  titre_fr: string;
  titre_en: string;
  contenu_fr: string;
  contenu_en: string;
  image?: string | null;
  statut?: StatutAnnonce;
  date_envoi?: string | null;
  bourses_ids?: string[];
}

export type UpdateAnnouncementPayload = Partial<CreateAnnouncementPayload>;

// --- R√©ponse envoi annonce ---------------------------------------------------

export interface SendAnnouncementResponse {
  detail: string;
  abonnes_count: number;
  statut: StatutAnnonce;
}

// --- R√©ponses pagin√©es -------------------------------------------------------

export interface PaginatedSubscriberResponse {
  count: number;
  next: string | null;
  previous: string | null;
  results: NewsletterSubscriber[];
}

export interface PaginatedAnnouncementResponse {
  count: number;
  next: string | null;
  previous: string | null;
  results: Announcement[];
}

// --- Filtres -----------------------------------------------------------------

export interface SubscriberFilters {
  est_actif?: boolean;
  pays?: string;
  niveau_etudes?: ScholarshipLevel | "";
  destination_souhaitee?: ScholarshipCountry | "";
  search?: string;
  page?: number;
  page_size?: number;
  ordering?: string;
}

export interface AnnouncementFilters {
  statut?: StatutAnnonce;
  search?: string;
  page?: number;
  page_size?: number;
  ordering?: string;
}
// END OF FILE: src/types/api/newsletter.types.ts

// FILE: src/types/api/scholarship.types.ts
-----------------------------------------------
// src/types/api/scholarship.types.ts
// ==============================================================================
//  Types TypeScript ‚Äî Module Bourses
//  Calque exact sur les mod√®les Django / s√©rialiseurs DRF
// ==============================================================================

// Imports
import type { MediaAssetMinimal } from "./media.types";
// --- √ânum√©rations (correspondent aux choices Django) -------------------------

export type ScholarshipStatus = "brouillon" | "publie" | "expire" | "archive";
export type ScholarshipLevel = "licence" | "master" | "doctorat" | "postdoc" | "formation" | "autre";
export type ScholarshipCoverage = "complete" | "partielle" | "logement" | "transport" | "autre";
export type ScholarshipCountry = "chine" | "allemagne" | "france" | "canada" | "autre";

// --- Sous-mod√®les ------------------------------------------------------------

export interface ScholarshipField {
  id: string;
  nom_fr: string;
  nom_en: string;
  icone: string;
}

export interface ScholarshipBenefit {
  id: string;
  libelle_fr: string;
  libelle_en: string;
  icone: string;
}

export interface ScholarshipEligibility {
  id: string;
  libelle_fr: string;
  libelle_en: string;
  icone: string;
}

/** Visibilit√© d'un champ ‚Äî contr√¥le ce que le public voit */
export interface FieldVisibility {
  id: string;
  nom_du_champ: string;
  est_visible: boolean;
}

/** Dictionnaire pratique : { nom_du_champ: est_visible } */
export type FieldVisibilityMap = Record<string, boolean>;


export interface ScholarshipImage {
  id: string;
  media: MediaAssetMinimal;
  est_principale: boolean;
  ordre: number;
}

// --- Mod√®le principal ‚Äî Liste publique (infos minimales) --------------------

export interface ScholarshipPublicListItem {
  id: string;
  titre_fr: string;
  titre_en: string;
  organisme_fr: string;
  organisme_en: string;
  pays_destination: ScholarshipCountry;
  niveau: ScholarshipLevel;
  statut: ScholarshipStatus;
  type_couverture: ScholarshipCoverage;
  date_limite: string | null;          // ISO date string ou null
  exigence_langue_fr: string;
  exigence_langue_en: string;
  details_montant_fr: string;          // jamais affich√© c√¥t√© public (field_visibility)
  details_montant_en: string;
  est_mise_en_avant: boolean;
  domaines: ScholarshipField[];
  image_principale: MediaAssetMinimal | null;
}

// --- Mod√®le principal ‚Äî D√©tail public (avec visibilit√© appliqu√©e) -----------

export interface ScholarshipPublicDetail {
  id: string;
  titre_fr: string;
  titre_en: string;
  organisme_fr: string;
  organisme_en: string;
  description_fr: string;
  description_en: string;
  pays_destination: ScholarshipCountry;
  niveau: ScholarshipLevel;
  statut: ScholarshipStatus;
  type_couverture: ScholarshipCoverage;
  date_limite: string | null;
  limite_age: number | null;
  exigence_langue_fr: string;
  exigence_langue_en: string;
  details_montant_fr: string;
  details_montant_en: string;
  lien_officiel: string;
  est_mise_en_avant: boolean;
  ordre_affichage: number;
  domaines: ScholarshipField[];
  avantages: ScholarshipBenefit[];
  criteres: ScholarshipEligibility[];
  images: ScholarshipImage[];
  visibilites: FieldVisibility[];       // ‚Üí utiliser toFieldVisibilityMap()
  date_creation: string;
  date_modification: string;
}

// --- Mod√®le principal ‚Äî Admin complet (CRUD) --------------------------------

// FIX : Utilisation d'un type alias au lieu d'une interface vide pour ESLint
export type ScholarshipAdmin = ScholarshipPublicDetail;

// --- Payloads de cr√©ation/modification (admin) ------------------------------

export interface CreateScholarshipPayload {
  titre_fr: string;
  titre_en: string;
  organisme_fr: string;
  organisme_en: string;
  description_fr: string;
  description_en: string;
  pays_destination: ScholarshipCountry;
  niveau: ScholarshipLevel;
  statut: ScholarshipStatus;
  type_couverture: ScholarshipCoverage;
  date_limite?: string | null;
  limite_age?: number | null;
  exigence_langue_fr?: string;
  exigence_langue_en?: string;
  details_montant_fr?: string;
  details_montant_en?: string;
  lien_officiel?: string;
  est_mise_en_avant?: boolean;
  ordre_affichage?: number;
}

export type UpdateScholarshipPayload = Partial<CreateScholarshipPayload>;

export interface UpdateFieldVisibilityPayload {
  nom_du_champ: string;
  est_visible: boolean;
}

export interface AddScholarshipImagePayload {
  media_id: string;
  est_principale?: boolean;
  ordre?: number;
}

// --- R√©ponses pagin√©es -------------------------------------------------------

export interface PaginatedResponse<T> {
  count: number;
  next: string | null;
  previous: string | null;
  results: T[];
}

export type ScholarshipListResponse = PaginatedResponse<ScholarshipPublicListItem>;
export type ScholarshipAdminListResponse = PaginatedResponse<ScholarshipAdmin>;

// --- Filtres (query params) --------------------------------------------------

export interface ScholarshipFilters {
  pays_destination?: ScholarshipCountry;
  niveau?: ScholarshipLevel;
  statut?: ScholarshipStatus;
  type_couverture?: ScholarshipCoverage;
  est_mise_en_avant?: boolean;
  search?: string;
  page?: number;
  page_size?: number;
  ordering?: string;
}

// --- Helper utilitaire -------------------------------------------------------

/**
 * Convertit le tableau FieldVisibility[] en dictionnaire pratique
 * Usage : const map = toFieldVisibilityMap(scholarship.visibilites)
 *         if (map['description_fr']) { ... }
 */
export function toFieldVisibilityMap(visibilites: FieldVisibility[]): FieldVisibilityMap {
  return visibilites.reduce<FieldVisibilityMap>((acc, v) => {
    acc[v.nom_du_champ] = v.est_visible;
    return acc;
  }, {});
}

/**
 * Liste de tous les champs d'une bourse soumis √† la visibilit√©
 * Correspond aux champs que l'admin peut masquer/afficher
 */
export const SCHOLARSHIP_VISIBILITY_FIELDS = [
  "description_fr",
  "description_en",
  "date_limite",
  "limite_age",
  "exigence_langue_fr",
  "exigence_langue_en",
  "details_montant_fr",
  "details_montant_en",
  "lien_officiel",
  "avantages",
  "criteres",
  "images",
  "type_couverture",
] as const;

export type ScholarshipVisibilityField = (typeof SCHOLARSHIP_VISIBILITY_FIELDS)[number];
// END OF FILE: src/types/api/scholarship.types.ts

// FILE: src/types/api/service.types.ts
-----------------------------------------------
// src/types/api/service.types.ts
// ==============================================================================
//  Types TypeScript ‚Äî Module Services
//  Calque sur Service, ServiceImage Django + serializers DRF
// ==============================================================================

import type { MediaAssetMinimal } from "./media.types";

// --- ServiceImage ------------------------------------------------------------

export interface ServiceImage {
  id: string;
  media: MediaAssetMinimal;
  est_principale: boolean;
  ordre: number;
}

// --- Service (public) --------------------------------------------------------

export interface ServicePublic {
  id: string;
  slug: string;
  nom_fr: string;
  nom_en: string;
  description_fr: string;
  description_en: string;
  icone: string;
  delai_traitement: string;
  images: ServiceImage[];
}

// --- Service (admin ‚Äî champs suppl√©mentaires) --------------------------------

export interface ServiceAdmin {
  id: string;
  slug: string;
  nom_fr: string;
  nom_en: string;
  description_fr: string;
  description_en: string;
  icone: string;
  delai_traitement: string;
  est_actif: boolean;
  ordre_affichage: number;
  images: ServiceImage[];
}

// --- Payloads CRUD -----------------------------------------------------------

export interface CreateServicePayload {
  slug: string;
  nom_fr: string;
  nom_en: string;
  description_fr: string;
  description_en: string;
  icone?: string;
  delai_traitement?: string;
  est_actif?: boolean;
  ordre_affichage?: number;
}

export type UpdateServicePayload = Partial<CreateServicePayload>;

/** POST /api/admin/services/{id}/images */
export interface AddServiceImagePayload {
  media_id: string;
  est_principale?: boolean;
}

// --- R√©ponses pagin√©es -------------------------------------------------------

export interface PaginatedServiceResponse {
  count: number;
  next: string | null;
  previous: string | null;
  results: ServiceAdmin[];
}

// --- Filtres -----------------------------------------------------------------

export interface ServiceFilters {
  est_actif?: boolean;
  search?: string;
  page?: number;
  page_size?: number;
  ordering?: string;
}
// END OF FILE: src/types/api/service.types.ts

// FILE: src/types/api/testimonial.types.ts
-----------------------------------------------
// src/types/api/testimonial.types.ts
// ==============================================================================
//  Types TypeScript ‚Äî Module T√©moignages
//  Calque sur Testimonial Django + serializers DRF
// ==============================================================================

import type { MediaAssetMinimal } from "./media.types";

// --- √ânum√©rations ------------------------------------------------------------

export type SourceTemoignage = "SITE" | "WHATSAPP" | "EMAIL";

// --- Public (t√©moignages approuv√©s + affich√©s) -------------------------------

export interface TestimonialPublic {
  id: string;
  nom_auteur: string;
  pays_auteur: string;
  citation_fr: string;
  citation_en: string;
  note: number;                 // 1‚Äì5
  photo: MediaAssetMinimal | null;
  date_creation: string;
}

// --- Admin (CRUD complet) ----------------------------------------------------

export interface TestimonialAdmin {
  id: string;
  nom_auteur: string;
  pays_auteur: string;
  citation_fr: string;
  citation_en: string;
  note: number;
  source: SourceTemoignage;
  photo: MediaAssetMinimal | null;
  fichier_joint: MediaAssetMinimal | null;
  est_approuve: boolean;
  est_affiche_sur_site: boolean;
  ordre_affichage: number;
  date_creation: string;
}

// --- Payload soumission publique (POST /api/temoignages) ---------------------

export interface SubmitTestimonialPayload {
  nom_auteur: string;
  pays_auteur?: string;
  citation_fr: string;
  citation_en?: string;
  note?: number;
}

// --- Payload admin (POST/PUT/PATCH) ------------------------------------------

export interface CreateTestimonialPayload {
  nom_auteur: string;
  pays_auteur?: string;
  citation_fr: string;
  citation_en?: string;
  note?: number;
  source?: SourceTemoignage;
  photo_id?: string | null;
  fichier_joint_id?: string | null;
  est_approuve?: boolean;
  est_affiche_sur_site?: boolean;
  ordre_affichage?: number;
}

export type UpdateTestimonialPayload = Partial<CreateTestimonialPayload>;

// --- R√©ponse pagin√©e ---------------------------------------------------------

export interface PaginatedTestimonialResponse {
  count: number;
  next: string | null;
  previous: string | null;
  results: TestimonialAdmin[];
}

// --- Filtres admin -----------------------------------------------------------

export interface TestimonialFilters {
  est_approuve?: boolean;
  est_affiche_sur_site?: boolean;
  source?: SourceTemoignage;
  search?: string;
  page?: number;
  page_size?: number;
  ordering?: string;
}
// END OF FILE: src/types/api/testimonial.types.ts

// FILE: src/types/index.ts
-----------------------------------------------
// FILE: src/types/index.ts
// ==============================================================================

// --- Auth ---
export * from "@/types/api/auth.types"; // Retrait du mot-cl√© 'type' pour exporter les enums/consts si pr√©sents

// --- Bourses ---
export * from "@/types/api/scholarship.types"; // CRITIQUE : exporte toFieldVisibilityMap et SCHOLARSHIP_VISIBILITY_FIELDS

// --- M√©dias ---
export * from "@/types/api/media.types";

// --- CMS ---
export * from "@/types/api/cms.types";

// --- Contact ---
export * from "@/types/api/contact.types";

// --- Newsletter ---
export * from "@/types/api/newsletter.types";

// --- T√©moignages ---
export * from "@/types/api/testimonial.types";

// --- Chatbot ---
export * from "@/types/api/chatbot.types";

// --- Services ---
export * from "@/types/api/service.types";

// --- KPI ---
export * from "@/types/api/kpi.types";


// pages

// navbar
export * from "@/types/pages/nav.types"
// END OF FILE: src/types/index.ts

// FILE: src/types/pages/nav.types.ts
-----------------------------------------------
// src/types/nav.types.ts
// Types calqu√©s exactement sur frLayout / enLayout dans
// src/dictionaries/data/static/layout/fr.ts et en.ts

export interface NavServiceItem {
  id: string;
  label: string;
  desc: string;
  icon: string;
  href: string;
}

export interface NavBourses {
  title: string;
  china_label: string;
  china_desc: string;
  china_cta: string;
  germany_label: string;
  germany_desc: string;
  germany_cta: string;
}

export interface NavServices {
  title: string;
  items: NavServiceItem[];
}

export interface NavContact {
  title: string;
  rdv_label: string;
  rdv_desc: string;
  whatsapp_label: string;
  whatsapp_desc: string;
  newsletter_title: string;
  newsletter_desc: string;
  newsletter_placeholder: string;
  newsletter_btn: string;
}

export interface NavAbout {
  title: string;
  agency_label: string;
  agency_desc: string;
  mission_label: string;
  mission_desc: string;
  cta: string;
}

export interface NavContent {
  nav_bourses: NavBourses;
  nav_services: NavServices;
  nav_contact: NavContact;
  nav_about: NavAbout;
}
// END OF FILE: src/types/pages/nav.types.ts

// FILE: todo.md
-----------------------------------------------
# üöÄ ROADMAP DE STABILISATION ‚Äî PROJET SALMA

## üü† SPRINT 1 : Polish Frontend & M√©canisme CMS (Vitrine)
*Objectif : Figer l'UI, assurer la coh√©rence de chaque page et pr√©parer la transition vers le contenu dynamique.*

- [x] **G√©n√©ralisation du `cmsSwitcher` :**
  - [x] Cr√©er les fichiers statiques finaux (`home`, `about`, `services`, `contact`, `footer`) dans `src/dictionaries/data/static/`. pour le moment avec le memes cl√©s que ceux des dictionnaires actuels
- [ ] **Polissage syst√©matique page par page  en incluant les appels directs √† `dictionary.xxx` par `cmsSwitcher.getScopeContent(...)` dans tous les composants:**
  - [ ] **Composants UI :** Audit des boutons, badges et cartes dans `src/components/ui/`.
  - [ ] **Page Accueil :** Nettoyage des sections Hero, Stats, TrustBar et T√©moignages.
  - [ ] **Page Catalogue :** V√©rification des filtres et du squelette de chargement.
  - [ ] **Page Services :** Harmonisation des cartes de services.
  - [ ] **Page √Ä Propos & Contact :** V√©rification des textes et des champs de formulaire.
- [ ] **Validation des remarques Client (UI/UX) :**
  - [ ] Changer la photo Hero de la page d'accueil (plus claire, haute qualit√©).
  - [ ] Retirer d√©finitivement "Travel Agency" de la Navbar et du Footer.
  - [ ] Ajustement final du **Mode Sombre** (contrastes et bordures).
  - [ ] Ajout des micro-animations (apparition au scroll, effets hover).
- [ ] **Page D√©tail & Conversion :**
  - [ ] Cr√©er la page `/bourses/[id]/page.tsx` (D√©tail de la bourse).
  - [ ] Appliquer le respect strict du `field_visibility`.
  - [ ] Lier le bouton WhatsApp avec message pr√©-rempli dynamique.
- [ ] **Fiabilisation :**
  - [ ] Cr√©er `not-found.tsx` et `error.tsx` (Error Boundaries).
  - [ ] Audit Responsive complet (iPhone SE ‚ûî Desktop).
## üîµ SPRINT 2 : Alignement Backend & Seeders
*Objectif : Mettre √† jour la base de donn√©es Django pour qu'elle corresponde exactement aux cl√©s CMS d√©finies au Sprint 1.*

- [ ] **Mise √† jour des Seeders Django (`seed.py`) :**
  - [ ] Mettre √† jour les `SitePage` et `ContentBlock` avec les cl√©s exactes du frontend.
  - [ ] Mettre √† jour les `SiteConfig` (r√©seaux sociaux, t√©l√©phones, emails).
  - [ ] Ins√©rer les textes finaux valid√©s en FR et EN.
- [ ] **Test du Switcher :**
  - [ ] Passer `NEXT_PUBLIC_STATIC_CONTENT=false` dans le `.env`.
  - [ ] V√©rifier que le frontend affiche correctement les donn√©es venant de l'API sans casser l'UI.

## üü° SPRINT 3 : Dashboard Admin & Int√©grations Externes
*Objectif : Rendre l'admin 100% fonctionnel pour le client et brancher les services tiers.*

- [ ] **Module CMS & M√©dias :**
  - [ ] Cr√©er la page Admin CMS : formulaires pour √©diter les blocs de texte et changer les images.
  - [ ] Cr√©er la page Admin M√©dias : upload d'images, suppression, copie d'URL.
- [ ] **Module Contacts & Newsletter :**
  - [ ] Cr√©er la page Admin Contacts : tableau des leads, marquer comme lu, ajouter des notes.
  - [ ] Cr√©er la page Admin Newsletter : liste des abonn√©s.
- [ ] **Module T√©moignages :**
  - [ ] Cr√©er la page Admin T√©moignages : approuver/rejeter pour affichage public.
- [ ] **Module KPI & Analytics :**
  - [ ] Cr√©er la page Admin KPI : graphiques de visites, taux de conversion, bourses les plus vues.
- [ ] **Int√©grations Externes (Backend) :**
  - [ ] **Gemini API :** Brancher l'API Google Gemini sur l'endpoint Chatbot de Django (en utilisant les FAQ de la BD comme contexte).
  - [ ] **Emails :** Configurer SMTP (SendGrid ou Mailjet) dans Django pour notifier l'agence lors d'une prise de RDV.
- [ ] **Anti-Spam (S√©curit√©) :** Int√©grer Cloudflare Turnstile ou Google reCAPTCHA v3 (invisible) sur les formulaires de Contact et Newsletter.
  - [ ] **Rate Limiting :** Configurer un throttle sur Django (ex: max 5 requ√™tes/min sur `/api/contact`) pour √©viter les attaques DDoS.

## üü¢ SPRINT 4 : Tests End-to-End (Dynamisme & Temps R√©el)
*Objectif : Se mettre dans la peau du client (Admin) et du prospect (Visiteur) pour traquer les bugs.*

- [ ] **Test CMS :** Modifier un texte/image dans l'admin ‚ûî V√©rifier la mise √† jour sur la vitrine (tester la revalidation ISR).
- [ ] **Test Bourses :**
  - [ ] Cr√©er une bourse ‚ûî V√©rifier son apparition dans le catalogue.
  - [ ] Masquer un champ (ex: `exigence_langue`) ‚ûî V√©rifier sa disparition sur la page d√©tail.
- [ ] **Test Entonnoir de conversion :**
  - [ ] Visiter une bourse ‚ûî Poser une question au Chatbot ‚ûî Remplir le formulaire de contact.
  - [ ] V√©rifier que le KPI a bien track√© la visite et la conversion.
  - [ ] V√©rifier la r√©ception de l'email c√¥t√© agence et la notification dans l'admin.

## üü£ SPRINT 5 : Optimisation, SEO & Code Review (Production)
*Objectif : Atteindre un score Lighthouse de 95+, un code propre et un r√©f√©rencement optimal.*

- [ ] **Performance & Lighthouse :**
  - [ ] Optimiser toutes les images (formats WebP, tailles adapt√©es via `next/image`).
  - [ ] V√©rifier le Lazy Loading des composants lourds (vid√©os, chatbot).
- [ ] **SEO & Accessibilit√© :**
  - [ ] Ajouter les balises `metadata` dynamiques (Title, Description, OpenGraph) sur toutes les pages (surtout `/bourses/[id]`).
  - [ ] G√©n√©rer un `sitemap.xml` et un `robots.txt` dynamiques.
  - [ ] V√©rifier les contrastes de couleurs et les balises `aria-label` pour l'accessibilit√©.
- [ ] **SEO Multilingue :** S'assurer que les balises `<link rel="alternate" hreflang="x">` sont g√©n√©r√©es dynamiquement pour que Google indexe le FR et le EN.
- [ ] **Monitoring & Logs (Optionnel mais recommand√©) :**
  - [ ] Brancher un outil comme Sentry ou GlitchTip pour remonter les erreurs JS (front) et Python (back) en temps r√©el sur un canal Slack/Discord.
- [ ] **Code Review & Nettoyage :**
  - [ ] Supprimer tous les `console.log`, codes comment√©s inutiles et fichiers morts.
  - [ ] Ajouter des commentaires JSDoc sur les fonctions complexes.
  - [ ] V√©rifier qu'il n'y a aucune erreur TypeScript (`npm run build` doit passer sans aucun warning).
- [ ] **S√©curit√© :**
  - [ ] V√©rifier la configuration CORS sur Django (n'autoriser que le domaine Vercel en prod).
  - [ ] S'assurer que le tracking KPI respecte le choix de la banni√®re de cookies.

---
## üéì SPRINT 6 : Capitalisation, Documentation & Standardisation
*Objectif : Livrer un produit document√© au client, extraire des bases r√©utilisables (boilerplates) et figer les standards techniques pour faire monter l'√©quipe en comp√©tence sur les futurs projets.*

- [ ] **Documentation Client (Livrables finaux) :**
  - [ ] Mettre √† jour le **Cahier des charges** (Version Finale) pour refl√©ter exactement ce qui a √©t√© produit.
  - [ ] R√©diger le **Rapport de fin de projet** (Bilan, fonctionnalit√©s livr√©es, performances atteintes).
  - [ ] Cr√©er le **Guide d'utilisation Admin** (Manuel illustr√© pour le client : comment ajouter une bourse, g√©rer le CMS, lire les KPI).
- [ ] **Documentation DevOps & D√©ploiement :**
  - [ ] R√©diger le **Guide de d√©ploiement complet** (Setup Vercel, configuration VPS Hostinger, variables d'environnement, commandes de mise √† jour et maintenance).
  - [ ] **CI/CD (Int√©gration Continue) :** Mettre en place un workflow GitHub Actions pour automatiser le linting (`npm run lint`) et le d√©ploiement.
  - [ ] **Strat√©gie de Backup :** Configurer un Cron Job sur le VPS Hostinger pour dumper la base de donn√©es PostgreSQL chaque nuit et l'envoyer sur un stockage externe (ex: AWS S3 ou un autre serveur).
- [ ] **Cr√©ation de Templates (Boilerplates internes AGT) :**
  - [ ] **Template Frontend :** Extraire un socle Next.js 15 propre (Tailwind v4, i18n, architecture `dictionaries/repositories`, `api-client.ts` avec intercepteurs JWT).
  - [ ] **Template Backend :** Extraire un socle Django DRF (Custom User Model, SimpleJWT, architecture modulaire par `apps/`, configuration CORS/S√©curit√© de prod).
- [ ] **Livre Blanc de l'√âquipe (Design Patterns & Standards) :**
  - [ ] **Frontend Patterns :** Documenter l'approche *Server Components vs Client Components*, la s√©paration des responsabilit√©s (UI -> Dictionnaire -> Repository), et la gestion du state.
  - [ ] **Backend Patterns :** Documenter l'architecture modulaire, les bonnes pratiques DRF (Fat Models / Thin Views), et la gestion des permissions.
  - [ ] **VPS & S√©curit√© :** Standardiser le setup serveur (Nginx, Gunicorn, SSL, pare-feu, gestion des secrets).
  - [ ] **Catalogue de Features :** Lister les modules "pr√™ts √† vendre" pour les futures sp√©cifications (CMS Headless, Chatbot IA Gemini, Tracking KPI, Syst√®me de Visibilit√© dynamique).
// END OF FILE: todo.md

// FILE: tsconfig.json
-----------------------------------------------
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}

// END OF FILE: tsconfig.json
